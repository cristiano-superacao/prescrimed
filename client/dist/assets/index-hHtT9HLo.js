import{r as e,a as s,g as t,R as a,u as r,L as i,N as n,b as l,O as o,c,B as d,d as m,e as x}from"./vendor-C178ox7p.js";import{B as u,M as p,L as h,A as f,z as b,U as g,S as j,a as v,H as y,b as N,P as w,c as C,F as S,d as k,T as E,R as A,D as P,C as R,e as z,f as D,g as T,h as O,i as q,j as L,k as F,X as U,l as M,m as _,n as I,o as B,p as $,I as V,q as H,r as G,s as J,t as W,u as K,v as Y,w as Q,x as X,y as Z,E as ee,G as se,J as te,K as ae,N as re,O as ie,Q as ne,V as le,W as oe,Y as ce,Z as de,_ as me,$ as xe,a0 as ue,a1 as pe,a2 as he,a3 as fe,a4 as be,a5 as ge,a6 as je,a7 as ve,a8 as ye,a9 as Ne,aa as we}from"./ui-Bgz_A8ya.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver(e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&s(e)}).observe(document,{childList:!0,subtree:!0})}function s(e){if(e.ep)return;e.ep=!0;const s=function(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerPolicy&&(s.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?s.credentials="include":"anonymous"===e.crossOrigin?s.credentials="omit":s.credentials="same-origin",s}(e);fetch(e.href,s)}}();var Ce={exports:{}},Se={},ke=e,Ee=Symbol.for("react.element"),Ae=Symbol.for("react.fragment"),Pe=Object.prototype.hasOwnProperty,Re=ke.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ze={key:!0,ref:!0,__self:!0,__source:!0};function De(e,s,t){var a,r={},i=null,n=null;for(a in void 0!==t&&(i=""+t),void 0!==s.key&&(i=""+s.key),void 0!==s.ref&&(n=s.ref),s)Pe.call(s,a)&&!ze.hasOwnProperty(a)&&(r[a]=s[a]);if(e&&e.defaultProps)for(a in s=e.defaultProps)void 0===r[a]&&(r[a]=s[a]);return{$$typeof:Ee,type:e,key:i,ref:n,props:r,_owner:Re.current}}Se.Fragment=Ae,Se.jsx=De,Se.jsxs=De,Ce.exports=Se;var Te=Ce.exports,Oe={},qe=s;Oe.createRoot=qe.createRoot,Oe.hydrateRoot=qe.hydrateRoot;const Le=e=>{let s;const t=new Set,a=(e,a)=>{const r="function"==typeof e?e(s):e;if(!Object.is(r,s)){const e=s;s=(null!=a?a:"object"!=typeof r||null===r)?r:Object.assign({},s,r),t.forEach(t=>t(s,e))}},r=()=>s,i={setState:a,getState:r,getInitialState:()=>n,subscribe:e=>(t.add(e),()=>t.delete(e)),destroy:()=>{t.clear()}},n=s=e(a,r,i);return i};var Fe={exports:{}},Ue={},Me={exports:{}},_e={},Ie=e;var Be="function"==typeof Object.is?Object.is:function(e,s){return e===s&&(0!==e||1/e==1/s)||e!=e&&s!=s},$e=Ie.useState,Ve=Ie.useEffect,He=Ie.useLayoutEffect,Ge=Ie.useDebugValue;function Je(e){var s=e.getSnapshot;e=e.value;try{var t=s();return!Be(e,t)}catch(a){return!0}}var We="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,s){return s()}:function(e,s){var t=s(),a=$e({inst:{value:t,getSnapshot:s}}),r=a[0].inst,i=a[1];return He(function(){r.value=t,r.getSnapshot=s,Je(r)&&i({inst:r})},[e,t,s]),Ve(function(){return Je(r)&&i({inst:r}),e(function(){Je(r)&&i({inst:r})})},[e]),Ge(t),t};_e.useSyncExternalStore=void 0!==Ie.useSyncExternalStore?Ie.useSyncExternalStore:We,Me.exports=_e;var Ke=Me.exports,Ye=e,Qe=Ke;
/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xe="function"==typeof Object.is?Object.is:function(e,s){return e===s&&(0!==e||1/e==1/s)||e!=e&&s!=s},Ze=Qe.useSyncExternalStore,es=Ye.useRef,ss=Ye.useEffect,ts=Ye.useMemo,as=Ye.useDebugValue;Ue.useSyncExternalStoreWithSelector=function(e,s,t,a,r){var i=es(null);if(null===i.current){var n={hasValue:!1,value:null};i.current=n}else n=i.current;i=ts(function(){function e(e){if(!o){if(o=!0,i=e,e=a(e),void 0!==r&&n.hasValue){var s=n.value;if(r(s,e))return l=s}return l=e}if(s=l,Xe(i,e))return s;var t=a(e);return void 0!==r&&r(s,t)?(i=e,s):(i=e,l=t)}var i,l,o=!1,c=void 0===t?null:t;return[function(){return e(s())},null===c?void 0:function(){return e(c())}]},[s,t,a,r]);var l=Ze(e,i[0],i[1]);return ss(function(){n.hasValue=!0,n.value=l},[l]),as(l),l},Fe.exports=Ue;const rs=t(Fe.exports),is={},{useDebugValue:ns}=a,{useSyncExternalStoreWithSelector:ls}=rs;let os=!1;const cs=e=>e;const ds=e=>{const s="function"==typeof e?(e=>e?Le(e):Le)(e):e,t=(e,t)=>function(e,s=cs,t){"production"!==(is?"production":void 0)&&t&&!os&&(os=!0);const a=ls(e.subscribe,e.getState,e.getServerState||e.getInitialState,s,t);return ns(a),a}(s,e,t);return Object.assign(t,s),t};function ms(e,s){return function(){return e.apply(s,arguments)}}const{toString:xs}=Object.prototype,{getPrototypeOf:us}=Object,{iterator:ps,toStringTag:hs}=Symbol,fs=(e=>s=>{const t=xs.call(s);return e[t]||(e[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),bs=e=>(e=e.toLowerCase(),s=>fs(s)===e),gs=e=>s=>typeof s===e,{isArray:js}=Array,vs=gs("undefined");function ys(e){return null!==e&&!vs(e)&&null!==e.constructor&&!vs(e.constructor)&&Cs(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Ns=bs("ArrayBuffer");const ws=gs("string"),Cs=gs("function"),Ss=gs("number"),ks=e=>null!==e&&"object"==typeof e,Es=e=>{if("object"!==fs(e))return!1;const s=us(e);return!(null!==s&&s!==Object.prototype&&null!==Object.getPrototypeOf(s)||hs in e||ps in e)},As=bs("Date"),Ps=bs("File"),Rs=bs("Blob"),zs=bs("FileList"),Ds=bs("URLSearchParams"),[Ts,Os,qs,Ls]=["ReadableStream","Request","Response","Headers"].map(bs);function Fs(e,s,{allOwnKeys:t=!1}={}){if(null==e)return;let a,r;if("object"!=typeof e&&(e=[e]),js(e))for(a=0,r=e.length;a<r;a++)s.call(null,e[a],a,e);else{if(ys(e))return;const r=t?Object.getOwnPropertyNames(e):Object.keys(e),i=r.length;let n;for(a=0;a<i;a++)n=r[a],s.call(null,e[n],n,e)}}function Us(e,s){if(ys(e))return null;s=s.toLowerCase();const t=Object.keys(e);let a,r=t.length;for(;r-- >0;)if(a=t[r],s===a.toLowerCase())return a;return null}const Ms="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,_s=e=>!vs(e)&&e!==Ms;const Is=(e=>s=>e&&s instanceof e)("undefined"!=typeof Uint8Array&&us(Uint8Array)),Bs=bs("HTMLFormElement"),$s=(({hasOwnProperty:e})=>(s,t)=>e.call(s,t))(Object.prototype),Vs=bs("RegExp"),Hs=(e,s)=>{const t=Object.getOwnPropertyDescriptors(e),a={};Fs(t,(t,r)=>{let i;!1!==(i=s(t,r,e))&&(a[r]=i||t)}),Object.defineProperties(e,a)};const Gs=bs("AsyncFunction"),Js=(Ws="function"==typeof setImmediate,Ks=Cs(Ms.postMessage),Ws?setImmediate:Ks?(Ys=`axios@${Math.random()}`,Qs=[],Ms.addEventListener("message",({source:e,data:s})=>{e===Ms&&s===Ys&&Qs.length&&Qs.shift()()},!1),e=>{Qs.push(e),Ms.postMessage(Ys,"*")}):e=>setTimeout(e));var Ws,Ks,Ys,Qs;const Xs="undefined"!=typeof queueMicrotask?queueMicrotask.bind(Ms):"undefined"!=typeof process&&process.nextTick||Js,Zs={isArray:js,isArrayBuffer:Ns,isBuffer:ys,isFormData:e=>{let s;return e&&("function"==typeof FormData&&e instanceof FormData||Cs(e.append)&&("formdata"===(s=fs(e))||"object"===s&&Cs(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let s;return s="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&Ns(e.buffer),s},isString:ws,isNumber:Ss,isBoolean:e=>!0===e||!1===e,isObject:ks,isPlainObject:Es,isEmptyObject:e=>{if(!ks(e)||ys(e))return!1;try{return 0===Object.keys(e).length&&Object.getPrototypeOf(e)===Object.prototype}catch(s){return!1}},isReadableStream:Ts,isRequest:Os,isResponse:qs,isHeaders:Ls,isUndefined:vs,isDate:As,isFile:Ps,isBlob:Rs,isRegExp:Vs,isFunction:Cs,isStream:e=>ks(e)&&Cs(e.pipe),isURLSearchParams:Ds,isTypedArray:Is,isFileList:zs,forEach:Fs,merge:function e(){const{caseless:s,skipUndefined:t}=_s(this)&&this||{},a={},r=(r,i)=>{const n=s&&Us(a,i)||i;Es(a[n])&&Es(r)?a[n]=e(a[n],r):Es(r)?a[n]=e({},r):js(r)?a[n]=r.slice():t&&vs(r)||(a[n]=r)};for(let i=0,n=arguments.length;i<n;i++)arguments[i]&&Fs(arguments[i],r);return a},extend:(e,s,t,{allOwnKeys:a}={})=>(Fs(s,(s,a)=>{t&&Cs(s)?e[a]=ms(s,t):e[a]=s},{allOwnKeys:a}),e),trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,s,t,a)=>{e.prototype=Object.create(s.prototype,a),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:s.prototype}),t&&Object.assign(e.prototype,t)},toFlatObject:(e,s,t,a)=>{let r,i,n;const l={};if(s=s||{},null==e)return s;do{for(r=Object.getOwnPropertyNames(e),i=r.length;i-- >0;)n=r[i],a&&!a(n,e,s)||l[n]||(s[n]=e[n],l[n]=!0);e=!1!==t&&us(e)}while(e&&(!t||t(e,s))&&e!==Object.prototype);return s},kindOf:fs,kindOfTest:bs,endsWith:(e,s,t)=>{e=String(e),(void 0===t||t>e.length)&&(t=e.length),t-=s.length;const a=e.indexOf(s,t);return-1!==a&&a===t},toArray:e=>{if(!e)return null;if(js(e))return e;let s=e.length;if(!Ss(s))return null;const t=new Array(s);for(;s-- >0;)t[s]=e[s];return t},forEachEntry:(e,s)=>{const t=(e&&e[ps]).call(e);let a;for(;(a=t.next())&&!a.done;){const t=a.value;s.call(e,t[0],t[1])}},matchAll:(e,s)=>{let t;const a=[];for(;null!==(t=e.exec(s));)a.push(t);return a},isHTMLForm:Bs,hasOwnProperty:$s,hasOwnProp:$s,reduceDescriptors:Hs,freezeMethods:e=>{Hs(e,(s,t)=>{if(Cs(e)&&-1!==["arguments","caller","callee"].indexOf(t))return!1;const a=e[t];Cs(a)&&(s.enumerable=!1,"writable"in s?s.writable=!1:s.set||(s.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")}))})},toObjectSet:(e,s)=>{const t={},a=e=>{e.forEach(e=>{t[e]=!0})};return js(e)?a(e):a(String(e).split(s)),t},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,s,t){return s.toUpperCase()+t}),noop:()=>{},toFiniteNumber:(e,s)=>null!=e&&Number.isFinite(e=+e)?e:s,findKey:Us,global:Ms,isContextDefined:_s,isSpecCompliantForm:function(e){return!!(e&&Cs(e.append)&&"FormData"===e[hs]&&e[ps])},toJSONObject:e=>{const s=new Array(10),t=(e,a)=>{if(ks(e)){if(s.indexOf(e)>=0)return;if(ys(e))return e;if(!("toJSON"in e)){s[a]=e;const r=js(e)?[]:{};return Fs(e,(e,s)=>{const i=t(e,a+1);!vs(i)&&(r[s]=i)}),s[a]=void 0,r}}return e};return t(e,0)},isAsyncFn:Gs,isThenable:e=>e&&(ks(e)||Cs(e))&&Cs(e.then)&&Cs(e.catch),setImmediate:Js,asap:Xs,isIterable:e=>null!=e&&Cs(e[ps])};function et(e,s,t,a,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",s&&(this.code=s),t&&(this.config=t),a&&(this.request=a),r&&(this.response=r,this.status=r.status?r.status:null)}Zs.inherits(et,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Zs.toJSONObject(this.config),code:this.code,status:this.status}}});const st=et.prototype,tt={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{tt[e]={value:e}}),Object.defineProperties(et,tt),Object.defineProperty(st,"isAxiosError",{value:!0}),et.from=(e,s,t,a,r,i)=>{const n=Object.create(st);Zs.toFlatObject(e,n,function(e){return e!==Error.prototype},e=>"isAxiosError"!==e);const l=e&&e.message?e.message:"Error",o=null==s&&e?e.code:s;return et.call(n,l,o,t,a,r),e&&null==n.cause&&Object.defineProperty(n,"cause",{value:e,configurable:!0}),n.name=e&&e.name||"Error",i&&Object.assign(n,i),n};function at(e){return Zs.isPlainObject(e)||Zs.isArray(e)}function rt(e){return Zs.endsWith(e,"[]")?e.slice(0,-2):e}function it(e,s,t){return e?e.concat(s).map(function(e,s){return e=rt(e),!t&&s?"["+e+"]":e}).join(t?".":""):s}const nt=Zs.toFlatObject(Zs,{},null,function(e){return/^is[A-Z]/.test(e)});function lt(e,s,t){if(!Zs.isObject(e))throw new TypeError("target must be an object");s=s||new FormData;const a=(t=Zs.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(e,s){return!Zs.isUndefined(s[e])})).metaTokens,r=t.visitor||c,i=t.dots,n=t.indexes,l=(t.Blob||"undefined"!=typeof Blob&&Blob)&&Zs.isSpecCompliantForm(s);if(!Zs.isFunction(r))throw new TypeError("visitor must be a function");function o(e){if(null===e)return"";if(Zs.isDate(e))return e.toISOString();if(Zs.isBoolean(e))return e.toString();if(!l&&Zs.isBlob(e))throw new et("Blob is not supported. Use a Buffer instead.");return Zs.isArrayBuffer(e)||Zs.isTypedArray(e)?l&&"function"==typeof Blob?new Blob([e]):Buffer.from(e):e}function c(e,t,r){let l=e;if(e&&!r&&"object"==typeof e)if(Zs.endsWith(t,"{}"))t=a?t:t.slice(0,-2),e=JSON.stringify(e);else if(Zs.isArray(e)&&function(e){return Zs.isArray(e)&&!e.some(at)}(e)||(Zs.isFileList(e)||Zs.endsWith(t,"[]"))&&(l=Zs.toArray(e)))return t=rt(t),l.forEach(function(e,a){!Zs.isUndefined(e)&&null!==e&&s.append(!0===n?it([t],a,i):null===n?t:t+"[]",o(e))}),!1;return!!at(e)||(s.append(it(r,t,i),o(e)),!1)}const d=[],m=Object.assign(nt,{defaultVisitor:c,convertValue:o,isVisitable:at});if(!Zs.isObject(e))throw new TypeError("data must be an object");return function e(t,a){if(!Zs.isUndefined(t)){if(-1!==d.indexOf(t))throw Error("Circular reference detected in "+a.join("."));d.push(t),Zs.forEach(t,function(t,i){!0===(!(Zs.isUndefined(t)||null===t)&&r.call(s,t,Zs.isString(i)?i.trim():i,a,m))&&e(t,a?a.concat(i):[i])}),d.pop()}}(e),s}function ot(e){const s={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(e){return s[e]})}function ct(e,s){this._pairs=[],e&&lt(e,this,s)}const dt=ct.prototype;function mt(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function xt(e,s,t){if(!s)return e;const a=t&&t.encode||mt;Zs.isFunction(t)&&(t={serialize:t});const r=t&&t.serialize;let i;if(i=r?r(s,t):Zs.isURLSearchParams(s)?s.toString():new ct(s,t).toString(a),i){const s=e.indexOf("#");-1!==s&&(e=e.slice(0,s)),e+=(-1===e.indexOf("?")?"?":"&")+i}return e}dt.append=function(e,s){this._pairs.push([e,s])},dt.toString=function(e){const s=e?function(s){return e.call(this,s,ot)}:ot;return this._pairs.map(function(e){return s(e[0])+"="+s(e[1])},"").join("&")};class ut{constructor(){this.handlers=[]}use(e,s,t){return this.handlers.push({fulfilled:e,rejected:s,synchronous:!!t&&t.synchronous,runWhen:t?t.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Zs.forEach(this.handlers,function(s){null!==s&&e(s)})}}const pt={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},ht={isBrowser:!0,classes:{URLSearchParams:"undefined"!=typeof URLSearchParams?URLSearchParams:ct,FormData:"undefined"!=typeof FormData?FormData:null,Blob:"undefined"!=typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},ft="undefined"!=typeof window&&"undefined"!=typeof document,bt="object"==typeof navigator&&navigator||void 0,gt=ft&&(!bt||["ReactNative","NativeScript","NS"].indexOf(bt.product)<0),jt="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,vt=ft&&window.location.href||"http://localhost",yt={...Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:ft,hasStandardBrowserEnv:gt,hasStandardBrowserWebWorkerEnv:jt,navigator:bt,origin:vt},Symbol.toStringTag,{value:"Module"})),...ht};function Nt(e){function s(e,t,a,r){let i=e[r++];if("__proto__"===i)return!0;const n=Number.isFinite(+i),l=r>=e.length;if(i=!i&&Zs.isArray(a)?a.length:i,l)return Zs.hasOwnProp(a,i)?a[i]=[a[i],t]:a[i]=t,!n;a[i]&&Zs.isObject(a[i])||(a[i]=[]);return s(e,t,a[i],r)&&Zs.isArray(a[i])&&(a[i]=function(e){const s={},t=Object.keys(e);let a;const r=t.length;let i;for(a=0;a<r;a++)i=t[a],s[i]=e[i];return s}(a[i])),!n}if(Zs.isFormData(e)&&Zs.isFunction(e.entries)){const t={};return Zs.forEachEntry(e,(e,a)=>{s(function(e){return Zs.matchAll(/\w+|\[(\w*)]/g,e).map(e=>"[]"===e[0]?"":e[1]||e[0])}(e),a,t,0)}),t}return null}const wt={transitional:pt,adapter:["xhr","http","fetch"],transformRequest:[function(e,s){const t=s.getContentType()||"",a=t.indexOf("application/json")>-1,r=Zs.isObject(e);r&&Zs.isHTMLForm(e)&&(e=new FormData(e));if(Zs.isFormData(e))return a?JSON.stringify(Nt(e)):e;if(Zs.isArrayBuffer(e)||Zs.isBuffer(e)||Zs.isStream(e)||Zs.isFile(e)||Zs.isBlob(e)||Zs.isReadableStream(e))return e;if(Zs.isArrayBufferView(e))return e.buffer;if(Zs.isURLSearchParams(e))return s.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let i;if(r){if(t.indexOf("application/x-www-form-urlencoded")>-1)return function(e,s){return lt(e,new yt.classes.URLSearchParams,{visitor:function(e,s,t,a){return yt.isNode&&Zs.isBuffer(e)?(this.append(s,e.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)},...s})}(e,this.formSerializer).toString();if((i=Zs.isFileList(e))||t.indexOf("multipart/form-data")>-1){const s=this.env&&this.env.FormData;return lt(i?{"files[]":e}:e,s&&new s,this.formSerializer)}}return r||a?(s.setContentType("application/json",!1),function(e,s,t){if(Zs.isString(e))try{return(s||JSON.parse)(e),Zs.trim(e)}catch(a){if("SyntaxError"!==a.name)throw a}return(t||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const s=this.transitional||wt.transitional,t=s&&s.forcedJSONParsing,a="json"===this.responseType;if(Zs.isResponse(e)||Zs.isReadableStream(e))return e;if(e&&Zs.isString(e)&&(t&&!this.responseType||a)){const t=!(s&&s.silentJSONParsing)&&a;try{return JSON.parse(e,this.parseReviver)}catch(r){if(t){if("SyntaxError"===r.name)throw et.from(r,et.ERR_BAD_RESPONSE,this,null,this.response);throw r}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:yt.classes.FormData,Blob:yt.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Zs.forEach(["delete","get","head","post","put","patch"],e=>{wt.headers[e]={}});const Ct=Zs.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),St=Symbol("internals");function kt(e){return e&&String(e).trim().toLowerCase()}function Et(e){return!1===e||null==e?e:Zs.isArray(e)?e.map(Et):String(e)}function At(e,s,t,a,r){return Zs.isFunction(a)?a.call(this,s,t):(r&&(s=t),Zs.isString(s)?Zs.isString(a)?-1!==s.indexOf(a):Zs.isRegExp(a)?a.test(s):void 0:void 0)}let Pt=class{constructor(e){e&&this.set(e)}set(e,s,t){const a=this;function r(e,s,t){const r=kt(s);if(!r)throw new Error("header name must be a non-empty string");const i=Zs.findKey(a,r);(!i||void 0===a[i]||!0===t||void 0===t&&!1!==a[i])&&(a[i||s]=Et(e))}const i=(e,s)=>Zs.forEach(e,(e,t)=>r(e,t,s));if(Zs.isPlainObject(e)||e instanceof this.constructor)i(e,s);else if(Zs.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim()))i((e=>{const s={};let t,a,r;return e&&e.split("\n").forEach(function(e){r=e.indexOf(":"),t=e.substring(0,r).trim().toLowerCase(),a=e.substring(r+1).trim(),!t||s[t]&&Ct[t]||("set-cookie"===t?s[t]?s[t].push(a):s[t]=[a]:s[t]=s[t]?s[t]+", "+a:a)}),s})(e),s);else if(Zs.isObject(e)&&Zs.isIterable(e)){let t,a,r={};for(const s of e){if(!Zs.isArray(s))throw TypeError("Object iterator must return a key-value pair");r[a=s[0]]=(t=r[a])?Zs.isArray(t)?[...t,s[1]]:[t,s[1]]:s[1]}i(r,s)}else null!=e&&r(s,e,t);return this}get(e,s){if(e=kt(e)){const t=Zs.findKey(this,e);if(t){const e=this[t];if(!s)return e;if(!0===s)return function(e){const s=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=t.exec(e);)s[a[1]]=a[2];return s}(e);if(Zs.isFunction(s))return s.call(this,e,t);if(Zs.isRegExp(s))return s.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,s){if(e=kt(e)){const t=Zs.findKey(this,e);return!(!t||void 0===this[t]||s&&!At(0,this[t],t,s))}return!1}delete(e,s){const t=this;let a=!1;function r(e){if(e=kt(e)){const r=Zs.findKey(t,e);!r||s&&!At(0,t[r],r,s)||(delete t[r],a=!0)}}return Zs.isArray(e)?e.forEach(r):r(e),a}clear(e){const s=Object.keys(this);let t=s.length,a=!1;for(;t--;){const r=s[t];e&&!At(0,this[r],r,e,!0)||(delete this[r],a=!0)}return a}normalize(e){const s=this,t={};return Zs.forEach(this,(a,r)=>{const i=Zs.findKey(t,r);if(i)return s[i]=Et(a),void delete s[r];const n=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,s,t)=>s.toUpperCase()+t)}(r):String(r).trim();n!==r&&delete s[r],s[n]=Et(a),t[n]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const s=Object.create(null);return Zs.forEach(this,(t,a)=>{null!=t&&!1!==t&&(s[a]=e&&Zs.isArray(t)?t.join(", "):t)}),s}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,s])=>e+": "+s).join("\n")}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...s){const t=new this(e);return s.forEach(e=>t.set(e)),t}static accessor(e){const s=(this[St]=this[St]={accessors:{}}).accessors,t=this.prototype;function a(e){const a=kt(e);s[a]||(!function(e,s){const t=Zs.toCamelCase(" "+s);["get","set","has"].forEach(a=>{Object.defineProperty(e,a+t,{value:function(e,t,r){return this[a].call(this,s,e,t,r)},configurable:!0})})}(t,e),s[a]=!0)}return Zs.isArray(e)?e.forEach(a):a(e),this}};function Rt(e,s){const t=this||wt,a=s||t,r=Pt.from(a.headers);let i=a.data;return Zs.forEach(e,function(e){i=e.call(t,i,r.normalize(),s?s.status:void 0)}),r.normalize(),i}function zt(e){return!(!e||!e.__CANCEL__)}function Dt(e,s,t){et.call(this,null==e?"canceled":e,et.ERR_CANCELED,s,t),this.name="CanceledError"}function Tt(e,s,t){const a=t.config.validateStatus;t.status&&a&&!a(t.status)?s(new et("Request failed with status code "+t.status,[et.ERR_BAD_REQUEST,et.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t)):e(t)}Pt.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),Zs.reduceDescriptors(Pt.prototype,({value:e},s)=>{let t=s[0].toUpperCase()+s.slice(1);return{get:()=>e,set(e){this[t]=e}}}),Zs.freezeMethods(Pt),Zs.inherits(Dt,et,{__CANCEL__:!0});const Ot=(e,s,t=3)=>{let a=0;const r=function(e,s){e=e||10;const t=new Array(e),a=new Array(e);let r,i=0,n=0;return s=void 0!==s?s:1e3,function(l){const o=Date.now(),c=a[n];r||(r=o),t[i]=l,a[i]=o;let d=n,m=0;for(;d!==i;)m+=t[d++],d%=e;if(i=(i+1)%e,i===n&&(n=(n+1)%e),o-r<s)return;const x=c&&o-c;return x?Math.round(1e3*m/x):void 0}}(50,250);return function(e,s){let t,a,r=0,i=1e3/s;const n=(s,i=Date.now())=>{r=i,t=null,a&&(clearTimeout(a),a=null),e(...s)};return[(...e)=>{const s=Date.now(),l=s-r;l>=i?n(e,s):(t=e,a||(a=setTimeout(()=>{a=null,n(t)},i-l)))},()=>t&&n(t)]}(t=>{const i=t.loaded,n=t.lengthComputable?t.total:void 0,l=i-a,o=r(l);a=i;e({loaded:i,total:n,progress:n?i/n:void 0,bytes:l,rate:o||void 0,estimated:o&&n&&i<=n?(n-i)/o:void 0,event:t,lengthComputable:null!=n,[s?"download":"upload"]:!0})},t)},qt=(e,s)=>{const t=null!=e;return[a=>s[0]({lengthComputable:t,total:e,loaded:a}),s[1]]},Lt=e=>(...s)=>Zs.asap(()=>e(...s)),Ft=yt.hasStandardBrowserEnv?((e,s)=>t=>(t=new URL(t,yt.origin),e.protocol===t.protocol&&e.host===t.host&&(s||e.port===t.port)))(new URL(yt.origin),yt.navigator&&/(msie|trident)/i.test(yt.navigator.userAgent)):()=>!0,Ut=yt.hasStandardBrowserEnv?{write(e,s,t,a,r,i,n){if("undefined"==typeof document)return;const l=[`${e}=${encodeURIComponent(s)}`];Zs.isNumber(t)&&l.push(`expires=${new Date(t).toUTCString()}`),Zs.isString(a)&&l.push(`path=${a}`),Zs.isString(r)&&l.push(`domain=${r}`),!0===i&&l.push("secure"),Zs.isString(n)&&l.push(`SameSite=${n}`),document.cookie=l.join("; ")},read(e){if("undefined"==typeof document)return null;const s=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return s?decodeURIComponent(s[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read:()=>null,remove(){}};function Mt(e,s,t){let a=!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(s);return e&&(a||0==t)?function(e,s){return s?e.replace(/\/?\/$/,"")+"/"+s.replace(/^\/+/,""):e}(e,s):s}const _t=e=>e instanceof Pt?{...e}:e;function It(e,s){s=s||{};const t={};function a(e,s,t,a){return Zs.isPlainObject(e)&&Zs.isPlainObject(s)?Zs.merge.call({caseless:a},e,s):Zs.isPlainObject(s)?Zs.merge({},s):Zs.isArray(s)?s.slice():s}function r(e,s,t,r){return Zs.isUndefined(s)?Zs.isUndefined(e)?void 0:a(void 0,e,0,r):a(e,s,0,r)}function i(e,s){if(!Zs.isUndefined(s))return a(void 0,s)}function n(e,s){return Zs.isUndefined(s)?Zs.isUndefined(e)?void 0:a(void 0,e):a(void 0,s)}function l(t,r,i){return i in s?a(t,r):i in e?a(void 0,t):void 0}const o={url:i,method:i,data:i,baseURL:n,transformRequest:n,transformResponse:n,paramsSerializer:n,timeout:n,timeoutMessage:n,withCredentials:n,withXSRFToken:n,adapter:n,responseType:n,xsrfCookieName:n,xsrfHeaderName:n,onUploadProgress:n,onDownloadProgress:n,decompress:n,maxContentLength:n,maxBodyLength:n,beforeRedirect:n,transport:n,httpAgent:n,httpsAgent:n,cancelToken:n,socketPath:n,responseEncoding:n,validateStatus:l,headers:(e,s,t)=>r(_t(e),_t(s),0,!0)};return Zs.forEach(Object.keys({...e,...s}),function(a){const i=o[a]||r,n=i(e[a],s[a],a);Zs.isUndefined(n)&&i!==l||(t[a]=n)}),t}const Bt=e=>{const s=It({},e);let{data:t,withXSRFToken:a,xsrfHeaderName:r,xsrfCookieName:i,headers:n,auth:l}=s;if(s.headers=n=Pt.from(n),s.url=xt(Mt(s.baseURL,s.url,s.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&n.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),Zs.isFormData(t))if(yt.hasStandardBrowserEnv||yt.hasStandardBrowserWebWorkerEnv)n.setContentType(void 0);else if(Zs.isFunction(t.getHeaders)){const e=t.getHeaders(),s=["content-type","content-length"];Object.entries(e).forEach(([e,t])=>{s.includes(e.toLowerCase())&&n.set(e,t)})}if(yt.hasStandardBrowserEnv&&(a&&Zs.isFunction(a)&&(a=a(s)),a||!1!==a&&Ft(s.url))){const e=r&&i&&Ut.read(i);e&&n.set(r,e)}return s},$t="undefined"!=typeof XMLHttpRequest&&function(e){return new Promise(function(s,t){const a=Bt(e);let r=a.data;const i=Pt.from(a.headers).normalize();let n,l,o,c,d,{responseType:m,onUploadProgress:x,onDownloadProgress:u}=a;function p(){c&&c(),d&&d(),a.cancelToken&&a.cancelToken.unsubscribe(n),a.signal&&a.signal.removeEventListener("abort",n)}let h=new XMLHttpRequest;function f(){if(!h)return;const a=Pt.from("getAllResponseHeaders"in h&&h.getAllResponseHeaders());Tt(function(e){s(e),p()},function(e){t(e),p()},{data:m&&"text"!==m&&"json"!==m?h.response:h.responseText,status:h.status,statusText:h.statusText,headers:a,config:e,request:h}),h=null}h.open(a.method.toUpperCase(),a.url,!0),h.timeout=a.timeout,"onloadend"in h?h.onloadend=f:h.onreadystatechange=function(){h&&4===h.readyState&&(0!==h.status||h.responseURL&&0===h.responseURL.indexOf("file:"))&&setTimeout(f)},h.onabort=function(){h&&(t(new et("Request aborted",et.ECONNABORTED,e,h)),h=null)},h.onerror=function(s){const a=new et(s&&s.message?s.message:"Network Error",et.ERR_NETWORK,e,h);a.event=s||null,t(a),h=null},h.ontimeout=function(){let s=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const r=a.transitional||pt;a.timeoutErrorMessage&&(s=a.timeoutErrorMessage),t(new et(s,r.clarifyTimeoutError?et.ETIMEDOUT:et.ECONNABORTED,e,h)),h=null},void 0===r&&i.setContentType(null),"setRequestHeader"in h&&Zs.forEach(i.toJSON(),function(e,s){h.setRequestHeader(s,e)}),Zs.isUndefined(a.withCredentials)||(h.withCredentials=!!a.withCredentials),m&&"json"!==m&&(h.responseType=a.responseType),u&&([o,d]=Ot(u,!0),h.addEventListener("progress",o)),x&&h.upload&&([l,c]=Ot(x),h.upload.addEventListener("progress",l),h.upload.addEventListener("loadend",c)),(a.cancelToken||a.signal)&&(n=s=>{h&&(t(!s||s.type?new Dt(null,e,h):s),h.abort(),h=null)},a.cancelToken&&a.cancelToken.subscribe(n),a.signal&&(a.signal.aborted?n():a.signal.addEventListener("abort",n)));const b=function(e){const s=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return s&&s[1]||""}(a.url);b&&-1===yt.protocols.indexOf(b)?t(new et("Unsupported protocol "+b+":",et.ERR_BAD_REQUEST,e)):h.send(r||null)})},Vt=(e,s)=>{const{length:t}=e=e?e.filter(Boolean):[];if(s||t){let t,a=new AbortController;const r=function(e){if(!t){t=!0,n();const s=e instanceof Error?e:this.reason;a.abort(s instanceof et?s:new Dt(s instanceof Error?s.message:s))}};let i=s&&setTimeout(()=>{i=null,r(new et(`timeout ${s} of ms exceeded`,et.ETIMEDOUT))},s);const n=()=>{e&&(i&&clearTimeout(i),i=null,e.forEach(e=>{e.unsubscribe?e.unsubscribe(r):e.removeEventListener("abort",r)}),e=null)};e.forEach(e=>e.addEventListener("abort",r));const{signal:l}=a;return l.unsubscribe=()=>Zs.asap(n),l}},Ht=function*(e,s){let t=e.byteLength;if(t<s)return void(yield e);let a,r=0;for(;r<t;)a=r+s,yield e.slice(r,a),r=a},Gt=async function*(e){if(e[Symbol.asyncIterator])return void(yield*e);const s=e.getReader();try{for(;;){const{done:e,value:t}=await s.read();if(e)break;yield t}}finally{await s.cancel()}},Jt=(e,s,t,a)=>{const r=async function*(e,s){for await(const t of Gt(e))yield*Ht(t,s)}(e,s);let i,n=0,l=e=>{i||(i=!0,a&&a(e))};return new ReadableStream({async pull(e){try{const{done:s,value:a}=await r.next();if(s)return l(),void e.close();let i=a.byteLength;if(t){let e=n+=i;t(e)}e.enqueue(new Uint8Array(a))}catch(s){throw l(s),s}},cancel:e=>(l(e),r.return())},{highWaterMark:2})},{isFunction:Wt}=Zs,Kt=(({Request:e,Response:s})=>({Request:e,Response:s}))(Zs.global),{ReadableStream:Yt,TextEncoder:Qt}=Zs.global,Xt=(e,...s)=>{try{return!!e(...s)}catch(t){return!1}},Zt=e=>{e=Zs.merge.call({skipUndefined:!0},Kt,e);const{fetch:s,Request:t,Response:a}=e,r=s?Wt(s):"function"==typeof fetch,i=Wt(t),n=Wt(a);if(!r)return!1;const l=r&&Wt(Yt),o=r&&("function"==typeof Qt?(e=>s=>e.encode(s))(new Qt):async e=>new Uint8Array(await new t(e).arrayBuffer())),c=i&&l&&Xt(()=>{let e=!1;const s=new t(yt.origin,{body:new Yt,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!s}),d=n&&l&&Xt(()=>Zs.isReadableStream(new a("").body)),m={stream:d&&(e=>e.body)};r&&["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!m[e]&&(m[e]=(s,t)=>{let a=s&&s[e];if(a)return a.call(s);throw new et(`Response type '${e}' is not supported`,et.ERR_NOT_SUPPORT,t)})});const x=async(e,s)=>{const a=Zs.toFiniteNumber(e.getContentLength());return null==a?(async e=>{if(null==e)return 0;if(Zs.isBlob(e))return e.size;if(Zs.isSpecCompliantForm(e)){const s=new t(yt.origin,{method:"POST",body:e});return(await s.arrayBuffer()).byteLength}return Zs.isArrayBufferView(e)||Zs.isArrayBuffer(e)?e.byteLength:(Zs.isURLSearchParams(e)&&(e+=""),Zs.isString(e)?(await o(e)).byteLength:void 0)})(s):a};return async e=>{let{url:r,method:n,data:l,signal:o,cancelToken:u,timeout:p,onDownloadProgress:h,onUploadProgress:f,responseType:b,headers:g,withCredentials:j="same-origin",fetchOptions:v}=Bt(e),y=s||fetch;b=b?(b+"").toLowerCase():"text";let N=Vt([o,u&&u.toAbortSignal()],p),w=null;const C=N&&N.unsubscribe&&(()=>{N.unsubscribe()});let S;try{if(f&&c&&"get"!==n&&"head"!==n&&0!==(S=await x(g,l))){let e,s=new t(r,{method:"POST",body:l,duplex:"half"});if(Zs.isFormData(l)&&(e=s.headers.get("content-type"))&&g.setContentType(e),s.body){const[e,t]=qt(S,Ot(Lt(f)));l=Jt(s.body,65536,e,t)}}Zs.isString(j)||(j=j?"include":"omit");const s=i&&"credentials"in t.prototype,o={...v,signal:N,method:n.toUpperCase(),headers:g.normalize().toJSON(),body:l,duplex:"half",credentials:s?j:void 0};w=i&&new t(r,o);let u=await(i?y(w,v):y(r,o));const p=d&&("stream"===b||"response"===b);if(d&&(h||p&&C)){const e={};["status","statusText","headers"].forEach(s=>{e[s]=u[s]});const s=Zs.toFiniteNumber(u.headers.get("content-length")),[t,r]=h&&qt(s,Ot(Lt(h),!0))||[];u=new a(Jt(u.body,65536,t,()=>{r&&r(),C&&C()}),e)}b=b||"text";let k=await m[Zs.findKey(m,b)||"text"](u,e);return!p&&C&&C(),await new Promise((s,t)=>{Tt(s,t,{data:k,headers:Pt.from(u.headers),status:u.status,statusText:u.statusText,config:e,request:w})})}catch(k){if(C&&C(),k&&"TypeError"===k.name&&/Load failed|fetch/i.test(k.message))throw Object.assign(new et("Network Error",et.ERR_NETWORK,e,w),{cause:k.cause||k});throw et.from(k,k&&k.code,e,w)}}},ea=new Map,sa=e=>{let s=e&&e.env||{};const{fetch:t,Request:a,Response:r}=s,i=[a,r,t];let n,l,o=i.length,c=ea;for(;o--;)n=i[o],l=c.get(n),void 0===l&&c.set(n,l=o?new Map:Zt(s)),c=l;return l};sa();const ta={http:null,xhr:$t,fetch:{get:sa}};Zs.forEach(ta,(e,s)=>{if(e){try{Object.defineProperty(e,"name",{value:s})}catch(t){}Object.defineProperty(e,"adapterName",{value:s})}});const aa=e=>`- ${e}`,ra=e=>Zs.isFunction(e)||null===e||!1===e;const ia={getAdapter:function(e,s){e=Zs.isArray(e)?e:[e];const{length:t}=e;let a,r;const i={};for(let n=0;n<t;n++){let t;if(a=e[n],r=a,!ra(a)&&(r=ta[(t=String(a)).toLowerCase()],void 0===r))throw new et(`Unknown adapter '${t}'`);if(r&&(Zs.isFunction(r)||(r=r.get(s))))break;i[t||"#"+n]=r}if(!r){const e=Object.entries(i).map(([e,s])=>`adapter ${e} `+(!1===s?"is not supported by the environment":"is not available in the build"));throw new et("There is no suitable adapter to dispatch the request "+(t?e.length>1?"since :\n"+e.map(aa).join("\n"):" "+aa(e[0]):"as no adapter specified"),"ERR_NOT_SUPPORT")}return r},adapters:ta};function na(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Dt(null,e)}function la(e){na(e),e.headers=Pt.from(e.headers),e.data=Rt.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);return ia.getAdapter(e.adapter||wt.adapter,e)(e).then(function(s){return na(e),s.data=Rt.call(e,e.transformResponse,s),s.headers=Pt.from(s.headers),s},function(s){return zt(s)||(na(e),s&&s.response&&(s.response.data=Rt.call(e,e.transformResponse,s.response),s.response.headers=Pt.from(s.response.headers))),Promise.reject(s)})}const oa="1.13.2",ca={};["object","boolean","number","function","string","symbol"].forEach((e,s)=>{ca[e]=function(t){return typeof t===e||"a"+(s<1?"n ":" ")+e}});const da={};ca.transitional=function(e,s,t){return(a,r,i)=>{if(!1===e)throw new et(function(e,s){return"[Axios v"+oa+"] Transitional option '"+e+"'"+s+(t?". "+t:"")}(r," has been removed"+(s?" in "+s:"")),et.ERR_DEPRECATED);return s&&!da[r]&&(da[r]=!0),!e||e(a,r,i)}},ca.spelling=function(e){return(e,s)=>!0};const ma={assertOptions:function(e,s,t){if("object"!=typeof e)throw new et("options must be an object",et.ERR_BAD_OPTION_VALUE);const a=Object.keys(e);let r=a.length;for(;r-- >0;){const i=a[r],n=s[i];if(n){const s=e[i],t=void 0===s||n(s,i,e);if(!0!==t)throw new et("option "+i+" must be "+t,et.ERR_BAD_OPTION_VALUE);continue}if(!0!==t)throw new et("Unknown option "+i,et.ERR_BAD_OPTION)}},validators:ca},xa=ma.validators;let ua=class{constructor(e){this.defaults=e||{},this.interceptors={request:new ut,response:new ut}}async request(e,s){try{return await this._request(e,s)}catch(t){if(t instanceof Error){let e={};Error.captureStackTrace?Error.captureStackTrace(e):e=new Error;const s=e.stack?e.stack.replace(/^.+\n/,""):"";try{t.stack?s&&!String(t.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(t.stack+="\n"+s):t.stack=s}catch(a){}}throw t}}_request(e,s){"string"==typeof e?(s=s||{}).url=e:s=e||{},s=It(this.defaults,s);const{transitional:t,paramsSerializer:a,headers:r}=s;void 0!==t&&ma.assertOptions(t,{silentJSONParsing:xa.transitional(xa.boolean),forcedJSONParsing:xa.transitional(xa.boolean),clarifyTimeoutError:xa.transitional(xa.boolean)},!1),null!=a&&(Zs.isFunction(a)?s.paramsSerializer={serialize:a}:ma.assertOptions(a,{encode:xa.function,serialize:xa.function},!0)),void 0!==s.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?s.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:s.allowAbsoluteUrls=!0),ma.assertOptions(s,{baseUrl:xa.spelling("baseURL"),withXsrfToken:xa.spelling("withXSRFToken")},!0),s.method=(s.method||this.defaults.method||"get").toLowerCase();let i=r&&Zs.merge(r.common,r[s.method]);r&&Zs.forEach(["delete","get","head","post","put","patch","common"],e=>{delete r[e]}),s.headers=Pt.concat(i,r);const n=[];let l=!0;this.interceptors.request.forEach(function(e){"function"==typeof e.runWhen&&!1===e.runWhen(s)||(l=l&&e.synchronous,n.unshift(e.fulfilled,e.rejected))});const o=[];let c;this.interceptors.response.forEach(function(e){o.push(e.fulfilled,e.rejected)});let d,m=0;if(!l){const e=[la.bind(this),void 0];for(e.unshift(...n),e.push(...o),d=e.length,c=Promise.resolve(s);m<d;)c=c.then(e[m++],e[m++]);return c}d=n.length;let x=s;for(;m<d;){const e=n[m++],s=n[m++];try{x=e(x)}catch(u){s.call(this,u);break}}try{c=la.call(this,x)}catch(u){return Promise.reject(u)}for(m=0,d=o.length;m<d;)c=c.then(o[m++],o[m++]);return c}getUri(e){return xt(Mt((e=It(this.defaults,e)).baseURL,e.url,e.allowAbsoluteUrls),e.params,e.paramsSerializer)}};Zs.forEach(["delete","get","head","options"],function(e){ua.prototype[e]=function(s,t){return this.request(It(t||{},{method:e,url:s,data:(t||{}).data}))}}),Zs.forEach(["post","put","patch"],function(e){function s(s){return function(t,a,r){return this.request(It(r||{},{method:e,headers:s?{"Content-Type":"multipart/form-data"}:{},url:t,data:a}))}}ua.prototype[e]=s(),ua.prototype[e+"Form"]=s(!0)});const pa={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(pa).forEach(([e,s])=>{pa[s]=e});const ha=function e(s){const t=new ua(s),a=ms(ua.prototype.request,t);return Zs.extend(a,ua.prototype,t,{allOwnKeys:!0}),Zs.extend(a,t,null,{allOwnKeys:!0}),a.create=function(t){return e(It(s,t))},a}(wt);ha.Axios=ua,ha.CanceledError=Dt,ha.CancelToken=class e{constructor(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");let s;this.promise=new Promise(function(e){s=e});const t=this;this.promise.then(e=>{if(!t._listeners)return;let s=t._listeners.length;for(;s-- >0;)t._listeners[s](e);t._listeners=null}),this.promise.then=e=>{let s;const a=new Promise(e=>{t.subscribe(e),s=e}).then(e);return a.cancel=function(){t.unsubscribe(s)},a},e(function(e,a,r){t.reason||(t.reason=new Dt(e,a,r),s(t.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const s=this._listeners.indexOf(e);-1!==s&&this._listeners.splice(s,1)}toAbortSignal(){const e=new AbortController,s=s=>{e.abort(s)};return this.subscribe(s),e.signal.unsubscribe=()=>this.unsubscribe(s),e.signal}static source(){let s;return{token:new e(function(e){s=e}),cancel:s}}},ha.isCancel=zt,ha.VERSION=oa,ha.toFormData=lt,ha.AxiosError=et,ha.Cancel=ha.CanceledError,ha.all=function(e){return Promise.all(e)},ha.spread=function(e){return function(s){return e.apply(null,s)}},ha.isAxiosError=function(e){return Zs.isObject(e)&&!0===e.isAxiosError},ha.mergeConfig=It,ha.AxiosHeaders=Pt,ha.formToJSON=e=>Nt(Zs.isHTMLForm(e)?new FormData(e):e),ha.getAdapter=ia.getAdapter,ha.HttpStatusCode=pa,ha.default=ha;const{Axios:fa,AxiosError:ba,CanceledError:ga,isCancel:ja,CancelToken:va,VERSION:ya,all:Na,Cancel:wa,isAxiosError:Ca,spread:Sa,toFormData:ka,AxiosHeaders:Ea,HttpStatusCode:Aa,formToJSON:Pa,getAdapter:Ra,mergeConfig:za}=ha,Da=()=>"https://prescrimed-backend-production.up.railway.app".replace(/\/$/,""),Ta=(()=>{window.location.hostname.includes("railway.app")||window.location.hostname.includes("netlify.app")||window.location.hostname.includes("github.io"),new URL("https://prescrimed-backend-production.up.railway.app").hostname;return`${"https://prescrimed-backend-production.up.railway.app".replace(/\/$/,"")}/api`})(),Oa=ha.create({baseURL:Ta,headers:{"Content-Type":"application/json"}});Oa.interceptors.request.use(e=>{const s=localStorage.getItem("token");return s&&(e.headers.Authorization=`Bearer ${s}`),e},e=>Promise.reject(e)),Oa.interceptors.response.use(e=>e,async e=>{var s,t,a;const r=e.config;if(!e.response){const s=Da(),t=`Não foi possível conectar ao servidor. Verifique se o backend está acessível em ${s?`${s}`:"seu backend/configurações de ambiente"} e se as variáveis de ambiente do frontend estão configuradas.`;return window.showToast&&window.showToast(t,"error"),Promise.reject({message:t,originalError:e,isNetworkError:!0})}if(401===(null==(s=e.response)?void 0:s.status)&&!r._retry){r._retry=!0;try{const e=localStorage.getItem("refreshToken"),s=await Oa.post("/auth/refresh",{refreshToken:e}),{token:t}=s.data;return localStorage.setItem("token",t),r.headers.Authorization=`Bearer ${t}`,Oa(r)}catch(i){localStorage.clear();const e="/".replace(/\/?$/,"/");return window.location.href=`${e}login`,Promise.reject(i)}}return 404===(null==(t=e.response)?void 0:t.status)||null==(a=e.response)||a.status,Promise.reject(e)});const qa=async(e,s,t,a={})=>(await Oa.request({method:e,url:s,data:t,...a})).data,La=(e={})=>{const s=new URLSearchParams;Object.entries(e).forEach(([e,t])=>{null!=t&&""!==t&&(Array.isArray(t)?t.forEach(t=>s.append(e,t)):s.append(e,t))});const t=s.toString();return t?`?${t}`:""},Fa=(e,s)=>qa("get",e,void 0,s),Ua=(e,s,t)=>qa("post",e,s,t),Ma=(e,s,t)=>qa("put",e,s,t),_a=(e,s)=>qa("delete",e,void 0,s),Ia=async e=>Ua("/auth/register",e),Ba=async(e,s)=>{const t=await Ua("/auth/login",{email:e,senha:s});return t.token&&(localStorage.setItem("token",t.token),localStorage.setItem("user",JSON.stringify(t.user))),t},$a=()=>{localStorage.removeItem("token"),localStorage.removeItem("user")},Va=()=>{try{const e=localStorage.getItem("user");return e&&"undefined"!==e?JSON.parse(e):null}catch(e){return localStorage.removeItem("user"),null}},Ha=()=>{const e=Va(),s=localStorage.getItem("token");return e&&s?e:(localStorage.removeItem("user"),localStorage.removeItem("token"),null)},Ga=(Ja=e=>({user:Ha(),token:localStorage.getItem("token"),isAuthenticated:!!Ha(),login:async(s,t)=>{const a=await Ba(s,t);e({user:a.user,token:a.token,isAuthenticated:!0})},logout:()=>{$a(),e({user:null,token:null,isAuthenticated:!1})},hasPermission:e=>{var s;const t=Ga.getState();return!!t.user&&("admin"===t.user.role||"superadmin"===t.user.role||(null==(s=t.user.permissoes)?void 0:s.includes(e))||!1)}}))?ds(Ja):ds;var Ja;function Wa(){return Te.jsxs(Te.Fragment,{children:[Te.jsx("div",{className:"absolute inset-0 bg-[url('/pattern.svg')] opacity-20 bg-cover bg-center mix-blend-overlay","aria-hidden":"true"}),Te.jsx("div",{className:"absolute inset-0 opacity-10 bg-cover bg-center mix-blend-overlay",style:{backgroundImage:"url('https://images.unsplash.com/photo-1576091160399-112ba8d25d1d?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80')"},"aria-hidden":"true"}),Te.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-primary-900/50 to-transparent","aria-hidden":"true"})]})}const Ka={create:{m:"criado",f:"criada"},update:{m:"atualizado",f:"atualizada"},delete:{m:"excluído",f:"excluída"}},Ya={create:"criar",update:"atualizar",delete:"excluir",load:"carregar",save:"salvar",cancel:"cancelar",login:"fazer login",register:"realizar cadastro"},Qa={accessDenied:"Acesso negado",passwordMismatch:"As senhas não coincidem",minPassword:"Senha deve ter no mínimo 6 caracteres",cannotDeleteSelf:"Você não pode excluir seu próprio usuário"},Xa=(e,s,{gender:t="m",suffix:a=""}={})=>{var r,i;return`${s} ${(null==(r=Ka[e])?void 0:r[t])||(null==(i=Ka[e])?void 0:i.m)||""} com sucesso${a}`},Za=(e,s)=>`Erro ao ${Ya[e]||e} ${s}`,er=e=>Qa[e]||e,sr=(e,s)=>{var t,a,r,i;return(null==(a=null==(t=null==e?void 0:e.response)?void 0:t.data)?void 0:a.message)||(null==(i=null==(r=null==e?void 0:e.response)?void 0:r.data)?void 0:i.error)||s};function tr(){const s=r(),t=Ga(e=>e.login),[a,n]=e.useState({email:"",senha:""}),[l,o]=e.useState(!1),c=e=>{n({...a,[e.target.name]:e.target.value})};return Te.jsxs("div",{className:"min-h-screen flex bg-white",children:[Te.jsxs("div",{className:"hidden lg:flex lg:w-1/2 bg-gradient-to-br from-primary-600 to-primary-800 relative overflow-hidden text-white p-12 flex-col justify-between items-center text-center",children:[Te.jsx(Wa,{}),Te.jsxs("div",{className:"relative z-10 flex flex-col items-center",children:[Te.jsxs("div",{className:"flex items-center gap-3 text-2xl font-bold mb-2",children:[Te.jsx("div",{className:"w-10 h-10 bg-white/20 backdrop-blur-sm rounded-lg flex items-center justify-center",children:Te.jsx(u,{size:24})}),"Prescrimed"]}),Te.jsx("p",{className:"text-primary-100",children:"Sistema de Gestão de Prescrições"})]}),Te.jsxs("div",{className:"relative z-10 max-w-md",children:[Te.jsx("h2",{className:"text-4xl font-bold mb-6 leading-tight",children:"Simplifique a gestão de prescrições da sua clínica."}),Te.jsx("p",{className:"text-primary-100 text-lg leading-relaxed mb-8",children:"Segurança, agilidade e conformidade em um único lugar. Desenvolvido especialmente para Instituições de Longa Permanência e Clínicas."}),Te.jsxs("div",{className:"flex gap-4 justify-center",children:[Te.jsx("div",{className:"flex -space-x-4",children:[1,2,3,4].map(e=>Te.jsx("div",{className:"w-10 h-10 rounded-full border-2 border-primary-700 bg-primary-800 flex items-center justify-center text-xs font-bold",children:e},e))}),Te.jsxs("div",{className:"flex flex-col justify-center text-left",children:[Te.jsx("span",{className:"font-bold",children:"Mais de 500+"}),Te.jsx("span",{className:"text-xs text-primary-200",children:"Profissionais confiam"})]})]})]}),Te.jsx("div",{className:"relative z-10 text-sm text-primary-200",children:"© 2025 Prescrimed System. Todos os direitos reservados."})]}),Te.jsx("div",{className:"w-full lg:w-1/2 flex items-center justify-center p-6 md:p-12 bg-slate-50",children:Te.jsxs("div",{className:"w-full max-w-md space-y-8",children:[Te.jsxs("div",{className:"text-center lg:text-left",children:[Te.jsx("div",{className:"lg:hidden flex justify-center mb-6",children:Te.jsx("div",{className:"w-12 h-12 bg-primary-600 rounded-xl flex items-center justify-center text-white",children:Te.jsx(u,{size:24})})}),Te.jsx("h2",{className:"text-3xl font-bold text-slate-900 tracking-tight",children:"Bem-vindo de volta"}),Te.jsx("p",{className:"text-slate-500 mt-2",children:"Acesse sua conta para gerenciar prescrições e pacientes."})]}),Te.jsxs("form",{onSubmit:async e=>{e.preventDefault(),o(!0);try{await t(a.email,a.senha),b.success("Login realizado com sucesso!"),s("/dashboard")}catch(r){b.error(sr(r,Za("login","usuário")))}finally{o(!1)}},className:"space-y-6 bg-white p-8 rounded-2xl shadow-sm border border-slate-100",children:[Te.jsxs("div",{className:"space-y-4",children:[Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1.5",children:"Email Profissional"}),Te.jsxs("div",{className:"relative",children:[Te.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-slate-400",children:Te.jsx(p,{size:20})}),Te.jsx("input",{type:"email",name:"email",value:a.email,onChange:c,className:"w-full pl-10 pr-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all",placeholder:"nome@clinica.com",required:!0})]})]}),Te.jsxs("div",{children:[Te.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Senha"}),Te.jsx("a",{href:"#",className:"text-sm font-medium text-primary-600 hover:text-primary-700",children:"Esqueceu a senha?"})]}),Te.jsxs("div",{className:"relative",children:[Te.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-slate-400",children:Te.jsx(h,{size:20})}),Te.jsx("input",{type:"password",name:"senha",value:a.senha,onChange:c,className:"w-full pl-10 pr-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all",placeholder:"••••••••",required:!0})]})]})]}),Te.jsx("button",{type:"submit",disabled:l,className:"w-full bg-primary-600 hover:bg-primary-700 text-white font-semibold py-3.5 rounded-xl transition-all duration-200 flex items-center justify-center gap-2 shadow-lg shadow-primary-600/20 hover:shadow-primary-600/30 focus:ring-2 focus:ring-primary-500 focus:ring-offset-2",children:l?Te.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):Te.jsxs(Te.Fragment,{children:[Te.jsx("span",{children:"Entrar no Sistema"}),Te.jsx(f,{size:18})]})}),Te.jsxs("div",{className:"relative",children:[Te.jsx("div",{className:"absolute inset-0 flex items-center",children:Te.jsx("div",{className:"w-full border-t border-slate-200"})}),Te.jsx("div",{className:"relative flex justify-center text-sm",children:Te.jsx("span",{className:"px-2 bg-white text-slate-500",children:"Não tem uma conta?"})})]}),Te.jsx(i,{to:"/register",className:"w-full bg-white border border-slate-200 text-slate-700 font-semibold py-3.5 rounded-xl hover:bg-slate-50 transition-all duration-200 flex items-center justify-center gap-2",children:"Criar conta da clínica"})]}),Te.jsx("p",{className:"text-center text-xs text-slate-400",children:"Protegido por reCAPTCHA e sujeito à Política de Privacidade e Termos de Serviço do Google."})]})})]})}function ar(){const s=r(),[t,a]=e.useState({tipoSistema:"casa-repouso",nomeEmpresa:"",cnpj:"",nomeUsuario:"",email:"",senha:"",confirmarSenha:"",cpf:"",contato:""}),[n,l]=e.useState(!1),o=[{title:"Cadastro guiado",description:"Organizamos os campos para você concluir o registro em poucos minutos.",icon:g},{title:"Informações seguras",description:"Seus dados ficam protegidos com padrões de segurança usados na saúde.",icon:j},{title:"Tudo em um só lugar",description:"Centralize empresas, usuários e prescrições em uma única plataforma.",icon:v}],c=e=>{a({...t,[e.target.name]:e.target.value})};return Te.jsxs("div",{className:"min-h-screen flex bg-white",children:[Te.jsxs("div",{className:"hidden lg:flex lg:w-1/2 bg-gradient-to-br from-primary-600 to-primary-800 relative overflow-hidden text-white p-12 flex-col justify-between items-center text-center",children:[Te.jsx(Wa,{}),Te.jsxs("div",{className:"relative z-10 flex flex-col items-center",children:[Te.jsxs("div",{className:"flex items-center gap-3 text-2xl font-bold mb-2",children:[Te.jsx("div",{className:"w-10 h-10 bg-white/20 backdrop-blur-sm rounded-lg flex items-center justify-center",children:Te.jsx(u,{size:24})}),"Prescrimed"]}),Te.jsx("p",{className:"text-primary-100",children:"Onboarding & Setup"})]}),Te.jsxs("div",{className:"relative z-10 max-w-md",children:[Te.jsx("h2",{className:"text-4xl font-bold mb-6 leading-tight",children:"Comece a transformar sua gestão clínica hoje."}),Te.jsx("div",{className:"space-y-6 text-left",children:o.map(({title:e,description:s,icon:t})=>Te.jsxs("div",{className:"flex gap-4 items-start",children:[Te.jsx("div",{className:"w-12 h-12 rounded-2xl bg-white/10 flex items-center justify-center shrink-0",children:Te.jsx(t,{size:22,className:"text-white"})}),Te.jsxs("div",{children:[Te.jsx("p",{className:"font-semibold text-white text-lg",children:e}),Te.jsx("p",{className:"text-primary-100 leading-relaxed",children:s})]})]},e))})]}),Te.jsx("div",{className:"relative z-10 text-sm text-primary-200",children:"© 2025 Prescrimed System. Todos os direitos reservados."})]}),Te.jsx("div",{className:"w-full lg:w-1/2 flex items-center justify-center p-6 md:p-12 bg-slate-50 overflow-y-auto",children:Te.jsxs("div",{className:"w-full max-w-xl space-y-8",children:[Te.jsxs("div",{className:"text-center lg:text-left",children:[Te.jsx("div",{className:"lg:hidden flex justify-center mb-6",children:Te.jsx("div",{className:"w-12 h-12 bg-primary-600 rounded-xl flex items-center justify-center text-white",children:Te.jsx(u,{size:24})})}),Te.jsx("h2",{className:"text-3xl font-bold text-slate-900 tracking-tight",children:"Criar nova conta"}),Te.jsx("p",{className:"text-slate-500 mt-2",children:"Preencha os dados da sua empresa e do administrador."})]}),Te.jsxs("form",{onSubmit:async e=>{var a,r;if(e.preventDefault(),t.senha===t.confirmarSenha){l(!0);try{await Ia({tipoSistema:t.tipoSistema,nomeEmpresa:t.nomeEmpresa,cnpj:t.cnpj,nomeAdmin:t.nomeUsuario,email:t.email,senha:t.senha,cpf:t.cpf,contato:t.contato}),b.success("Cadastro realizado com sucesso! Faça login para continuar."),s("/login")}catch(i){const e=(null==(r=null==(a=null==i?void 0:i.response)?void 0:a.data)?void 0:r.error)||Za("register","conta");b.error(e)}finally{l(!1)}}else b.error(er("passwordMismatch"))},className:"space-y-6",children:[Te.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-slate-200 space-y-4",children:[Te.jsxs("div",{className:"flex items-center gap-3 border-b border-slate-100 pb-4 mb-4",children:[Te.jsx("div",{className:"w-8 h-8 rounded-lg bg-purple-100 text-purple-600 flex items-center justify-center",children:Te.jsx(v,{size:18})}),Te.jsxs("div",{children:[Te.jsx("h3",{className:"font-semibold text-slate-900",children:"Tipo de Sistema"}),Te.jsx("p",{className:"text-xs text-slate-500",children:"Selecione o tipo de estabelecimento"})]})]}),Te.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[Te.jsx("button",{type:"button",onClick:()=>a({...t,tipoSistema:"casa-repouso"}),className:"p-5 rounded-xl border-2 transition-all duration-200 "+("casa-repouso"===t.tipoSistema?"border-primary-500 bg-primary-50 shadow-md":"border-slate-200 bg-white hover:border-slate-300"),children:Te.jsxs("div",{className:"flex flex-col items-center gap-3 text-center",children:[Te.jsx("div",{className:"w-14 h-14 rounded-2xl flex items-center justify-center "+("casa-repouso"===t.tipoSistema?"bg-primary-600 text-white":"bg-slate-100 text-slate-600"),children:Te.jsx(y,{size:28})}),Te.jsxs("div",{children:[Te.jsx("h4",{className:"font-semibold "+("casa-repouso"===t.tipoSistema?"text-primary-700":"text-slate-900"),children:"Casa de Repouso"}),Te.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Gestão de residentes e cuidados"})]})]})}),Te.jsx("button",{type:"button",onClick:()=>a({...t,tipoSistema:"fisioterapia"}),className:"p-5 rounded-xl border-2 transition-all duration-200 "+("fisioterapia"===t.tipoSistema?"border-rose-500 bg-rose-50 shadow-md":"border-slate-200 bg-white hover:border-slate-300"),children:Te.jsxs("div",{className:"flex flex-col items-center gap-3 text-center",children:[Te.jsx("div",{className:"w-14 h-14 rounded-2xl flex items-center justify-center "+("fisioterapia"===t.tipoSistema?"bg-rose-600 text-white":"bg-slate-100 text-slate-600"),children:Te.jsx(N,{size:28})}),Te.jsxs("div",{children:[Te.jsx("h4",{className:"font-semibold "+("fisioterapia"===t.tipoSistema?"text-rose-700":"text-slate-900"),children:"Clínica de Fisioterapia"}),Te.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Gestão de sessões e evoluções"})]})]})}),Te.jsx("button",{type:"button",onClick:()=>a({...t,tipoSistema:"petshop"}),className:"p-5 rounded-xl border-2 transition-all duration-200 "+("petshop"===t.tipoSistema?"border-emerald-500 bg-emerald-50 shadow-md":"border-slate-200 bg-white hover:border-slate-300"),children:Te.jsxs("div",{className:"flex flex-col items-center gap-3 text-center",children:[Te.jsx("div",{className:"w-14 h-14 rounded-2xl flex items-center justify-center "+("petshop"===t.tipoSistema?"bg-emerald-600 text-white":"bg-slate-100 text-slate-600"),children:Te.jsx(w,{size:28})}),Te.jsxs("div",{children:[Te.jsx("h4",{className:"font-semibold "+("petshop"===t.tipoSistema?"text-emerald-700":"text-slate-900"),children:"Petshop / Veterinária"}),Te.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Gestão de pets e atendimentos"})]})]})})]})]}),Te.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-slate-200 space-y-4",children:[Te.jsxs("div",{className:"flex items-center gap-3 border-b border-slate-100 pb-4 mb-4",children:[Te.jsx("div",{className:"w-8 h-8 rounded-lg bg-primary-100 text-primary-600 flex items-center justify-center",children:Te.jsx(u,{size:18})}),Te.jsxs("div",{children:[Te.jsx("h3",{className:"font-semibold text-slate-900",children:"Dados da Empresa"}),Te.jsx("p",{className:"text-xs text-slate-500",children:"casa-repouso"===t.tipoSistema?"Informações da casa de repouso":"petshop"===t.tipoSistema?"Informações do petshop/clínica veterinária":"Informações da clínica de fisioterapia"})]})]}),Te.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1.5",children:"Nome da Empresa *"}),Te.jsx("input",{type:"text",name:"nomeEmpresa",value:t.nomeEmpresa,onChange:c,className:"w-full px-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all",placeholder:"casa-repouso"===t.tipoSistema?"Ex.: Casa de Repouso Vida":"petshop"===t.tipoSistema?"Ex.: Petshop Amigo Fiel":"Ex.: Clínica Fisio Movimento",required:!0})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1.5",children:"CNPJ *"}),Te.jsx("input",{type:"text",name:"cnpj",value:t.cnpj,onChange:c,className:"w-full px-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all",placeholder:"00.000.000/0000-00",required:!0})]})]})]}),Te.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-slate-200 space-y-4",children:[Te.jsxs("div",{className:"flex items-center gap-3 border-b border-slate-100 pb-4 mb-4",children:[Te.jsx("div",{className:"w-8 h-8 rounded-lg bg-emerald-100 text-emerald-600 flex items-center justify-center",children:Te.jsx(g,{size:18})}),Te.jsxs("div",{children:[Te.jsx("h3",{className:"font-semibold text-slate-900",children:"Administrador"}),Te.jsx("p",{className:"text-xs text-slate-500",children:"Dados do responsável"})]})]}),Te.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[Te.jsxs("div",{className:"md:col-span-2",children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1.5",children:"Nome Completo *"}),Te.jsx("input",{type:"text",name:"nomeUsuario",value:t.nomeUsuario,onChange:c,className:"w-full px-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all",placeholder:"Nome e sobrenome",required:!0})]}),Te.jsxs("div",{className:"md:col-span-2",children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1.5",children:"E-mail *"}),Te.jsx("input",{type:"email",name:"email",value:t.email,onChange:c,className:"w-full px-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all",placeholder:"seu@email.com",required:!0})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1.5",children:"CPF *"}),Te.jsx("input",{type:"text",name:"cpf",value:t.cpf,onChange:c,className:"w-full px-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all",placeholder:"000.000.000-00",required:!0})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1.5",children:"Contato *"}),Te.jsx("input",{type:"text",name:"contato",value:t.contato,onChange:c,className:"w-full px-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all",placeholder:"(00) 00000-0000",required:!0})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1.5",children:"Senha *"}),Te.jsx("input",{type:"password",name:"senha",value:t.senha,onChange:c,className:"w-full px-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all",placeholder:"Mínimo 6 caracteres",minLength:6,required:!0})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1.5",children:"Confirmar Senha *"}),Te.jsx("input",{type:"password",name:"confirmarSenha",value:t.confirmarSenha,onChange:c,className:"w-full px-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all",placeholder:"Repita a senha",minLength:6,required:!0})]})]})]}),Te.jsx("button",{type:"submit",disabled:n,className:"w-full bg-primary-600 hover:bg-primary-700 text-white font-semibold py-4 rounded-xl transition-all duration-200 shadow-lg shadow-primary-600/20 hover:shadow-primary-600/30 focus:ring-2 focus:ring-primary-500 focus:ring-offset-2",children:n?"Processando cadastro...":"Finalizar Cadastro"}),Te.jsxs("p",{className:"text-center text-sm text-slate-600",children:["Já possui uma conta?"," ",Te.jsx(i,{to:"/login",className:"text-primary-600 font-semibold hover:text-primary-700",children:"Fazer login"})]})]})]})})]})}const rr=async(e,s)=>{const t=La({dataInicio:e,dataFim:s});return Fa(`/dashboard/stats${t}`)},ir=async()=>Fa("/dashboard/prescricoes-recentes"),nr=async()=>Fa("/dashboard/pacientes-recentes"),lr=async()=>Fa("/dashboard/next-steps"),or=async()=>Fa("/dashboard/alerts");function cr({data:e,color:s="#2563eb",height:t=200}){if(!e||0===e.length)return null;const a=Math.max(...e.map(e=>e.count)),r=a-0||1,i=e.map((s,t)=>`${t/(e.length-1)*100},${100-(s.count-0)/r*80}`).join(" "),n=`${i} 100,100 0,100`;return Te.jsx("div",{className:"w-full",style:{height:`${t}px`},children:Te.jsxs("div",{className:"relative w-full h-full overflow-hidden",children:[Te.jsxs("svg",{viewBox:"0 0 100 100",preserveAspectRatio:"none",className:"w-full h-full overflow-visible",children:[Te.jsx("line",{x1:"0",y1:"20",x2:"100",y2:"20",stroke:"#e2e8f0",strokeWidth:"0.5",strokeDasharray:"2"}),Te.jsx("line",{x1:"0",y1:"60",x2:"100",y2:"60",stroke:"#e2e8f0",strokeWidth:"0.5",strokeDasharray:"2"}),Te.jsx("line",{x1:"0",y1:"100",x2:"100",y2:"100",stroke:"#e2e8f0",strokeWidth:"0.5"}),Te.jsx("path",{d:`M${n}Z`,fill:s,fillOpacity:"0.1",stroke:"none"}),Te.jsx("polyline",{fill:"none",stroke:s,strokeWidth:"2",points:i,vectorEffect:"non-scaling-stroke",strokeLinecap:"round",strokeLinejoin:"round"}),e.map((t,a)=>{const i=a/(e.length-1)*100,n=100-(t.count-0)/r*80;return Te.jsx("circle",{cx:i,cy:n,r:"1.5",fill:"white",stroke:s,strokeWidth:"1",vectorEffect:"non-scaling-stroke",className:"opacity-0 hover:opacity-100 transition-opacity cursor-pointer",children:Te.jsx("title",{children:`${new Date(t.date).toLocaleDateString("pt-BR")}: ${t.count} prescrições`})},a)})]}),Te.jsxs("div",{className:"absolute bottom-0 left-0 w-full flex justify-between text-[10px] text-slate-400 pointer-events-none translate-y-4",children:[Te.jsx("span",{children:new Date(e[0].date).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"})}),Te.jsx("span",{children:new Date(e[Math.floor(e.length/2)].date).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"})}),Te.jsx("span",{children:new Date(e[e.length-1].date).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"})})]})]})})}function dr({title:e,subtitle:s,label:t,children:a}){return Te.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6",children:[Te.jsxs("div",{className:"space-y-3",children:[t&&Te.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-slate-400",children:t}),Te.jsx("h1",{className:"text-2xl sm:text-3xl lg:text-4xl font-bold text-slate-900",children:e}),s&&Te.jsx("p",{className:"text-slate-500 text-sm max-w-2xl",children:s})]}),Te.jsx("div",{className:"flex flex-col sm:flex-row w-full lg:w-auto gap-2 sm:gap-3",children:a})]})}function mr({icon:e,label:s,value:t,description:a,color:r="primary"}){const i={primary:{border:"border-primary-500",bg:"bg-primary-50",text:"text-primary-600"},emerald:{border:"border-emerald-500",bg:"bg-emerald-50",text:"text-emerald-600"},red:{border:"border-red-500",bg:"bg-red-50",text:"text-red-600"},purple:{border:"border-purple-500",bg:"bg-purple-50",text:"text-purple-600"},orange:{border:"border-orange-500",bg:"bg-orange-50",text:"text-orange-600"},blue:{border:"border-blue-500",bg:"bg-blue-50",text:"text-blue-600"}},n=i[r]||i.primary;return Te.jsxs("div",{className:`card p-6 border-l-4 ${n.border}`,children:[Te.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Te.jsx("div",{className:`p-3 ${n.bg} rounded-xl`,children:Te.jsx(e,{className:n.text,size:24})}),Te.jsx("span",{className:"text-xs font-semibold text-slate-400 uppercase tracking-wider",children:s})]}),Te.jsx("h3",{className:"text-2xl font-bold text-slate-900",children:t}),a&&Te.jsx("p",{className:"text-sm text-slate-500 mt-1",children:a})]})}function xr(){const[s,t]=e.useState(null),[a,i]=e.useState([]),[n,l]=e.useState([]),[o,c]=e.useState([]),[d,m]=e.useState([]),[x,p]=e.useState([]),[h,f]=e.useState(!0),g=r(),{user:j}=Ga();e.useEffect(()=>{v()},[]);const v=async()=>{var e;h||f(!0);try{const[s,a,r,n,o]=await Promise.all([rr(),ir(),nr(),lr(),or()]);if(t((null==s?void 0:s.stats)||s),i((null==a?void 0:a.prescricoes)||[]),l((null==r?void 0:r.pacientes)||[]),c((null==n?void 0:n.nextSteps)||[]),m((null==o?void 0:o.alerts)||[]),null==(e=null==s?void 0:s.stats)?void 0:e.graficoPrescricoes){const e=s.stats.graficoPrescricoes.map(e=>({date:new Date(e.data).toLocaleDateString("pt-BR",{day:"2-digit",month:"short"}),value:e.total}));p(e)}}catch(s){b.error(Za("load","dados do dashboard"))}finally{f(!1)}};if(h)return Te.jsx("div",{className:"flex items-center justify-center h-full",children:Te.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})});null==s||s.totalPacientes,null==s||s.totalPrescricoes,null==s||s.totalUsuarios,null==s||s.prescricoesPeriodo;const y={critical:"bg-rose-50 text-rose-700 border-rose-200",warning:"bg-amber-50 text-amber-700 border-amber-200",info:"bg-primary-50 text-primary-700 border-primary-200"},N=[{label:"Dashboard",path:"/dashboard",icon:E,accent:"from-primary-500 to-primary-600"},{label:"Agenda",path:"/agenda",icon:R,accent:"from-emerald-500 to-emerald-600"},{label:"Cronograma",path:"/cronograma",icon:z,accent:"from-orange-500 to-amber-500"},{label:"Prescrições",path:"/prescricoes",icon:S,accent:"from-purple-500 to-purple-600"},{label:"Censo M.P.",path:"/censo-mp",icon:D,accent:"from-sky-500 to-sky-600"},{label:"Pacientes",path:"/residentes",icon:C,accent:"from-amber-500 to-orange-500"},{label:"Estoque",path:"/estoque",icon:T,accent:"from-blue-500 to-indigo-500"},{label:"Evolução",path:"/evolucao",icon:O,accent:"from-teal-500 to-emerald-500"},{label:"Financeiro",path:"/financeiro",icon:q,accent:"from-lime-500 to-green-500"},{label:"Usuários",path:"/usuarios",icon:k,accent:"from-fuchsia-500 to-purple-600"},{label:"Empresas",path:"/empresas",icon:u,accent:"from-cyan-500 to-blue-500"},{label:"Configurações",path:"/configuracoes",icon:L,accent:"from-slate-500 to-slate-700"}];return Te.jsxs("div",{className:"space-y-8",children:[Te.jsxs(dr,{label:"Visão Geral",title:"Dashboard",subtitle:"Acompanhe em tempo real pacientes, prescrições e equipes para manter a operação segura e eficiente.",children:[Te.jsxs("button",{onClick:async()=>{await v(),b.success("Dados atualizados com sucesso!")},className:"btn btn-secondary flex items-center justify-center gap-2",children:[Te.jsx(A,{size:18})," Atualizar dados"]}),Te.jsxs("button",{onClick:()=>{b.promise(new Promise(e=>setTimeout(e,2e3)),{loading:"Gerando relatório...",success:"Relatório enviado para seu e-mail!",error:"Erro ao gerar relatório"})},className:"btn btn-primary flex items-center justify-center gap-2",children:[Te.jsx(P,{size:18})," Exportar relatório"]})]}),("superadmin"===(null==j?void 0:j.role)||j&&"superadmin@prescrimed.com"===j.email)&&Te.jsxs("div",{className:"card border border-slate-100 shadow-sm",children:[Te.jsxs("div",{className:"flex items-center justify-between gap-3 mb-4",children:[Te.jsxs("div",{children:[Te.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Acesso rápido"}),Te.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:"Módulos do sistema"}),Te.jsx("p",{className:"text-sm text-slate-500",children:"Clique para abrir qualquer módulo com acesso total."})]}),Te.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-semibold bg-primary-50 text-primary-700 border border-primary-100",children:"SuperAdmin"})]}),Te.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6 gap-3",children:N.map(e=>{const s=e.icon;return Te.jsxs("button",{onClick:()=>g(e.path),className:"group w-full text-left p-4 rounded-2xl border border-slate-100 bg-white hover:shadow-lg hover:-translate-y-0.5 transition-all duration-200",children:[Te.jsx("div",{className:`w-10 h-10 rounded-xl bg-gradient-to-br ${e.accent} text-white flex items-center justify-center mb-3 shadow-sm`,children:Te.jsx(s,{size:20})}),Te.jsx("p",{className:"font-semibold text-slate-900 leading-snug",children:e.label}),Te.jsx("p",{className:"text-xs text-slate-500 mt-1 group-hover:text-slate-700",children:"Acesso direto"})]},e.path)})})]}),Te.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:[Te.jsxs("div",{className:"card",children:[Te.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[Te.jsx(D,{className:"text-primary-600",size:24}),Te.jsxs("div",{children:[Te.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Próximos passos"}),Te.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:"Controle operacional"})]})]}),Te.jsx("div",{className:"space-y-4",children:o.length>0?o.map(e=>Te.jsxs("div",{className:"p-4 rounded-2xl border border-slate-100 bg-slate-50",children:[Te.jsx("h3",{className:"font-semibold text-slate-900",children:e.title}),Te.jsx("p",{className:"text-sm text-slate-500 mt-1",children:e.description}),Te.jsx("button",{onClick:()=>e.ctaRoute&&g(e.ctaRoute),className:"text-primary-600 text-sm font-semibold mt-3 hover:underline",children:e.ctaLabel})]},e.id)):Te.jsx("p",{className:"text-sm text-slate-500",children:"Nenhuma pendência encontrada."})})]}),Te.jsxs("div",{className:"card",children:[Te.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[Te.jsx(F,{className:"text-amber-600",size:24}),Te.jsxs("div",{children:[Te.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Alertas críticos"}),Te.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:"Atenção imediata"})]})]}),Te.jsx("div",{className:"space-y-4",children:d.length>0?d.map(e=>Te.jsxs("div",{className:`p-4 rounded-2xl border ${y[e.severity]||"bg-slate-50 text-slate-700 border-slate-200"}`,children:[Te.jsx("h3",{className:"font-semibold",children:e.title}),Te.jsx("p",{className:"text-sm opacity-80 mt-1",children:e.detail})]},e.id)):Te.jsx("p",{className:"text-sm text-slate-500",children:"Nenhum alerta crítico no momento."})})]})]}),Te.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6",children:[Te.jsx(mr,{icon:C,label:"Pacientes",value:(null==s?void 0:s.totalPacientes)||0,description:"+12% vs mês anterior",color:"primary"}),Te.jsx(mr,{icon:S,label:"Prescrições",value:(null==s?void 0:s.totalPrescricoes)||0,description:"+6% no período",color:"emerald"}),Te.jsx(mr,{icon:k,label:"Equipe",value:(null==s?void 0:s.totalUsuarios)||0,description:"Usuários ativos",color:"purple"}),Te.jsx(mr,{icon:E,label:"Atividade",value:(null==s?void 0:s.prescricoesPeriodo)||0,description:"Prescrições recentes",color:"amber"})]}),Te.jsxs("div",{className:"card p-6",children:[Te.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Te.jsxs("div",{className:"flex items-center gap-3",children:[Te.jsx(O,{className:"text-primary-600",size:24}),Te.jsxs("div",{children:[Te.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Análise"}),Te.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Evolução de Prescrições"})]})]}),Te.jsxs("div",{className:"flex items-center gap-2",children:[Te.jsx(R,{className:"text-slate-400",size:16}),Te.jsx("span",{className:"text-sm text-slate-600",children:"Últimos 30 dias"})]})]}),Te.jsx("div",{className:"h-64 w-full",children:x.length>0?Te.jsx(cr,{data:x,color:"#2d5016",height:250}):Te.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-slate-400",children:[Te.jsx(E,{size:48,className:"mb-2 opacity-20"}),Te.jsx("p",{children:"Dados insuficientes para o gráfico"}),Te.jsx("p",{className:"text-xs mt-1",children:"Cadastre prescrições para visualizar a evolução"})]})})]}),Te.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[Te.jsxs("div",{className:"card",children:[Te.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Te.jsxs("div",{children:[Te.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Atividade"}),Te.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Prescrições Recentes"})]}),Te.jsxs("span",{className:"px-3 py-1 rounded-full text-xs font-semibold bg-primary-50 text-primary-700",children:[a.length," registros"]})]}),Te.jsx("div",{className:"space-y-4",children:a.length>0?a.map(e=>{var s;return Te.jsxs("div",{className:"p-4 rounded-2xl border border-slate-100 bg-slate-50",children:[Te.jsxs("div",{className:"flex justify-between gap-3 mb-2",children:[Te.jsxs("div",{children:[Te.jsx("p",{className:"font-semibold text-slate-900",children:e.pacienteNome}),Te.jsx("p",{className:"text-xs text-slate-500",children:new Date(e.createdAt).toLocaleString("pt-BR")})]}),Te.jsxs("div",{className:"flex gap-2",children:[Te.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-semibold "+("controlado"===e.tipo?"bg-orange-100 text-orange-700":"bg-primary-100 text-primary-700"),children:"controlado"===e.tipo?"Controlado":"Comum"}),Te.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-semibold "+("ativa"===e.status?"bg-emerald-100 text-emerald-700":"bg-red-100 text-red-700"),children:e.status})]})]}),(null==(s=e.medicamentos)?void 0:s.length)>0&&Te.jsxs("p",{className:"text-sm text-slate-600",children:[e.medicamentos[0].nome,e.medicamentos.length>1&&` + ${e.medicamentos.length-1} medicamentos`]})]},e.id||e._id)}):Te.jsx("p",{className:"text-slate-500 text-center py-8",children:"Nenhuma prescrição recente"})})]}),Te.jsxs("div",{className:"card",children:[Te.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Te.jsxs("div",{children:[Te.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Cadastros"}),Te.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Pacientes Recentes"})]}),Te.jsx("span",{className:"text-xs text-slate-400",children:"Atualizado hoje"})]}),Te.jsx("div",{className:"space-y-3",children:n.length>0?n.map(e=>Te.jsxs("div",{className:"p-4 rounded-2xl border border-slate-100",children:[Te.jsx("p",{className:"font-semibold text-slate-900",children:e.nome}),Te.jsxs("div",{className:"flex flex-wrap gap-3 text-sm text-slate-500 mt-1",children:[Te.jsxs("span",{children:["CPF: ",e.cpf]}),Te.jsxs("span",{children:["Entrada: ",new Date(e.createdAt).toLocaleDateString("pt-BR")]})]})]},e.id||e._id)):Te.jsx("p",{className:"text-slate-500 text-center py-8",children:"Nenhum paciente recente"})})]})]})]})}const ur=async(e="")=>Fa(e?`/pacientes?${e}`:"/pacientes"),pr=async e=>Fa(`/pacientes/${e}/prescricoes`),hr=async e=>Ua("/pacientes",e),fr=async(e,s)=>Ma(`/pacientes/${e}`,s),br=async e=>_a(`/pacientes/${e}`),gr="data-modal-lock-count",jr="data-modal-lock-original-overflow",vr="data-modal-lock-original-padding-right";function yr(e){const s=e.getAttribute(gr),t=Number.parseInt(s||"0",10);return Number.isFinite(t)?t:0}function Nr(e,s){e.setAttribute(gr,String(Math.max(0,s)))}function wr(s){e.useEffect(()=>{if(!s)return;if("undefined"==typeof document)return;const e=document.body,t=yr(e);return 0===t&&function(e){e.hasAttribute(jr)||e.setAttribute(jr,e.style.overflow||""),e.hasAttribute(vr)||e.setAttribute(vr,e.style.paddingRight||"");const s=window.innerWidth-document.documentElement.clientWidth;e.style.overflow="hidden",s>0&&(e.style.paddingRight=`${s}px`)}(e),Nr(e,t+1),()=>{const s=yr(e),t=Math.max(0,s-1);Nr(e,t),0===t&&function(e){const s=e.getAttribute(jr)||"",t=e.getAttribute(vr)||"";e.style.overflow=s,e.style.paddingRight=t,e.removeAttribute(jr),e.removeAttribute(vr)}(e)}},[s])}function Cr({paciente:s,onClose:t}){wr(!0);const[a,r]=e.useState({nome:"",cpf:"",dataNascimento:"",sexo:"",telefone:"",email:"",endereco:{rua:"",numero:"",bairro:"",cidade:"",estado:"",cep:""},alergias:[],condicoesMedicas:[],convenio:{nome:"",numero:"",validade:""},contatoEmergencia:{nome:"",telefone:"",relacao:""}}),[i,n]=e.useState(!1);e.useEffect(()=>{s&&r(s)},[s]);const l=e=>{const{name:s,value:t}=e.target;if(s.includes(".")){const[e,i]=s.split(".");r({...a,[e]:{...a[e],[i]:t}})}else r({...a,[s]:t})};return Te.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",onMouseDown:e=>{e.target===e.currentTarget&&t()},children:Te.jsxs("div",{role:"dialog","aria-modal":"true",className:"bg-white rounded-2xl sm:rounded-3xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col",onMouseDown:e=>e.stopPropagation(),children:[Te.jsxs("div",{className:"flex justify-between items-center px-6 py-5 border-b border-slate-100 bg-white/90 backdrop-blur-sm shrink-0",children:[Te.jsxs("div",{children:[Te.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Cadastro"}),Te.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:s?"Editar Paciente":"Novo Paciente"})]}),Te.jsx("button",{onClick:t,className:"p-2 hover:bg-slate-50 rounded-2xl transition","aria-label":"Fechar modal",type:"button",children:Te.jsx(U,{size:22,className:"text-slate-500"})})]}),Te.jsxs("form",{onSubmit:async e=>{e.preventDefault(),n(!0);try{s?(await fr(s.id,a),b.success(Xa("update","Paciente"))):(await hr(a),b.success(Xa("create","Paciente"))),t()}catch(r){b.error(sr(r,Za("save","paciente")))}finally{n(!1)}},className:"flex flex-col flex-1 min-h-0",children:[Te.jsxs("div",{className:"p-6 space-y-6 overflow-y-auto custom-scrollbar",children:[Te.jsxs("div",{children:[Te.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Dados Pessoais"}),Te.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium mb-2",children:"Nome Completo *"}),Te.jsx("input",{type:"text",name:"nome",value:a.nome,onChange:l,className:"input",required:!0})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium mb-2",children:"CPF *"}),Te.jsx("input",{type:"text",name:"cpf",value:a.cpf,onChange:l,className:"input",required:!0})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium mb-2",children:"Data de Nascimento *"}),Te.jsx("input",{type:"date",name:"dataNascimento",value:a.dataNascimento,onChange:l,className:"input",required:!0})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium mb-2",children:"Sexo *"}),Te.jsxs("select",{name:"sexo",value:a.sexo,onChange:l,className:"input",required:!0,children:[Te.jsx("option",{value:"",children:"Selecione"}),Te.jsx("option",{value:"M",children:"Masculino"}),Te.jsx("option",{value:"F",children:"Feminino"}),Te.jsx("option",{value:"Outro",children:"Outro"})]})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium mb-2",children:"Telefone *"}),Te.jsx("input",{type:"tel",name:"telefone",value:a.telefone,onChange:l,className:"input",required:!0})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium mb-2",children:"E-mail"}),Te.jsx("input",{type:"email",name:"email",value:a.email,onChange:l,className:"input"})]})]})]}),Te.jsxs("div",{children:[Te.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Endereço"}),Te.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium mb-2",children:"CEP"}),Te.jsx("input",{type:"text",name:"endereco.cep",value:a.endereco.cep,onChange:l,className:"input"})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium mb-2",children:"Rua"}),Te.jsx("input",{type:"text",name:"endereco.rua",value:a.endereco.rua,onChange:l,className:"input"})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium mb-2",children:"Número"}),Te.jsx("input",{type:"text",name:"endereco.numero",value:a.endereco.numero,onChange:l,className:"input"})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium mb-2",children:"Bairro"}),Te.jsx("input",{type:"text",name:"endereco.bairro",value:a.endereco.bairro,onChange:l,className:"input"})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium mb-2",children:"Cidade"}),Te.jsx("input",{type:"text",name:"endereco.cidade",value:a.endereco.cidade,onChange:l,className:"input"})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium mb-2",children:"Estado"}),Te.jsx("input",{type:"text",name:"endereco.estado",value:a.endereco.estado,onChange:l,className:"input",maxLength:2})]})]})]}),Te.jsxs("div",{children:[Te.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Contato de Emergência"}),Te.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium mb-2",children:"Nome"}),Te.jsx("input",{type:"text",name:"contatoEmergencia.nome",value:a.contatoEmergencia.nome,onChange:l,className:"input"})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium mb-2",children:"Telefone"}),Te.jsx("input",{type:"tel",name:"contatoEmergencia.telefone",value:a.contatoEmergencia.telefone,onChange:l,className:"input"})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium mb-2",children:"Relação"}),Te.jsx("input",{type:"text",name:"contatoEmergencia.relacao",value:a.contatoEmergencia.relacao,onChange:l,className:"input"})]})]})]})]}),Te.jsxs("div",{className:"flex justify-end gap-4 px-6 py-5 border-t border-slate-100 bg-white shrink-0",children:[Te.jsx("button",{type:"button",onClick:t,className:"btn btn-secondary",children:"Cancelar"}),Te.jsx("button",{type:"submit",disabled:i,className:"btn btn-primary",children:i?"Salvando...":"Salvar"})]})]})]})})}function Sr({searchTerm:e,onSearchChange:s,placeholder:t,children:a}){return Te.jsxs("div",{className:"card p-4 flex flex-col md:flex-row gap-4 items-center justify-between",children:[Te.jsxs("div",{className:"relative w-full md:w-96",children:[Te.jsx(M,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:20}),Te.jsx("input",{type:"text",placeholder:t||"Buscar...",value:e,onChange:e=>s(e.target.value),className:"w-full pl-10 pr-4 py-2 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 transition"})]}),Te.jsx("div",{className:"flex flex-wrap gap-3 w-full md:w-auto justify-end",children:a})]})}function kr({icon:e,title:s,description:t,actionLabel:a,onAction:r}){return Te.jsxs("div",{className:"text-center py-16",children:[Te.jsx("div",{className:"w-16 h-16 bg-slate-50 rounded-full flex items-center justify-center mx-auto mb-4",children:Te.jsx(e,{size:32,className:"text-slate-300"})}),Te.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:s}),Te.jsx("p",{className:"text-slate-500 mt-1",children:t}),a&&r&&Te.jsx("button",{onClick:r,className:"btn btn-primary mt-4",children:a})]})}function Er(){const[s,t]=e.useState([]),[a,r]=e.useState(!0),[i,n]=e.useState(""),[l,o]=e.useState(""),[c,d]=e.useState(!1),[m,x]=e.useState(null),[u,p]=e.useState(null),[h,f]=e.useState([]);wr(Boolean(c||u)),e.useEffect(()=>{g()},[]),e.useEffect(()=>{if(!u)return;const e=e=>{"Escape"===e.key&&v()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[u]);const g=async(e="")=>{try{r(!0);const s=new URLSearchParams;e&&s.append("search",e),l&&s.append("status",l);const a=await ur(s.toString()),i=Array.isArray(a)?a:a.pacientes||[];t(i)}catch(s){b.error(Za("load","pacientes"))}finally{r(!1)}},j=async e=>{try{p(e);const s=await pr(e.id||e._id);f(s.prescricoes||[])}catch(s){b.error(Za("load","histórico"))}},v=()=>{p(null),f([])},y=e=>{x(e),d(!0)},N=async e=>{if(window.confirm("Tem certeza que deseja excluir este paciente?"))try{await br(e),b.success(Xa("delete","Paciente")),g(i)}catch(s){b.error(Za("delete","paciente"))}},w=s.filter(e=>e.nome.toLowerCase().includes(i.toLowerCase())||e.cpf&&e.cpf.includes(i)),k={total:s.length,novosMes:s.filter(e=>{if(!e.createdAt)return!1;const s=new Date(e.createdAt),t=new Date;return s.getMonth()===t.getMonth()&&s.getFullYear()===t.getFullYear()}).length,idadeMedia:s.length>0?Math.round(s.reduce((e,s)=>{if(!s.dataNascimento)return e;return e+((new Date).getFullYear()-new Date(s.dataNascimento).getFullYear())},0)/s.length):0};return Te.jsxs("div",{className:"space-y-8",children:[Te.jsx(dr,{label:"Cadastros",title:"Residentes",subtitle:"Gerencie os residentes da instituição, histórico clínico e dados pessoais.",children:Te.jsxs("button",{onClick:()=>d(!0),className:"btn btn-primary flex items-center justify-center gap-2 shadow-lg shadow-primary-500/20",children:[Te.jsx(_,{size:20})," Novo Residente"]})}),Te.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[Te.jsx(mr,{icon:C,label:"Total",value:k.total,description:"Residentes cadastrados",color:"primary"}),Te.jsx(mr,{icon:I,label:"Novos",value:`+${k.novosMes}`,description:"Cadastrados este mês",color:"emerald"}),Te.jsx(mr,{icon:P,label:"Média",value:`${k.idadeMedia} anos`,description:"Idade média dos residentes",color:"purple"})]}),Te.jsxs(Sr,{searchTerm:i,onSearchChange:n,placeholder:"Buscar por nome ou CPF...",children:[Te.jsxs("select",{value:l,onChange:e=>o(e.target.value),className:"px-4 py-2 border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-primary-500 focus:border-transparent outline-none",children:[Te.jsx("option",{value:"",children:"Todos os status"}),Te.jsx("option",{value:"ativo",children:"Ativos"}),Te.jsx("option",{value:"inativo",children:"Inativos"})]}),Te.jsxs("button",{type:"button",onClick:()=>g(i),className:"btn btn-secondary flex items-center gap-2",children:[Te.jsx(A,{size:18})," Atualizar"]})]}),Te.jsx("div",{className:"card overflow-hidden",children:a?Te.jsx("div",{className:"flex justify-center py-12",children:Te.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})}):w.length>0?Te.jsxs(Te.Fragment,{children:[Te.jsx("div",{className:"md:hidden p-4 sm:p-6 space-y-3",children:w.map(e=>Te.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white shadow-sm p-4",children:Te.jsxs("div",{className:"flex items-start gap-3",children:[Te.jsx("div",{className:"w-10 h-10 rounded-full bg-primary-50 flex items-center justify-center text-primary-600 font-bold text-sm shrink-0",children:e.nome.charAt(0)}),Te.jsxs("div",{className:"min-w-0 flex-1",children:[Te.jsx("p",{className:"font-semibold text-slate-900 truncate",children:e.nome}),Te.jsxs("div",{className:"mt-1 text-sm text-slate-600 space-y-1",children:[Te.jsxs("p",{className:"truncate",children:["CPF: ",e.cpf||"-"]}),Te.jsxs("p",{children:["Nascimento:"," ",e.dataNascimento?new Date(e.dataNascimento).toLocaleDateString("pt-BR"):"-"]}),Te.jsxs("p",{className:"truncate",children:["Telefone: ",e.telefone||"-"]})]}),Te.jsxs("div",{className:"mt-4 flex items-center justify-end gap-2",children:[Te.jsx("button",{type:"button",onClick:()=>j(e),className:"px-3 py-2 text-emerald-700 hover:text-emerald-800 hover:bg-emerald-50 rounded-lg transition-colors text-sm font-semibold",children:"Histórico"}),Te.jsx("button",{type:"button",onClick:()=>y(e),className:"px-3 py-2 text-slate-600 hover:text-primary-700 hover:bg-primary-50 rounded-lg transition-colors text-sm font-semibold",children:"Editar"}),Te.jsx("button",{type:"button",onClick:()=>N(e.id||e._id),className:"px-3 py-2 text-red-600 hover:text-red-700 hover:bg-red-50 rounded-lg transition-colors text-sm font-semibold",children:"Excluir"})]})]})]})},e.id||e._id))}),Te.jsx("div",{className:"hidden md:block overflow-x-auto custom-scrollbar -mx-4 sm:-mx-6 md:-mx-8",children:Te.jsxs("table",{className:"w-full min-w-[760px]",children:[Te.jsx("thead",{className:"bg-slate-50 border-b border-slate-100 whitespace-nowrap",children:Te.jsxs("tr",{children:[Te.jsx("th",{className:"px-4 sm:px-6 py-4 text-left text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Nome"}),Te.jsx("th",{className:"px-4 sm:px-6 py-4 text-left text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"CPF"}),Te.jsx("th",{className:"px-4 sm:px-6 py-4 text-left text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Nascimento"}),Te.jsx("th",{className:"px-4 sm:px-6 py-4 text-left text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Telefone"}),Te.jsx("th",{className:"px-4 sm:px-6 py-4 text-right text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Ações"})]})}),Te.jsx("tbody",{className:"divide-y divide-slate-100",children:w.map(e=>Te.jsxs("tr",{className:"hover:bg-slate-50/50 transition",children:[Te.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap",children:Te.jsxs("div",{className:"flex items-center gap-3",children:[Te.jsx("div",{className:"w-8 h-8 rounded-full bg-primary-50 flex items-center justify-center text-primary-600 font-bold text-xs",children:e.nome.charAt(0)}),Te.jsx("span",{className:"font-medium text-slate-900",children:e.nome})]})}),Te.jsx("td",{className:"px-4 sm:px-6 py-4 text-sm text-slate-600 whitespace-nowrap",children:e.cpf}),Te.jsx("td",{className:"px-4 sm:px-6 py-4 text-sm text-slate-600 whitespace-nowrap",children:new Date(e.dataNascimento).toLocaleDateString("pt-BR")}),Te.jsx("td",{className:"px-4 sm:px-6 py-4 text-sm text-slate-600 whitespace-nowrap",children:e.telefone}),Te.jsx("td",{className:"px-4 sm:px-6 py-4 text-right whitespace-nowrap",children:Te.jsxs("div",{className:"flex items-center justify-end gap-2",children:[Te.jsx("button",{onClick:()=>j(e),className:"p-2 text-slate-400 hover:text-emerald-600 hover:bg-emerald-50 rounded-lg transition",title:"Ver Histórico",children:Te.jsx(S,{size:16})}),Te.jsx("button",{onClick:()=>y(e),className:"p-2 text-slate-400 hover:text-primary-600 hover:bg-primary-50 rounded-lg transition",title:"Editar",children:Te.jsx(B,{size:16})}),Te.jsx("button",{onClick:()=>N(e.id||e._id),className:"p-2 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition",title:"Excluir",children:Te.jsx($,{size:16})})]})})]},e.id||e._id))})]})})]}):Te.jsx(kr,{icon:C,title:"Nenhum residente encontrado",description:"Cadastre o primeiro residente para começar.",actionLabel:"Cadastrar Residente",onAction:()=>d(!0)})}),c&&Te.jsx(Cr,{paciente:m,onClose:()=>{d(!1),x(null),g(i)}}),u&&Te.jsx("div",{className:"fixed inset-0 bg-slate-900/50 backdrop-blur-sm flex items-center justify-center z-[60] p-4",onMouseDown:e=>{e.target===e.currentTarget&&v()},children:Te.jsxs("div",{role:"dialog","aria-modal":"true",className:"bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",onMouseDown:e=>e.stopPropagation(),children:[Te.jsxs("div",{className:"p-6 border-b border-slate-100 flex justify-between items-center",children:[Te.jsxs("div",{children:[Te.jsxs("h3",{className:"text-xl font-bold text-slate-800 flex items-center gap-2",children:[Te.jsx(S,{className:"text-primary-600"}),"Histórico de Prescrições"]}),Te.jsxs("p",{className:"text-sm text-slate-500 mt-1",children:[u.nome," - ",u.cpf]})]}),Te.jsx("button",{onClick:v,className:"p-2 hover:bg-slate-100 rounded-full transition-colors",type:"button","aria-label":"Fechar modal",children:Te.jsx(U,{size:20,className:"text-slate-400"})})]}),Te.jsx("div",{className:"p-6 overflow-y-auto flex-1",children:h.length>0?Te.jsx("div",{className:"space-y-4",children:h.map(e=>{var s,t;return Te.jsxs("div",{className:"p-4 rounded-2xl border border-slate-100 bg-slate-50 hover:bg-slate-100 transition",children:[Te.jsxs("div",{className:"flex justify-between items-start mb-3",children:[Te.jsxs("div",{children:[Te.jsx("p",{className:"text-sm text-slate-500",children:new Date(e.createdAt).toLocaleString("pt-BR")}),Te.jsxs("p",{className:"text-sm font-medium text-slate-700 mt-1",children:["Dr(a). ",(null==(s=e.medicoId)?void 0:s.nome)||"Não informado",(null==(t=e.medicoId)?void 0:t.crm)&&` - CRM ${e.medicoId.crm}`]})]}),Te.jsxs("div",{className:"flex gap-2",children:[Te.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-semibold "+("controlado"===e.tipo?"bg-orange-100 text-orange-700":"bg-primary-100 text-primary-700"),children:"controlado"===e.tipo?"Controlado":"Comum"}),Te.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-semibold "+("ativa"===e.status?"bg-emerald-100 text-emerald-700":"bg-slate-100 text-slate-700"),children:e.status})]})]}),e.medicamentos&&e.medicamentos.length>0&&Te.jsxs("div",{className:"mt-3",children:[Te.jsx("p",{className:"text-xs font-semibold text-slate-500 uppercase mb-2",children:"Medicamentos"}),Te.jsx("ul",{className:"space-y-1",children:e.medicamentos.map((e,s)=>Te.jsxs("li",{className:"text-sm text-slate-700",children:["• ",e.nome,e.dosagem&&` - ${e.dosagem}`,e.via&&` (${e.via})`]},s))})]}),e.observacoes&&Te.jsxs("div",{className:"mt-3 p-3 bg-white rounded-lg",children:[Te.jsx("p",{className:"text-xs font-semibold text-slate-500 uppercase mb-1",children:"Observações"}),Te.jsx("p",{className:"text-sm text-slate-600",children:e.observacoes})]})]},e._id)})}):Te.jsxs("div",{className:"text-center py-12",children:[Te.jsx(S,{size:48,className:"mx-auto text-slate-300 mb-3"}),Te.jsx("p",{className:"text-slate-500",children:"Nenhuma prescrição encontrada"}),Te.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Este paciente ainda não possui prescrições registradas."})]})})]})})]})}const Ar=async(e={})=>{const s=La(e);return Fa(`/prescricoes${s}`)},Pr=async e=>Ua("/prescricoes",e),Rr=async e=>Ma(`/prescricoes/${e}/cancelar`);function zr(){const[s,t]=e.useState([]),[a,r]=e.useState([]),[i,n]=e.useState(!0),[l,o]=e.useState(!1),[c,d]=e.useState(""),[m,x]=e.useState("comum"),[u,p]=e.useState([{nome:"",dosagem:"",frequencia:"",duracao:"",observacoes:""}]),[h,f]=e.useState("todas"),[g,j]=e.useState("todas"),[v,y]=e.useState(null);wr(l),e.useEffect(()=>{N()},[]),e.useEffect(()=>{if(!l)return;const e=e=>{"Escape"===e.key&&o(!1)};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[l]);const N=async()=>{try{n(!0);const[e,s]=await Promise.all([Ar(),ur()]),a=Array.isArray(e)?e:e.prescricoes||[];t(a);const i=Array.isArray(s)?s:s.pacientes||[];r(i)}catch(e){b.error(Za("load","dados"))}finally{n(!1)}},w=(e,s,t)=>{const a=[...u];a[e][s]=t,p(a)},C=async e=>{if(window.confirm("Tem certeza que deseja cancelar esta prescrição?"))try{await Rr(e),b.success("Prescrição cancelada"),y({type:"warning",message:"Prescrição foi cancelada."}),N()}catch(s){b.error(Za("cancel","prescrição"))}},k=s.filter(e=>("todas"===h||e.status===h)&&("todas"===g||e.tipo===g)),E={total:s.length,ativas:s.filter(e=>"ativa"===e.status).length,controladas:s.filter(e=>"controlado"===e.tipo).length,hoje:s.filter(e=>{const s=new Date(e.createdAt),t=new Date;return s.getDate()===t.getDate()&&s.getMonth()===t.getMonth()&&s.getFullYear()===t.getFullYear()}).length};return Te.jsxs("div",{className:"space-y-8",children:[Te.jsxs(dr,{label:"Operação Clínica",title:"Prescrições",subtitle:"Controle total das prescrições emitidas, status em tempo real e histórico completo.",children:[Te.jsxs("button",{onClick:()=>o(!0),className:"btn btn-primary flex items-center justify-center gap-2 shadow-lg shadow-primary-500/20",children:[Te.jsx(_,{size:18})," Nova Prescrição"]}),Te.jsxs("button",{type:"button",onClick:N,className:"btn btn-secondary flex items-center justify-center gap-2",children:[Te.jsx(A,{size:18})," Atualizar"]})]}),Te.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[Te.jsx(mr,{icon:S,label:"Total",value:E.total,description:"Prescrições emitidas",color:"primary"}),Te.jsx(mr,{icon:I,label:"Ativas",value:E.ativas,description:"Em vigência",color:"emerald"}),Te.jsx(mr,{icon:V,label:"Controladas",value:E.controladas,description:"Medicamentos especiais",color:"orange"}),Te.jsx(mr,{icon:_,label:"Hoje",value:`+${E.hoje}`,description:"Emitidas hoje",color:"purple"})]}),Te.jsx("div",{className:"card p-4",children:Te.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between",children:[Te.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-500",children:[Te.jsx(H,{size:16}),Te.jsx("span",{className:"font-medium",children:"Filtros:"})]}),Te.jsxs("div",{className:"flex flex-wrap gap-3 w-full md:w-auto",children:[Te.jsxs("select",{value:h,onChange:e=>f(e.target.value),className:"px-4 py-2 bg-slate-50 border border-slate-200 rounded-xl text-sm text-slate-600 focus:outline-none focus:border-primary-500",children:[Te.jsx("option",{value:"todas",children:"Todos os Status"}),Te.jsx("option",{value:"ativa",children:"Ativas"}),Te.jsx("option",{value:"cancelada",children:"Canceladas"})]}),Te.jsxs("select",{value:g,onChange:e=>j(e.target.value),className:"px-4 py-2 bg-slate-50 border border-slate-200 rounded-xl text-sm text-slate-600 focus:outline-none focus:border-primary-500",children:[Te.jsx("option",{value:"todas",children:"Todos os Tipos"}),Te.jsx("option",{value:"comum",children:"Comum"}),Te.jsx("option",{value:"controlado",children:"Controlado"})]})]})]})}),v&&Te.jsxs("div",{className:"card flex items-center gap-3 border "+("success"===v.type?"border-emerald-200 bg-emerald-50":"border-amber-200 bg-amber-50"),children:[Te.jsx(I,{className:"text-emerald-500",size:20}),Te.jsx("p",{className:"text-sm text-slate-700",children:v.message}),Te.jsx("button",{className:"ml-auto text-xs text-slate-500",onClick:()=>y(null),children:"Fechar"})]}),Te.jsx("div",{className:"card overflow-hidden",children:i?Te.jsx("div",{className:"flex justify-center py-12",children:Te.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})}):k.length>0?Te.jsxs(Te.Fragment,{children:[Te.jsx("div",{className:"md:hidden p-4 sm:p-6 space-y-3",children:k.map(e=>Te.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white shadow-sm p-4",children:[Te.jsxs("div",{className:"flex items-start justify-between gap-3",children:[Te.jsxs("div",{className:"min-w-0",children:[Te.jsx("p",{className:"font-semibold text-slate-900 truncate",children:e.pacienteNome||"Paciente"}),Te.jsxs("p",{className:"text-sm text-slate-600",children:[new Date(e.createdAt).toLocaleDateString("pt-BR")," •"," ",new Date(e.createdAt).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})]})]}),Te.jsx("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium border shrink-0 "+("ativa"===e.status?"bg-emerald-50 text-emerald-700 border-emerald-100":"bg-red-50 text-red-700 border-red-100"),children:"ativa"===e.status?Te.jsxs(Te.Fragment,{children:[Te.jsx(I,{size:12})," Ativa"]}):Te.jsxs(Te.Fragment,{children:[Te.jsx(U,{size:12})," Cancelada"]})})]}),Te.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[Te.jsx("span",{className:"px-2.5 py-1 rounded-full text-xs font-medium "+("controlado"===e.tipo?"bg-orange-100 text-orange-700":"bg-blue-100 text-blue-700"),children:"controlado"===e.tipo?"Controlado":"Comum"}),Te.jsx("span",{className:"text-xs text-slate-600",children:e.medicamentos&&e.medicamentos.length>0?Te.jsxs(Te.Fragment,{children:[Te.jsx("span",{className:"font-medium",children:e.medicamentos[0].nome}),e.medicamentos.length>1&&Te.jsxs("span",{className:"text-slate-400",children:[" +",e.medicamentos.length-1," outros"]})]}):Te.jsx("span",{className:"text-slate-400",children:"Sem medicamentos"})})]}),"ativa"===e.status&&Te.jsx("div",{className:"mt-4 flex justify-end",children:Te.jsx("button",{type:"button",onClick:()=>C(e.id||e._id),className:"px-3 py-2 text-red-600 hover:text-red-700 hover:bg-red-50 rounded-lg transition-colors text-sm font-semibold",children:"Cancelar"})})]},e.id||e._id))}),Te.jsx("div",{className:"hidden md:block overflow-x-auto custom-scrollbar -mx-4 sm:-mx-6 md:-mx-8",children:Te.jsxs("table",{className:"w-full min-w-[1100px]",children:[Te.jsx("thead",{className:"bg-slate-50 border-b border-slate-100 whitespace-nowrap",children:Te.jsxs("tr",{children:[Te.jsx("th",{className:"px-4 sm:px-6 py-4 text-left text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Paciente"}),Te.jsx("th",{className:"px-4 sm:px-6 py-4 text-left text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Data Emissão"}),Te.jsx("th",{className:"px-4 sm:px-6 py-4 text-left text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Tipo"}),Te.jsx("th",{className:"px-4 sm:px-6 py-4 text-left text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Medicamentos"}),Te.jsx("th",{className:"px-4 sm:px-6 py-4 text-left text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Status"}),Te.jsx("th",{className:"px-4 sm:px-6 py-4 text-right text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Ações"})]})}),Te.jsx("tbody",{className:"divide-y divide-slate-100",children:k.map(e=>Te.jsxs("tr",{className:"hover:bg-slate-50/50 transition",children:[Te.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap",children:Te.jsxs("div",{className:"flex items-center gap-3",children:[Te.jsx("div",{className:"w-8 h-8 rounded-full bg-primary-50 flex items-center justify-center text-primary-600 font-bold text-xs",children:e.pacienteNome?e.pacienteNome.charAt(0):"P"}),Te.jsx("span",{className:"font-medium text-slate-900",children:e.pacienteNome})]})}),Te.jsxs("td",{className:"px-4 sm:px-6 py-4 text-sm text-slate-600 whitespace-nowrap",children:[new Date(e.createdAt).toLocaleDateString("pt-BR"),Te.jsx("span",{className:"text-xs text-slate-400 block",children:new Date(e.createdAt).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})})]}),Te.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap",children:Te.jsx("span",{className:"px-2.5 py-1 rounded-full text-xs font-medium "+("controlado"===e.tipo?"bg-orange-100 text-orange-700":"bg-blue-100 text-blue-700"),children:"controlado"===e.tipo?"Controlado":"Comum"})}),Te.jsx("td",{className:"px-4 sm:px-6 py-4 text-sm text-slate-600",children:e.medicamentos&&e.medicamentos.length>0?Te.jsxs("div",{children:[Te.jsx("span",{className:"font-medium",children:e.medicamentos[0].nome}),e.medicamentos.length>1&&Te.jsxs("span",{className:"text-slate-400 text-xs ml-1",children:["+",e.medicamentos.length-1," outros"]})]}):Te.jsx("span",{className:"text-slate-400",children:"-"})}),Te.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap",children:Te.jsx("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium "+("ativa"===e.status?"bg-emerald-50 text-emerald-700 border border-emerald-100":"bg-red-50 text-red-700 border border-red-100"),children:"ativa"===e.status?Te.jsxs(Te.Fragment,{children:[Te.jsx(I,{size:12})," Ativa"]}):Te.jsxs(Te.Fragment,{children:[Te.jsx(U,{size:12})," Cancelada"]})})}),Te.jsx("td",{className:"px-4 sm:px-6 py-4 text-right whitespace-nowrap",children:"ativa"===e.status&&Te.jsx("button",{onClick:()=>C(e.id||e._id),className:"text-red-600 hover:text-red-800 text-xs font-semibold hover:underline",children:"Cancelar"})})]},e.id||e._id))})]})})]}):Te.jsx(kr,{icon:V,title:"Nenhuma prescrição encontrada",description:"Comece emitindo uma nova prescrição.",actionLabel:"Nova Prescrição",onAction:()=>o(!0)})}),l&&Te.jsx("div",{className:"fixed inset-0 bg-slate-900/70 flex items-center justify-center p-4 z-50",onMouseDown:e=>{e.target===e.currentTarget&&o(!1)},children:Te.jsxs("div",{role:"dialog","aria-modal":"true",className:"bg-white rounded-2xl sm:rounded-3xl max-w-4xl w-full max-h-[90vh] overflow-hidden shadow-2xl flex flex-col",onMouseDown:e=>e.stopPropagation(),children:[Te.jsxs("div",{className:"flex justify-between items-center px-6 py-5 border-b border-slate-100 bg-white/90 backdrop-blur-sm shrink-0",children:[Te.jsxs("div",{children:[Te.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Cadastro"}),Te.jsx("h2",{className:"text-2xl font-bold",children:"Nova Prescrição"})]}),Te.jsx("button",{onClick:()=>o(!1),className:"p-2 hover:bg-slate-50 rounded-2xl",type:"button","aria-label":"Fechar modal",children:Te.jsx(U,{size:24})})]}),Te.jsxs("form",{onSubmit:async e=>{e.preventDefault();try{await Pr({pacienteId:c,tipo:m,medicamentos:u.filter(e=>""!==e.nome.trim())}),b.success(Xa("create","Prescrição",{gender:"f"})),o(!1),d(""),x("comum"),p([{nome:"",dosagem:"",frequencia:"",duracao:"",observacoes:""}]),y({type:"success",message:"Prescrição cadastrada com sucesso."}),N()}catch(s){b.error(Za("create","prescrição"))}},className:"flex flex-col flex-1 min-h-0",children:[Te.jsxs("div",{className:"p-6 space-y-6 overflow-y-auto custom-scrollbar",children:[Te.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium mb-2",children:"Paciente *"}),Te.jsxs("select",{value:c,onChange:e=>d(e.target.value),className:"input",required:!0,children:[Te.jsx("option",{value:"",children:"Selecione um paciente"}),a.map(e=>Te.jsx("option",{value:e.id,children:e.nome},e.id))]})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium mb-2",children:"Tipo *"}),Te.jsxs("select",{value:m,onChange:e=>x(e.target.value),className:"input",required:!0,children:[Te.jsx("option",{value:"comum",children:"Comum"}),Te.jsx("option",{value:"controlado",children:"Controlado"})]})]})]}),Te.jsxs("div",{children:[Te.jsxs("div",{className:"flex flex-col gap-2 md:flex-row md:items-center md:justify-between mb-4",children:[Te.jsxs("div",{children:[Te.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Sessão"}),Te.jsx("h3",{className:"text-lg font-semibold",children:"Medicamentos"})]}),Te.jsxs("button",{type:"button",onClick:()=>{p([...u,{nome:"",dosagem:"",frequencia:"",duracao:"",observacoes:""}])},className:"btn btn-secondary flex items-center gap-2",children:[Te.jsx(_,{size:18}),"Adicionar"]})]}),Te.jsx("div",{className:"space-y-4",children:u.map((e,s)=>Te.jsxs("div",{className:"p-4 border border-slate-100 rounded-2xl",children:[Te.jsxs("div",{className:"flex justify-between items-start mb-3",children:[Te.jsxs("h4",{className:"font-medium",children:["Medicamento ",s+1]}),u.length>1&&Te.jsx("button",{type:"button",onClick:()=>(e=>{p(u.filter((s,t)=>t!==e))})(s),className:"text-red-600 hover:bg-red-50 p-1 rounded-xl",children:Te.jsx(U,{size:18})})]}),Te.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[Te.jsxs("div",{className:"md:col-span-2",children:[Te.jsx("label",{className:"block text-sm font-medium mb-1",children:"Nome *"}),Te.jsx("input",{type:"text",value:e.nome,onChange:e=>w(s,"nome",e.target.value),className:"input",required:!0})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium mb-1",children:"Dosagem *"}),Te.jsx("input",{type:"text",value:e.dosagem,onChange:e=>w(s,"dosagem",e.target.value),className:"input",placeholder:"Ex: 500mg",required:!0})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium mb-1",children:"Frequência *"}),Te.jsx("input",{type:"text",value:e.frequencia,onChange:e=>w(s,"frequencia",e.target.value),className:"input",placeholder:"Ex: 8/8h",required:!0})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium mb-1",children:"Duração *"}),Te.jsx("input",{type:"text",value:e.duracao,onChange:e=>w(s,"duracao",e.target.value),className:"input",placeholder:"Ex: 7 dias",required:!0})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium mb-1",children:"Observações"}),Te.jsx("input",{type:"text",value:e.observacoes,onChange:e=>w(s,"observacoes",e.target.value),className:"input"})]})]})]},s))})]})]}),Te.jsxs("div",{className:"flex justify-end gap-4 px-6 py-5 border-t border-slate-100 bg-white shrink-0",children:[Te.jsx("button",{type:"button",onClick:()=>o(!1),className:"btn btn-secondary",children:"Cancelar"}),Te.jsx("button",{type:"submit",className:"btn btn-primary",children:"Criar Prescrição"})]})]})]})})]})}function Dr(){const[s,t]=e.useState([]),[a,r]=e.useState(!0),[i,n]=e.useState(""),[l,o]=e.useState("todos");e.useEffect(()=>{c()},[]);const c=async()=>{try{r(!0);const[e,s]=await Promise.all([ur(),Ar()]),a=Array.isArray(e)?e:e.pacientes||[],i=Array.isArray(s)?s:s.prescricoes||[],n=a.map(e=>{const s=e.id||e._id,t=i.filter(e=>{var t;return(e.pacienteId===s||(null==(t=e.pacienteId)?void 0:t._id)===s)&&"ativa"===e.status});return{...e,id:s,hasPrescription:t.length>0,prescriptionCount:t.length,prescriptions:t}});t(n)}catch(e){b.error(Za("load","dados do censo"))}finally{r(!1)}},d=s.filter(e=>{const s=e.nome.toLowerCase().includes(i.toLowerCase())||e.cpf&&e.cpf.includes(i);return"todos"===l?s:"com_prescricao"===l?s&&e.hasPrescription:"sem_prescricao"===l?s&&!e.hasPrescription:s}),m={total:s.length,comPrescricao:s.filter(e=>e.hasPrescription).length,semPrescricao:s.filter(e=>!e.hasPrescription).length};return Te.jsxs("div",{className:"space-y-8",children:[Te.jsx(dr,{label:"Controle",title:"Censo M.P.",subtitle:"Mapa de Prescrições: Acompanhe quais residentes possuem prescrições ativas.",children:Te.jsxs("button",{type:"button",onClick:c,className:"btn btn-secondary flex items-center justify-center gap-2",children:[Te.jsx(A,{size:18})," Atualizar"]})}),Te.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[Te.jsx(mr,{icon:C,label:"Total",value:m.total,description:"Residentes cadastrados",color:"primary"}),Te.jsx(mr,{icon:I,label:"Cobertos",value:m.comPrescricao,description:"Com prescrição ativa",color:"emerald"}),Te.jsx(mr,{icon:G,label:"Pendentes",value:m.semPrescricao,description:"Sem prescrição ativa",color:"red"})]}),Te.jsx(Sr,{searchTerm:i,onSearchChange:n,placeholder:"Buscar residente...",filters:[{label:"Todos",value:"todos"},{label:"Com Prescrição",value:"com_prescricao"},{label:"Sem Prescrição",value:"sem_prescricao"}],activeFilter:l,onFilterChange:o}),Te.jsx("div",{className:"card overflow-hidden",children:a?Te.jsx("div",{className:"flex justify-center py-12",children:Te.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})}):d.length>0?Te.jsx("div",{className:"overflow-x-auto custom-scrollbar -mx-4 sm:-mx-6 md:-mx-8",children:Te.jsxs("table",{className:"w-full min-w-[860px]",children:[Te.jsx("thead",{className:"bg-slate-50 border-b border-slate-100 whitespace-nowrap",children:Te.jsxs("tr",{children:[Te.jsx("th",{className:"px-4 sm:px-6 py-4 text-left text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Residente"}),Te.jsx("th",{className:"px-4 sm:px-6 py-4 text-left text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Status"}),Te.jsx("th",{className:"px-4 sm:px-6 py-4 text-left text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Prescrições Ativas"}),Te.jsx("th",{className:"px-4 sm:px-6 py-4 text-left text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Detalhes"})]})}),Te.jsx("tbody",{className:"divide-y divide-slate-100",children:d.map(e=>Te.jsxs("tr",{className:"hover:bg-slate-50/50 transition",children:[Te.jsx("td",{className:"px-4 sm:px-6 py-4",children:Te.jsxs("div",{className:"flex items-center gap-3",children:[Te.jsx("div",{className:"w-10 h-10 rounded-full bg-primary-50 flex items-center justify-center text-primary-600 font-bold text-sm",children:e.nome.charAt(0)}),Te.jsxs("div",{children:[Te.jsx("p",{className:"font-medium text-slate-900",children:e.nome}),Te.jsxs("p",{className:"text-xs text-slate-500",children:["CPF: ",e.cpf||"N/A"]})]})]})}),Te.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap",children:e.hasPrescription?Te.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-medium bg-emerald-50 text-emerald-700 border border-emerald-100",children:[Te.jsx(I,{size:14})," Coberto"]}):Te.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-medium bg-red-50 text-red-700 border border-red-100",children:[Te.jsx(G,{size:14})," Pendente"]})}),Te.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap",children:Te.jsxs("div",{className:"flex items-center gap-2",children:[Te.jsx(J,{size:16,className:"text-slate-400"}),Te.jsxs("span",{className:"text-sm font-medium text-slate-700",children:[e.prescriptionCount," prescrições"]})]})}),Te.jsx("td",{className:"px-4 sm:px-6 py-4",children:e.hasPrescription?Te.jsx("div",{className:"flex flex-col gap-1",children:e.prescriptions.map(e=>{var s,t,a;return Te.jsxs("span",{className:"text-xs text-slate-500 bg-slate-100 px-2 py-1 rounded inline-block w-fit",children:[null==(t=null==(s=e.medicamentos)?void 0:s[0])?void 0:t.nome,(null==(a=e.medicamentos)?void 0:a.length)>1&&" +"+(e.medicamentos.length-1)]},e.id)})}):Te.jsx("span",{className:"text-xs text-slate-400 italic",children:"Nenhuma prescrição ativa"})})]},e.id||e._id))})]})}):Te.jsx("div",{className:"p-12",children:Te.jsx(kr,{icon:C,title:"Nenhum residente encontrado",description:"Tente ajustar os filtros de busca."})})})]})}const Tr=async()=>Fa("/usuarios"),Or=async e=>Ua("/usuarios",e),qr=async(e,s)=>Ma(`/usuarios/${e}`,s),Lr=async(e,s,t)=>Ma(`/usuarios/${e}/senha`,{senhaAtual:s,novaSenha:t}),Fr=async e=>_a(`/usuarios/${e}`),Ur=async()=>Fa("/usuarios/me/summary"),Mr=async e=>Ma("/usuarios/me",e);function _r({usuario:s,onClose:t}){wr(!0);const[a,r]=e.useState({nome:"",email:"",senha:"",telefone:"",especialidade:"",crm:"",crmUf:"",role:"atendente",permissoes:[],ativo:!0}),[i,n]=e.useState(!1);e.useEffect(()=>{s&&r({nome:s.nome||"",email:s.email||"",senha:"",telefone:s.telefone||"",especialidade:s.especialidade||"",crm:s.crm||"",crmUf:s.crmUf||"",role:s.role||"atendente",permissoes:s.permissoes||[],ativo:void 0===s.ativo||s.ativo})},[s]),e.useEffect(()=>{const e=e=>{"Escape"===e.key&&(null==t||t())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[t]);return Te.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",onMouseDown:e=>{e.target===e.currentTarget&&(null==t||t())},children:Te.jsxs("div",{role:"dialog","aria-modal":"true",className:"bg-white rounded-2xl sm:rounded-3xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-hidden flex flex-col",onMouseDown:e=>e.stopPropagation(),children:[Te.jsxs("div",{className:"flex items-center justify-between px-6 py-5 border-b border-slate-200 bg-white/90 backdrop-blur-sm shrink-0",children:[Te.jsxs("div",{children:[Te.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Cadastro"}),Te.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:s?"Editar Usuário":"Novo Usuário"})]}),Te.jsx("button",{type:"button",onClick:t,className:"p-2 hover:bg-slate-100 rounded-2xl transition-colors","aria-label":"Fechar modal",children:Te.jsx(U,{size:22,className:"text-slate-500"})})]}),Te.jsxs("form",{onSubmit:async e=>{e.preventDefault(),n(!0);try{if(null==s?void 0:s.id){const e={...a};e.senha||delete e.senha,await qr(s.id,e),b.success(Xa("update","Usuário",{suffix:"!"}))}else{if(!a.senha||a.senha.length<6)return b.error(er("minPassword")),void n(!1);await Or(a),b.success(Xa("create","Usuário",{suffix:"!"}))}t()}catch(r){b.error(sr(r,Za("save","usuário")))}finally{n(!1)}},className:"flex flex-col flex-1 min-h-0",children:[Te.jsx("div",{className:"p-6 space-y-4 overflow-y-auto custom-scrollbar",children:Te.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[Te.jsxs("div",{className:"md:col-span-2",children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Nome Completo *"}),Te.jsx("input",{type:"text",required:!0,className:"input",value:a.nome,onChange:e=>r({...a,nome:e.target.value})})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"E-mail *"}),Te.jsx("input",{type:"email",required:!0,className:"input",value:a.email,onChange:e=>r({...a,email:e.target.value})})]}),Te.jsxs("div",{children:[Te.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Senha ",!s&&"*"]}),Te.jsx("input",{type:"password",className:"input",placeholder:s?"Deixe em branco para manter":"Mínimo 6 caracteres",minLength:"6",value:a.senha,onChange:e=>r({...a,senha:e.target.value}),required:!s})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Telefone"}),Te.jsx("input",{type:"tel",className:"input",value:a.telefone,onChange:e=>r({...a,telefone:e.target.value})})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Especialidade"}),Te.jsxs("select",{className:"input",value:a.especialidade,onChange:e=>r({...a,especialidade:e.target.value}),children:[Te.jsx("option",{value:"",children:"Selecione uma especialidade"}),Te.jsx("option",{value:"Médico",children:"Médico"}),Te.jsx("option",{value:"Enfermeiro",children:"Enfermeiro"}),Te.jsx("option",{value:"Técnico de Enfermagem",children:"Técnico de Enfermagem"}),Te.jsx("option",{value:"Fisioterapeuta",children:"Fisioterapeuta"}),Te.jsx("option",{value:"Nutricionista",children:"Nutricionista"}),Te.jsx("option",{value:"Assistente Social",children:"Assistente Social"}),Te.jsx("option",{value:"Administrador",children:"Administrador"}),Te.jsx("option",{value:"Auxiliar Administrativo",children:"Auxiliar Administrativo"}),Te.jsx("option",{value:"Outro",children:"Outro"})]})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"CRM"}),Te.jsx("input",{type:"text",className:"input",value:a.crm,onChange:e=>r({...a,crm:e.target.value})})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"UF do CRM"}),Te.jsx("input",{type:"text",className:"input",maxLength:"2",placeholder:"Ex: BA",value:a.crmUf,onChange:e=>r({...a,crmUf:e.target.value.toUpperCase()})})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Função *"}),Te.jsxs("select",{required:!0,className:"input",value:a.role,onChange:e=>r({...a,role:e.target.value}),children:[Te.jsx("option",{value:"enfermeiro",children:"Enfermeiro"}),Te.jsx("option",{value:"tecnico_enfermagem",children:"Técnico de Enfermagem"}),Te.jsx("option",{value:"fisioterapeuta",children:"Fisioterapeuta"}),Te.jsx("option",{value:"nutricionista",children:"Nutricionista"}),Te.jsx("option",{value:"assistente_social",children:"Assistente Social"}),Te.jsx("option",{value:"auxiliar_administrativo",children:"Auxiliar Administrativo"}),Te.jsx("option",{value:"atendente",children:"Atendente"}),Te.jsx("option",{value:"admin",children:"Administrador"}),Te.jsx("option",{value:"superadmin",children:"Super Administrador"})]})]}),Te.jsxs("div",{className:"md:col-span-2",children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Permissões de Acesso"}),Te.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3 p-4 bg-slate-50 rounded-2xl border border-slate-200",children:[{id:"dashboard",label:"Dashboard"},{id:"agenda",label:"Agenda"},{id:"cronograma",label:"Cronograma"},{id:"prescricoes",label:"Prescrições"},{id:"pacientes",label:"Pacientes/Residentes"},{id:"estoque",label:"Estoque"},{id:"evolucao",label:"Evolução"},{id:"financeiro",label:"Financeiro"},{id:"usuarios",label:"Usuários"},{id:"empresas",label:"Empresas"},{id:"configuracoes",label:"Configurações"},{id:"relatorios",label:"Relatórios"}].map(e=>Te.jsxs("label",{className:"flex items-center gap-2 cursor-pointer hover:bg-slate-100 p-2 rounded-lg transition-colors",children:[Te.jsx("input",{type:"checkbox",className:"rounded text-primary-600 focus:ring-primary-500",checked:a.permissoes.includes(e.id),onChange:()=>{return s=e.id,void r(e=>{const t=e.permissoes.includes(s)?e.permissoes.filter(e=>e!==s):[...e.permissoes,s];return{...e,permissoes:t}});var s}}),Te.jsx("span",{className:"text-sm text-slate-700",children:e.label})]},e.id))}),Te.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Selecione os módulos que este usuário poderá acessar."})]}),Te.jsx("div",{className:"md:col-span-2",children:Te.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[Te.jsx("input",{type:"checkbox",className:"rounded text-primary-600",checked:a.ativo,onChange:e=>r({...a,ativo:e.target.checked})}),Te.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Usuário ativo"})]})})]})}),Te.jsxs("div",{className:"flex gap-3 px-6 py-5 border-t border-slate-200 bg-white shrink-0",children:[Te.jsx("button",{type:"button",onClick:t,className:"btn btn-secondary flex-1",disabled:i,children:"Cancelar"}),Te.jsx("button",{type:"submit",className:"btn btn-primary flex-1",disabled:i,children:i?"Salvando...":"Salvar"})]})]})]})})}function Ir({title:e="Acesso Negado",message:s="Você não tem permissão para acessar esta página.",messageClassName:t="text-slate-600"}){return Te.jsxs("div",{className:"card text-center py-12",children:[Te.jsx(W,{size:48,className:"mx-auto text-red-500 mb-4"}),Te.jsx("h2",{className:"text-2xl font-bold mb-2",children:e}),Te.jsx("p",{className:t,children:s})]})}function Br(){const{user:s}=Ga(),[t,a]=e.useState([]),[r,i]=e.useState(!0),[n,l]=e.useState(!1),[o,c]=e.useState(null),[d,m]=e.useState("comfortable"),[x,u]=e.useState(null),[p,h]=e.useState(""),f="admin"===(null==s?void 0:s.role)||"superadmin"===(null==s?void 0:s.role);e.useEffect(()=>{f?g():b.error(er("accessDenied"))},[f]);const g=async()=>{try{i(!0);const e=await Tr(),s=Array.isArray(e)?e:e.usuarios||[];a(s)}catch(e){b.error(Za("load","usuários"))}finally{i(!1)}},j=e=>{c(e),l(!0)},v=async e=>{if(e!==s.id){if(window.confirm("Tem certeza que deseja excluir este usuário?"))try{await Fr(e),b.success(Xa("delete","Usuário")),u({type:"success",message:"Usuário excluído e lista atualizada."}),g()}catch(t){b.error(Za("delete","usuário"))}}else b.error(er("cannotDeleteSelf"))},y=t.filter(e=>e.nome.toLowerCase().includes(p.toLowerCase())||e.email.toLowerCase().includes(p.toLowerCase())||e.crm&&e.crm.includes(p)),N=e=>"superadmin"===e?"Super Admin":"admin"===e?"Administrador":"nutricionista"===e?"Nutricionista":"atendente"===e?"Atendente":"enfermeiro"===e?"Enfermeiro":"tecnico_enfermagem"===e?"Técnico de Enfermagem":"fisioterapeuta"===e?"Fisioterapeuta":"assistente_social"===e?"Assistente Social":"auxiliar_administrativo"===e?"Auxiliar Administrativo":"Usuário";return f?Te.jsxs("div",{className:"space-y-8",children:[Te.jsxs(dr,{label:"Administração",title:"Usuários",subtitle:"Gerencie o acesso ao sistema, cadastre novos profissionais e mantenha a equipe atualizada.",children:[Te.jsxs("button",{type:"button",onClick:g,className:"btn btn-secondary flex items-center justify-center gap-2",children:[Te.jsx(A,{size:18})," Atualizar"]}),Te.jsxs("button",{onClick:()=>l(!0),className:"btn btn-primary flex items-center justify-center gap-2 shadow-lg shadow-primary-600/20",children:[Te.jsx(_,{size:18})," Novo Usuário"]})]}),Te.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[Te.jsx(mr,{icon:C,label:"Total de Usuários",value:t.length,color:"primary"}),Te.jsx(mr,{icon:I,label:"Usuários Ativos",value:t.filter(e=>e.ativo).length,color:"emerald"}),Te.jsx("div",{className:"hidden md:block"})]}),Te.jsx(Sr,{searchTerm:p,onSearchChange:h,placeholder:"Buscar por nome, email ou CRM...",children:Te.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-500 ml-auto",children:[Te.jsx("span",{children:"Densidade:"}),Te.jsx("button",{type:"button",onClick:()=>m(e=>"comfortable"===e?"compact":"comfortable"),className:"px-3 py-1 rounded-full text-xs font-semibold transition-colors "+("comfortable"===d?"bg-white shadow-sm text-primary-700 ring-1 ring-slate-200":"bg-slate-100 text-slate-600 hover:bg-slate-200"),children:"comfortable"===d?"Confortável":"Compacta"})]})}),x&&Te.jsxs("div",{className:"card border flex items-center gap-3 "+("success"===x.type?"border-emerald-200 bg-emerald-50":"border-amber-200 bg-amber-50"),children:[Te.jsx(I,{className:"text-emerald-500",size:20}),Te.jsx("p",{className:"text-sm text-slate-700",children:x.message}),Te.jsx("button",{className:"ml-auto text-xs text-slate-500 hover:text-slate-700",onClick:()=>u(null),children:"Fechar"})]}),Te.jsx("div",{className:"card overflow-hidden border border-slate-200 shadow-sm",children:r?Te.jsx("div",{className:"flex justify-center py-12",children:Te.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})}):y.length>0?Te.jsxs(Te.Fragment,{children:[Te.jsx("div",{className:"md:hidden p-4 sm:p-6 space-y-3",children:y.map(e=>Te.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white shadow-sm "+("compact"===d?"p-3":"p-4"),children:Te.jsxs("div",{className:"flex items-start gap-3",children:[Te.jsx("div",{className:"w-10 h-10 rounded-full bg-primary-100 flex items-center justify-center text-primary-700 font-bold text-sm shrink-0",children:e.nome.charAt(0).toUpperCase()}),Te.jsxs("div",{className:"min-w-0 flex-1",children:[Te.jsxs("div",{className:"flex items-start justify-between gap-3",children:[Te.jsxs("div",{className:"min-w-0",children:[Te.jsx("p",{className:"font-semibold text-slate-900 truncate",children:e.nome}),Te.jsx("p",{className:"text-sm text-slate-600 truncate",children:e.email})]}),Te.jsx("div",{className:"flex items-center gap-2 shrink-0",children:Te.jsx("span",{className:"px-2.5 py-1 text-xs rounded-full font-medium border "+("admin"===e.role||"superadmin"===e.role?"bg-purple-50 text-purple-700 border-purple-100":"bg-slate-100 text-slate-700 border-slate-200"),children:N(e.role)})})]}),Te.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[Te.jsx("span",{className:"px-2.5 py-1 text-xs rounded-full font-medium border "+(e.ativo?"bg-emerald-50 text-emerald-700 border-emerald-100":"bg-red-50 text-red-700 border-red-100"),children:e.ativo?"Ativo":"Inativo"}),e.crm?Te.jsxs("span",{className:"font-mono bg-slate-100 px-2.5 py-1 rounded-full text-xs text-slate-700 border border-slate-200",children:["CRM: ",e.crm]}):Te.jsx("span",{className:"text-xs text-slate-400",children:"CRM: -"})]}),Te.jsxs("div",{className:"mt-4 flex items-center justify-end gap-2",children:[Te.jsx("button",{type:"button",onClick:()=>j(e),className:"px-3 py-2 text-slate-600 hover:text-primary-700 hover:bg-primary-50 rounded-lg transition-colors text-sm font-semibold",children:"Editar"}),e.id!==s.id&&Te.jsx("button",{type:"button",onClick:()=>v(e.id),className:"px-3 py-2 text-red-600 hover:text-red-700 hover:bg-red-50 rounded-lg transition-colors text-sm font-semibold",children:"Excluir"})]})]})]})},e.id))}),Te.jsx("div",{className:"hidden md:block overflow-x-auto custom-scrollbar -mx-4 sm:-mx-6 md:-mx-8",children:Te.jsxs("table",{className:"w-full min-w-[960px]",children:[Te.jsx("thead",{className:"bg-slate-50 border-b border-slate-200 whitespace-nowrap",children:Te.jsxs("tr",{children:[Te.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Profissional"}),Te.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Contato"}),Te.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"CRM"}),Te.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Função"}),Te.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Status"}),Te.jsx("th",{className:"px-4 sm:px-6 py-3 text-right text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Ações"})]})}),Te.jsx("tbody",{className:"divide-y divide-slate-100 bg-white",children:y.map(e=>Te.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[Te.jsx("td",{className:`px-4 sm:px-6 ${"compact"===d?"py-3":"py-4"} whitespace-nowrap`,children:Te.jsxs("div",{className:"flex items-center gap-3",children:[Te.jsx("div",{className:"w-8 h-8 rounded-full bg-primary-100 flex items-center justify-center text-primary-700 font-bold text-xs",children:e.nome.charAt(0).toUpperCase()}),Te.jsx("div",{className:"font-medium text-slate-900",children:e.nome})]})}),Te.jsx("td",{className:`px-4 sm:px-6 ${"compact"===d?"py-3":"py-4"} whitespace-nowrap text-sm text-slate-600`,children:e.email}),Te.jsx("td",{className:`px-4 sm:px-6 ${"compact"===d?"py-3":"py-4"} whitespace-nowrap text-sm text-slate-600`,children:e.crm?Te.jsx("span",{className:"font-mono bg-slate-100 px-2 py-1 rounded text-xs",children:e.crm}):Te.jsx("span",{className:"text-slate-400",children:"-"})}),Te.jsx("td",{className:`px-4 sm:px-6 ${"compact"===d?"py-3":"py-4"} whitespace-nowrap`,children:Te.jsx("span",{className:"px-2.5 py-1 text-xs rounded-full font-medium border "+("admin"===e.role||"superadmin"===e.role?"bg-purple-50 text-purple-700 border-purple-100":"bg-slate-100 text-slate-700 border-slate-200"),children:N(e.role)})}),Te.jsx("td",{className:`px-4 sm:px-6 ${"compact"===d?"py-3":"py-4"} whitespace-nowrap`,children:Te.jsx("span",{className:"px-2.5 py-1 text-xs rounded-full font-medium border "+(e.ativo?"bg-emerald-50 text-emerald-700 border-emerald-100":"bg-red-50 text-red-700 border-red-100"),children:e.ativo?"Ativo":"Inativo"})}),Te.jsx("td",{className:`px-4 sm:px-6 ${"compact"===d?"py-3":"py-4"} whitespace-nowrap text-right`,children:Te.jsxs("div",{className:"flex items-center justify-end gap-2",children:[Te.jsx("button",{onClick:()=>j(e),className:"p-2 text-slate-500 hover:text-primary-600 hover:bg-primary-50 rounded-lg transition-colors",title:"Editar",children:Te.jsx(B,{size:16})}),e.id!==s.id&&Te.jsx("button",{onClick:()=>v(e.id),className:"p-2 text-slate-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Excluir",children:Te.jsx($,{size:16})})]})})]},e.id))})]})})]}):Te.jsx(kr,{icon:M,title:"Nenhum usuário encontrado",description:p?"Tente buscar com outros termos.":"Comece adicionando novos usuários ao sistema.",actionLabel:p?null:"Adicionar usuário",onAction:p?null:()=>l(!0)})}),n&&Te.jsx(_r,{usuario:o,onClose:()=>{l(!1),c(null),u({type:"success",message:"Dados atualizados após salvar usuário."}),g()}})]}):Te.jsx(Ir,{message:"Apenas administradores podem acessar esta página."})}const $r=async()=>Fa("/empresas"),Vr=async e=>Ua("/empresas",e),Hr=async e=>_a(`/empresas/${e}`),Gr=async()=>Fa("/empresas/me"),Jr=async e=>Ma("/empresas/me",e);function Wr({empresa:s,onClose:t,onSave:a}){wr(!0);const[r,i]=e.useState({nome:"",cnpj:"",email:"",telefone:"",endereco:"",plano:"basic",status:"ativo"}),[n,l]=e.useState(!1);e.useEffect(()=>{s&&i({nome:s.nome||"",cnpj:s.cnpj||"",email:s.email||"",telefone:s.telefone||"",endereco:s.endereco||"",plano:s.plano||"basic",status:s.status||"ativo"})},[s]),e.useEffect(()=>{const e=e=>{"Escape"===e.key&&(null==t||t())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[t]);return Te.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",onMouseDown:e=>{e.target===e.currentTarget&&(null==t||t())},children:Te.jsxs("div",{role:"dialog","aria-modal":"true",className:"bg-white rounded-2xl sm:rounded-3xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-hidden flex flex-col",onMouseDown:e=>e.stopPropagation(),children:[Te.jsxs("div",{className:"flex items-center justify-between px-6 py-5 border-b border-slate-200 bg-white/90 backdrop-blur-sm shrink-0",children:[Te.jsxs("div",{children:[Te.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Cadastro"}),Te.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:s?"Editar Empresa":"Nova Empresa"})]}),Te.jsx("button",{type:"button",onClick:t,className:"p-2 hover:bg-slate-100 rounded-2xl transition-colors","aria-label":"Fechar modal",children:Te.jsx(U,{size:22,className:"text-slate-500"})})]}),Te.jsxs("form",{onSubmit:async e=>{e.preventDefault(),l(!0);try{(null==s?void 0:s.id)?b.error("Edição de empresa ainda não implementada no backend"):(await Vr(r),b.success(Xa("create","Empresa",{gender:"f",suffix:"!"})),a()),t()}catch(i){b.error(sr(i,Za("save","empresa")))}finally{l(!1)}},className:"flex flex-col flex-1 min-h-0",children:[Te.jsx("div",{className:"p-6 space-y-4 overflow-y-auto custom-scrollbar",children:Te.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[Te.jsxs("div",{className:"md:col-span-2",children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Nome da Empresa *"}),Te.jsx("input",{type:"text",required:!0,className:"input",value:r.nome,onChange:e=>i({...r,nome:e.target.value})})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"CNPJ *"}),Te.jsx("input",{type:"text",required:!0,className:"input",value:r.cnpj,onChange:e=>i({...r,cnpj:e.target.value})})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"E-mail *"}),Te.jsx("input",{type:"email",required:!0,className:"input",value:r.email,onChange:e=>i({...r,email:e.target.value})})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Telefone"}),Te.jsx("input",{type:"tel",className:"input",value:r.telefone,onChange:e=>i({...r,telefone:e.target.value})})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Plano"}),Te.jsxs("select",{className:"input",value:r.plano,onChange:e=>i({...r,plano:e.target.value}),children:[Te.jsx("option",{value:"basic",children:"Básico"}),Te.jsx("option",{value:"pro",children:"Profissional"}),Te.jsx("option",{value:"enterprise",children:"Enterprise"})]})]}),Te.jsxs("div",{className:"md:col-span-2",children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Endereço"}),Te.jsx("input",{type:"text",className:"input",value:r.endereco,onChange:e=>i({...r,endereco:e.target.value})})]}),Te.jsxs("div",{className:"md:col-span-2",children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Status"}),Te.jsxs("select",{className:"input",value:r.status,onChange:e=>i({...r,status:e.target.value}),children:[Te.jsx("option",{value:"ativo",children:"Ativo"}),Te.jsx("option",{value:"inativo",children:"Inativo"}),Te.jsx("option",{value:"bloqueado",children:"Bloqueado"})]})]})]})}),Te.jsxs("div",{className:"flex gap-3 px-6 py-5 border-t border-slate-200 bg-white shrink-0",children:[Te.jsx("button",{type:"button",onClick:t,className:"btn btn-secondary flex-1",disabled:n,children:"Cancelar"}),Te.jsx("button",{type:"submit",className:"btn btn-primary flex-1",disabled:n,children:n?"Salvando...":"Salvar"})]})]})]})})}function Kr(){const{user:s}=Ga(),[t,a]=e.useState([]),[r,i]=e.useState(!0),[n,l]=e.useState("comfortable"),[o,c]=e.useState(!1),d="superadmin"===(null==s?void 0:s.role);e.useEffect(()=>{d?m():b.error(er("accessDenied"))},[d]);const m=async()=>{try{i(!0);const e=await $r(),s=Array.isArray(e)?e:e.empresas||[];a(s)}catch(e){b.error(Za("load","empresas"))}finally{i(!1)}},x=async e=>{if(window.confirm("Tem certeza que deseja excluir esta empresa?"))try{await Hr(e),b.success(Xa("delete","Empresa",{gender:"f"})),m()}catch(s){b.error(Za("delete","empresa"))}};return d?Te.jsxs("div",{className:"space-y-8",children:[Te.jsxs(dr,{label:"Gestão",title:"Empresas",subtitle:"Gerencie as empresas cadastradas no sistema.",children:[Te.jsxs("button",{type:"button",onClick:m,className:"btn btn-secondary flex items-center justify-center gap-2",children:[Te.jsx(A,{size:18})," Atualizar lista"]}),Te.jsxs("button",{onClick:()=>c(!0),className:"btn btn-primary flex items-center justify-center gap-2",children:[Te.jsx(_,{size:18})," Nova Empresa"]})]}),Te.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[Te.jsx(mr,{icon:u,label:"Empresas Ativas",value:t.length,color:"primary"}),Te.jsx("div",{className:"hidden md:block"}),Te.jsx("div",{className:"hidden md:block"})]}),Te.jsxs("div",{className:"card overflow-hidden border border-slate-200 shadow-sm",children:[Te.jsxs("div",{className:"px-6 py-4 border-b border-slate-100 flex justify-between items-center bg-slate-50/50",children:[Te.jsx("h3",{className:"font-semibold text-slate-800",children:"Lista de Empresas"}),Te.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-500",children:[Te.jsx("span",{children:"Densidade:"}),Te.jsx("button",{type:"button",onClick:()=>l(e=>"comfortable"===e?"compact":"comfortable"),className:"px-3 py-1 rounded-full text-xs font-semibold transition-colors "+("comfortable"===n?"bg-white shadow-sm text-primary-700 ring-1 ring-slate-200":"bg-slate-100 text-slate-600 hover:bg-slate-200"),children:"comfortable"===n?"Confortável":"Compacta"})]})]}),r?Te.jsx("div",{className:"flex justify-center py-8",children:Te.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})}):t.length>0?Te.jsxs(Te.Fragment,{children:[Te.jsx("div",{className:"md:hidden p-4 sm:p-6 space-y-3",children:t.map(e=>Te.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white shadow-sm "+("compact"===n?"p-3":"p-4"),children:[Te.jsxs("div",{className:"flex items-start justify-between gap-3",children:[Te.jsxs("div",{className:"min-w-0",children:[Te.jsx("p",{className:"font-semibold text-slate-900 truncate",children:e.nome}),Te.jsx("p",{className:"text-sm text-slate-600 truncate",children:e.email||"-"})]}),Te.jsx("span",{className:"px-2.5 py-1 text-xs rounded-full font-medium border shrink-0 "+("ativo"===e.status?"bg-emerald-50 text-emerald-700 border-emerald-100":"bg-red-50 text-red-700 border-red-100"),children:"ativo"===e.status?"Ativo":"Inativo"})]}),Te.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[Te.jsx("span",{className:"px-2.5 py-1 text-xs rounded-full font-semibold bg-primary-50 text-primary-700 border border-primary-100 uppercase",children:e.plano}),Te.jsxs("span",{className:"text-xs text-slate-600",children:["CNPJ: ",e.cnpj||"-"]})]}),Te.jsx("div",{className:"mt-4 flex items-center justify-end",children:Te.jsx("button",{type:"button",onClick:()=>x(e.id),className:"px-3 py-2 text-red-600 hover:text-red-700 hover:bg-red-50 rounded-lg transition-colors text-sm font-semibold",children:"Excluir"})})]},e.id))}),Te.jsx("div",{className:"hidden md:block overflow-x-auto",children:Te.jsxs("table",{className:"w-full",children:[Te.jsx("thead",{className:"bg-slate-50",children:Te.jsxs("tr",{children:[Te.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wide",children:"Nome"}),Te.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wide",children:"CNPJ"}),Te.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wide",children:"Email"}),Te.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wide",children:"Plano"}),Te.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wide",children:"Status"}),Te.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wide",children:"Ações"})]})}),Te.jsx("tbody",{className:"divide-y divide-gray-100",children:t.map(e=>Te.jsxs("tr",{className:"hover:bg-slate-50",children:[Te.jsx("td",{className:`px-6 ${"compact"===n?"py-3 text-sm":"py-4"} whitespace-nowrap`,children:Te.jsx("div",{className:"font-medium text-slate-900",children:e.nome})}),Te.jsx("td",{className:`px-6 ${"compact"===n?"py-3 text-sm":"py-4"} whitespace-nowrap text-slate-600`,children:e.cnpj||"-"}),Te.jsx("td",{className:`px-6 ${"compact"===n?"py-3 text-sm":"py-4"} whitespace-nowrap text-slate-600`,children:e.email}),Te.jsx("td",{className:`px-6 ${"compact"===n?"py-3 text-sm":"py-4"} whitespace-nowrap`,children:Te.jsx("span",{className:"px-2.5 py-1 text-xs rounded-full font-semibold bg-primary-50 text-primary-700 border border-primary-100 uppercase",children:e.plano})}),Te.jsx("td",{className:`px-6 ${"compact"===n?"py-3 text-sm":"py-4"} whitespace-nowrap`,children:Te.jsx("span",{className:"px-2.5 py-1 text-xs rounded-full font-medium border "+("ativo"===e.status?"bg-emerald-50 text-emerald-700 border-emerald-100":"bg-red-50 text-red-700 border-red-100"),children:"ativo"===e.status?"Ativo":"Inativo"})}),Te.jsx("td",{className:`px-6 ${"compact"===n?"py-3 text-sm":"py-4"} whitespace-nowrap`,children:Te.jsx("div",{className:"flex gap-2",children:Te.jsx("button",{onClick:()=>x(e.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-xl",title:"Excluir Empresa",children:Te.jsx($,{size:18})})})})]},e.id))})]})})]}):Te.jsx(kr,{icon:u,title:"Nenhuma empresa encontrada",description:"Comece cadastrando uma nova empresa.",actionLabel:"Nova Empresa",onAction:()=>c(!0)})]}),o&&Te.jsx(Wr,{onClose:()=>c(!1),onSave:m})]}):Te.jsx(Ir,{message:"Apenas Super Administradores podem acessar esta página.",messageClassName:"text-gray-600"})}function Yr(){var s,t;const{user:a}=Ga(),[r,i]=e.useState("perfil"),[n,l]=e.useState(null),[o,c]=e.useState(!0),[d,m]=e.useState(!1),[x,u]=e.useState(!1),[p,f]=e.useState(!1),[g,j]=e.useState({nome:(null==a?void 0:a.nome)||"",email:(null==a?void 0:a.email)||"",telefone:(null==a?void 0:a.telefone)||"",especialidade:(null==a?void 0:a.especialidade)||"",crm:(null==a?void 0:a.crm)||"",crmUf:(null==a?void 0:a.crmUf)||""}),[v,y]=e.useState({nome:"",cnpj:"",endereco:"",telefone:""}),[N,w]=e.useState("admin"===(null==a?void 0:a.role));e.useEffect(()=>{j({nome:(null==a?void 0:a.nome)||"",email:(null==a?void 0:a.email)||"",telefone:(null==a?void 0:a.telefone)||"",especialidade:(null==a?void 0:a.especialidade)||"",crm:(null==a?void 0:a.crm)||"",crmUf:(null==a?void 0:a.crmUf)||""})},[a]);const C=e.useCallback(async()=>{c(!0);try{const e=await Ur();l(e)}catch(e){b.error("Não foi possível carregar o resumo do perfil")}finally{c(!1)}},[]),S=e.useCallback(async()=>{if("admin"===(null==a?void 0:a.role)){w(!0);try{const e=await Gr();y({nome:(null==e?void 0:e.nome)||"",cnpj:(null==e?void 0:e.cnpj)||"",endereco:(null==e?void 0:e.endereco)||"",telefone:(null==e?void 0:e.telefone)||""})}catch(e){b.error("Não foi possível carregar os dados da empresa")}finally{w(!1)}}},[null==a?void 0:a.role]);e.useEffect(()=>{C()},[C]),e.useEffect(()=>{"admin"===(null==a?void 0:a.role)&&S()},[null==a?void 0:a.role,S]);const k=e.useCallback(e=>{Ga.setState(s=>{const t={...s.user||{},...e};return localStorage.setItem("user",JSON.stringify(t)),{user:t}})},[]),E=[{id:"perfil",nome:"Perfil",icon:K},{id:"empresa",nome:"Empresa",icon:Y},{id:"seguranca",nome:"Segurança",icon:h},{id:"notificacoes",nome:"Notificações",icon:Q}],A=(null==n?void 0:n.lastUpdate)?new Date(n.lastUpdate).toLocaleDateString("pt-BR"):"Hoje",P=(null==n?void 0:n.securityScore)?Math.round(100*n.securityScore):0;return Te.jsxs("div",{className:"space-y-8",children:[Te.jsx(dr,{label:"Central",title:"Configurações",subtitle:"Personalize o perfil, mantenha os dados da empresa atualizados e revise as preferências de segurança e comunicação em um só lugar."}),Te.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[Te.jsxs("div",{className:"card bg-gradient-to-br from-primary-50 to-white",children:[Te.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-primary-600",children:"Perfil"}),Te.jsx("p",{className:"text-3xl font-semibold text-slate-900 mt-2",children:(null==a?void 0:a.nome)||"Usuário"}),Te.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Última atualização: ",A]})]}),Te.jsxs("div",{className:"card",children:[Te.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Segurança"}),Te.jsx("p",{className:"text-3xl font-semibold text-slate-900 mt-2",children:o?"---":`${P}%`}),Te.jsx("p",{className:"text-xs text-slate-500 mt-1",children:o?"Carregando resumo de segurança...":(null==(s=null==n?void 0:n.pendingSecurityTasks)?void 0:s.length)?"Complete as ações recomendadas para atingir 100%.":"Nenhuma pendência crítica identificada."}),(null==(t=null==n?void 0:n.pendingSecurityTasks)?void 0:t.length)>0&&Te.jsx("ul",{className:"text-xs text-slate-500 mt-3 space-y-1 list-disc list-inside",children:n.pendingSecurityTasks.slice(0,2).map(e=>Te.jsx("li",{children:e},e))})]}),Te.jsxs("div",{className:"card",children:[Te.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400",children:"Plano"}),Te.jsx("p",{className:"text-xl font-semibold text-slate-900 mt-2",children:(null==n?void 0:n.planLabel)||"Profissional"}),Te.jsx("p",{className:"text-xs text-slate-500 mt-1",children:(null==n?void 0:n.planDescription)||"Suporte prioritário e integrações liberadas."})]})]}),Te.jsx("div",{className:"flex flex-wrap gap-2 bg-white/70 border border-slate-100 rounded-2xl p-2",children:E.map(e=>{const s=e.icon;return Te.jsxs("button",{onClick:()=>i(e.id),className:"flex items-center gap-2 px-4 py-2 rounded-xl text-sm transition-all "+(r===e.id?"bg-gradient-to-r from-primary-50 to-primary-100 text-primary-700 shadow-inner":"text-slate-500 hover:text-slate-900"),children:[Te.jsx(s,{size:18}),Te.jsx("span",{className:"hidden sm:inline",children:e.nome})]},e.id)})}),"perfil"===r&&Te.jsxs("div",{className:"card",children:[Te.jsxs("div",{className:"border-b border-slate-100 pb-4 mb-6",children:[Te.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400 mb-1",children:"Perfil"}),Te.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:"Dados Pessoais"})]}),Te.jsxs("form",{onSubmit:async e=>{var s,t;e.preventDefault(),m(!0);const a={nome:g.nome,email:g.email,telefone:g.telefone,especialidade:g.especialidade,crm:g.crm};try{const e=await Mr(a),s=(null==e?void 0:e.usuario)||a;k(s),b.success(Xa("update","Perfil",{suffix:"!"})),C()}catch(r){const e=(null==(t=null==(s=null==r?void 0:r.response)?void 0:s.data)?void 0:t.error)||"Erro ao atualizar perfil";b.error(e)}finally{m(!1)}},className:"space-y-4",children:[Te.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-2",children:"Nome Completo"}),Te.jsx("input",{type:"text",className:"input",value:g.nome,onChange:e=>j({...g,nome:e.target.value}),required:!0})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-2",children:"E-mail"}),Te.jsx("input",{type:"email",className:"input",value:g.email,onChange:e=>j({...g,email:e.target.value}),required:!0})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-2",children:"Telefone"}),Te.jsx("input",{type:"tel",className:"input",value:g.telefone,onChange:e=>j({...g,telefone:e.target.value})})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-2",children:"Especialidade"}),Te.jsx("input",{type:"text",className:"input",value:g.especialidade,onChange:e=>j({...g,especialidade:e.target.value})})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-2",children:"CRM"}),Te.jsx("input",{type:"text",className:"input",value:g.crm,onChange:e=>j({...g,crm:e.target.value})})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-2",children:"UF do CRM"}),Te.jsx("input",{type:"text",className:"input",maxLength:"2",value:g.crmUf,onChange:e=>j({...g,crmUf:e.target.value.toUpperCase()})})]})]}),Te.jsxs("button",{type:"submit",className:"btn btn-primary flex items-center gap-2 disabled:opacity-60",disabled:d,children:[Te.jsx(X,{size:18}),d?"Salvando...":"Salvar Alterações"]})]})]}),"empresa"===r&&"admin"===(null==a?void 0:a.role)&&Te.jsxs("div",{className:"card",children:[Te.jsxs("div",{className:"border-b border-slate-100 pb-4 mb-6",children:[Te.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400 mb-1",children:"Organização"}),Te.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:"Dados da Empresa"})]}),N&&Te.jsx("p",{className:"text-sm text-slate-400 mb-4",children:"Carregando dados cadastrados..."}),Te.jsxs("form",{onSubmit:async e=>{var s,t;if(e.preventDefault(),"admin"===(null==a?void 0:a.role)){u(!0);try{await Jr(v),b.success("Dados da empresa atualizados!"),S()}catch(r){const e=(null==(t=null==(s=null==r?void 0:r.response)?void 0:s.data)?void 0:t.error)||"Erro ao atualizar empresa";b.error(e)}finally{u(!1)}}},className:"space-y-4",children:[Te.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-2",children:"Nome da Empresa"}),Te.jsx("input",{type:"text",className:"input",value:v.nome,onChange:e=>y({...v,nome:e.target.value}),disabled:N,required:!0})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-2",children:"CNPJ"}),Te.jsx("input",{type:"text",className:"input",value:v.cnpj,onChange:e=>y({...v,cnpj:e.target.value}),disabled:N,required:!0})]}),Te.jsxs("div",{className:"md:col-span-2",children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-2",children:"Endereço"}),Te.jsx("input",{type:"text",className:"input",value:v.endereco,onChange:e=>y({...v,endereco:e.target.value}),disabled:N})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-2",children:"Telefone"}),Te.jsx("input",{type:"tel",className:"input",value:v.telefone,onChange:e=>y({...v,telefone:e.target.value}),disabled:N})]})]}),Te.jsxs("button",{type:"submit",className:"btn btn-primary flex items-center gap-2 disabled:opacity-60",disabled:x||N,children:[Te.jsx(X,{size:18}),x?"Salvando...":"Salvar Alterações"]})]})]}),"seguranca"===r&&Te.jsxs("div",{className:"card",children:[Te.jsxs("div",{className:"border-b border-slate-100 pb-4 mb-6",children:[Te.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400 mb-1",children:"Segurança"}),Te.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:"Alterar Senha"})]}),Te.jsxs("form",{onSubmit:async e=>{var s,t;if(e.preventDefault(),!(null==a?void 0:a.id))return void b.error("Usuário não identificado");const r=e.currentTarget,i=r.senhaAtual.value,n=r.novaSenha.value;if(n===r.confirmaSenha.value)try{f(!0),await Lr(a.id,i,n),b.success("Senha alterada com sucesso!"),r.reset()}catch(l){const e=(null==(t=null==(s=null==l?void 0:l.response)?void 0:s.data)?void 0:t.error)||"Erro ao alterar senha";b.error(e)}finally{f(!1)}else b.error(er("passwordMismatch"))},className:"space-y-4 max-w-md",children:[Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-2",children:"Senha Atual"}),Te.jsx("input",{type:"password",name:"senhaAtual",required:!0,className:"input"})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-2",children:"Nova Senha"}),Te.jsx("input",{type:"password",name:"novaSenha",required:!0,minLength:"6",className:"input"})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-2",children:"Confirmar Nova Senha"}),Te.jsx("input",{type:"password",name:"confirmaSenha",required:!0,minLength:"6",className:"input"})]}),Te.jsxs("button",{type:"submit",className:"btn btn-primary flex items-center gap-2 disabled:opacity-60",disabled:p,children:[Te.jsx(h,{size:18}),p?"Atualizando...":"Alterar Senha"]})]})]}),"notificacoes"===r&&Te.jsxs("div",{className:"card",children:[Te.jsxs("div",{className:"border-b border-slate-100 pb-4 mb-6",children:[Te.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-slate-400 mb-1",children:"Alertas"}),Te.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:"Preferências de Notificações"})]}),Te.jsxs("div",{className:"space-y-4",children:[Te.jsxs("label",{className:"flex items-center gap-3 p-3 hover:bg-gray-50 rounded-lg cursor-pointer",children:[Te.jsx("input",{type:"checkbox",defaultChecked:!0,className:"rounded text-primary-600"}),Te.jsx("span",{className:"text-gray-700",children:"Receber e-mails sobre novas prescrições"})]}),Te.jsxs("label",{className:"flex items-center gap-3 p-3 hover:bg-gray-50 rounded-lg cursor-pointer",children:[Te.jsx("input",{type:"checkbox",defaultChecked:!0,className:"rounded text-primary-600"}),Te.jsx("span",{className:"text-gray-700",children:"Notificar sobre novos pacientes"})]}),Te.jsxs("label",{className:"flex items-center gap-3 p-3 hover:bg-gray-50 rounded-lg cursor-pointer",children:[Te.jsx("input",{type:"checkbox",className:"rounded text-primary-600"}),Te.jsx("span",{className:"text-gray-700",children:"Lembretes de consultas"})]}),Te.jsxs("label",{className:"flex items-center gap-3 p-3 hover:bg-gray-50 rounded-lg cursor-pointer",children:[Te.jsx("input",{type:"checkbox",className:"rounded text-primary-600"}),Te.jsx("span",{className:"text-gray-700",children:"Atualizações do sistema"})]}),Te.jsxs("button",{className:"btn btn-primary flex items-center gap-2 mt-6",children:[Te.jsx(X,{size:18}),"Salvar Preferências"]})]})]})]})}const Qr=async e=>Fa("/agendamentos",{params:e}),Xr=async e=>Ua("/agendamentos",e),Zr=async(e,s)=>Ma(`/agendamentos/${e}`,s),ei=async e=>_a(`/agendamentos/${e}`);function si(){const[s,t]=e.useState([]),[a,r]=e.useState(!0),[i,n]=e.useState(!1),[l,o]=e.useState(null),[c,d]=e.useState("");wr(i);const[m,x]=e.useState({tipo:"Compromisso",titulo:"",data:"",horario:"",participante:"",local:"",descricao:""});e.useEffect(()=>{u()},[]),e.useEffect(()=>{if(!i)return;const e=e=>{"Escape"===e.key&&n(!1)};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[i]);const u=async()=>{try{r(!0);const e=new Date,s=new Date;s.setMonth(e.getMonth()+3);const a=await Qr({dataInicio:e.toISOString(),dataFim:s.toISOString()});t(a)}catch(e){b.error(Za("load","agenda"))}finally{r(!1)}},p=()=>{x({tipo:"Compromisso",titulo:"",data:"",horario:"",participante:"",local:"",descricao:""}),o(null)},h=(e="Compromisso")=>{p(),x(s=>({...s,tipo:e})),n(!0)},f=e=>{switch(e){case"Consulta":return Te.jsx(se,{size:18});case"Reunião":return Te.jsx(C,{size:18});case"Exame":return Te.jsx(S,{size:18});default:return Te.jsx(R,{size:18})}},g=s.filter(e=>{var s;return e.titulo.toLowerCase().includes(c.toLowerCase())||(null==(s=e.participante)?void 0:s.toLowerCase().includes(c.toLowerCase()))}),j={total:s.length,confirmados:s.filter(e=>"confirmado"===e.status).length,pendentes:s.filter(e=>"agendado"===e.status).length,hoje:s.filter(e=>{const s=new Date(e.dataHoraInicio),t=new Date;return s.getDate()===t.getDate()&&s.getMonth()===t.getMonth()&&s.getFullYear()===t.getFullYear()}).length};return Te.jsxs("div",{className:"space-y-8",children:[Te.jsx(dr,{label:"Institucional",title:"Agenda",subtitle:"Gerencie consultas, reuniões e compromissos da instituição de forma centralizada.",children:Te.jsxs("div",{className:"flex flex-col sm:flex-row w-full lg:w-auto gap-3",children:[Te.jsxs("button",{onClick:()=>h("Reunião"),className:"btn btn-secondary flex items-center justify-center gap-2",children:[Te.jsx(C,{size:18})," Nova Reunião"]}),Te.jsxs("button",{onClick:()=>h("Compromisso"),className:"btn btn-primary flex items-center justify-center gap-2 shadow-lg shadow-primary-600/20",children:[Te.jsx(_,{size:18})," Novo Compromisso"]})]})}),Te.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[Te.jsx(mr,{icon:R,label:"Total",value:j.total,description:"Agendamentos futuros",color:"primary"}),Te.jsx(mr,{icon:I,label:"Confirmados",value:j.confirmados,description:"Confirmados",color:"emerald"}),Te.jsx(mr,{icon:G,label:"Pendentes",value:j.pendentes,description:"Aguardando confirmação",color:"orange"}),Te.jsx(mr,{icon:z,label:"Hoje",value:j.hoje,description:"Eventos para hoje",color:"purple"})]}),Te.jsx(Sr,{searchTerm:c,onSearchChange:d,placeholder:"Buscar por título ou participante..."}),Te.jsx("div",{className:"card overflow-hidden",children:Te.jsx("div",{className:"overflow-x-auto",children:Te.jsxs("table",{className:"w-full text-left",children:[Te.jsx("thead",{className:"bg-slate-50 border-b border-slate-100",children:Te.jsxs("tr",{children:[Te.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Tipo"}),Te.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Título"}),Te.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Data/Hora"}),Te.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Participante"}),Te.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Local"}),Te.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Status"}),Te.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider text-right",children:"Ações"})]})}),Te.jsx("tbody",{className:"divide-y divide-slate-100",children:a?Te.jsx("tr",{children:Te.jsxs("td",{colSpan:"7",className:"px-6 py-12 text-center text-slate-400",children:[Te.jsx("div",{className:"flex justify-center mb-2",children:Te.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary-600"})}),"Carregando agenda..."]})}):0===g.length?Te.jsx("tr",{children:Te.jsx("td",{colSpan:"7",className:"px-6 py-12 text-center text-slate-400",children:Te.jsx(kr,{icon:R,title:"Nenhum agendamento encontrado",description:"Nenhum agendamento encontrado."})})}):g.map(e=>Te.jsxs("tr",{className:"hover:bg-slate-50/50 transition-colors group",children:[Te.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Te.jsxs("div",{className:"flex items-center gap-2 text-slate-700 font-medium",children:[Te.jsx("div",{className:"p-2 rounded-lg "+("Consulta"===e.tipo?"bg-blue-50 text-blue-600":"Reunião"===e.tipo?"bg-purple-50 text-purple-600":"Exame"===e.tipo?"bg-amber-50 text-amber-600":"bg-primary-50 text-primary-600"),children:f(e.tipo)}),Te.jsx("span",{className:"text-sm",children:e.tipo})]})}),Te.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Te.jsx("span",{className:"font-semibold text-slate-900",children:e.titulo})}),Te.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Te.jsxs("div",{className:"flex flex-col",children:[Te.jsx("span",{className:"text-sm font-medium text-slate-700",children:new Date(e.dataHoraInicio).toLocaleDateString("pt-BR")}),Te.jsx("span",{className:"text-xs text-slate-500",children:new Date(e.dataHoraInicio).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})})]})}),Te.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Te.jsx("div",{className:"flex items-center gap-2",children:e.participante?Te.jsxs(Te.Fragment,{children:[Te.jsx("div",{className:"w-6 h-6 rounded-full bg-slate-100 flex items-center justify-center text-slate-500 text-xs font-bold",children:e.participante.charAt(0)}),Te.jsx("span",{className:"text-sm text-slate-600",children:e.participante})]}):Te.jsx("span",{className:"text-slate-400 text-sm",children:"-"})})}),Te.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Te.jsx("div",{className:"flex items-center gap-2 text-slate-600",children:e.local?Te.jsxs(Te.Fragment,{children:[Te.jsx(Z,{size:14,className:"text-slate-400"}),Te.jsx("span",{className:"text-sm",children:e.local})]}):Te.jsx("span",{className:"text-slate-400 text-sm",children:"-"})})}),Te.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Te.jsxs("select",{value:e.status,onChange:s=>(async(e,s)=>{try{await Zr(e,{status:s}),b.success("Status atualizado"),u()}catch(t){b.error(Za("update","status"))}})(e.id||e._id,s.target.value),className:`\n                          text-xs font-bold px-3 py-1 rounded-full border-none focus:ring-2 focus:ring-primary-500 cursor-pointer appearance-none\n                          ${"agendado"===e.status?"bg-primary-50 text-primary-700 ring-1 ring-primary-100":"confirmado"===e.status?"bg-emerald-50 text-emerald-700 ring-1 ring-emerald-100":"cancelado"===e.status?"bg-red-50 text-red-700 ring-1 ring-red-100":"bg-slate-100 text-slate-700 ring-1 ring-slate-200"}\n                        `,children:[Te.jsx("option",{value:"agendado",children:"Agendado"}),Te.jsx("option",{value:"confirmado",children:"Confirmado"}),Te.jsx("option",{value:"cancelado",children:"Cancelado"}),Te.jsx("option",{value:"concluido",children:"Concluído"})]})}),Te.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:Te.jsxs("div",{className:"flex items-center justify-end gap-2",children:[Te.jsx("button",{onClick:()=>(e=>{const s=new Date(e.dataHoraInicio);x({tipo:e.tipo,titulo:e.titulo,data:s.toISOString().split("T")[0],horario:s.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}),participante:e.participante||"",local:e.local||"",descricao:e.observacoes||""}),o(e.id||e._id),n(!0)})(e),className:"p-2 text-slate-400 hover:text-primary-600 hover:bg-primary-50 rounded-lg transition-colors",title:"Editar",children:Te.jsx(ee,{size:16})}),Te.jsx("button",{onClick:()=>(async e=>{if(window.confirm("Tem certeza que deseja excluir este agendamento?"))try{await ei(e),b.success("Agendamento excluído"),u()}catch(s){b.error(Za("delete","agendamento"))}})(e.id||e._id),className:"p-2 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Excluir",children:Te.jsx($,{size:16})})]})})]},e.id||e._id))})]})})}),i&&Te.jsx("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",onMouseDown:e=>{e.target===e.currentTarget&&n(!1)},children:Te.jsxs("div",{role:"dialog","aria-modal":"true",className:"bg-white rounded-2xl shadow-2xl w-full max-w-lg max-h-[90vh] flex flex-col overflow-hidden animate-in fade-in zoom-in duration-200",onMouseDown:e=>e.stopPropagation(),children:[Te.jsxs("div",{className:"px-6 py-5 border-b border-slate-100 flex justify-between items-start bg-slate-50/50 shrink-0",children:[Te.jsxs("div",{children:[Te.jsx("h3",{className:"font-bold text-xl text-slate-800",children:l?"Editar Agendamento":"Novo Agendamento"}),Te.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Preencha os dados do compromisso."})]}),Te.jsx("button",{onClick:()=>n(!1),className:"text-slate-400 hover:text-slate-600 p-1 hover:bg-slate-100 rounded-lg transition",type:"button","aria-label":"Fechar modal",children:Te.jsx(U,{size:24})})]}),Te.jsx("div",{className:"overflow-y-auto p-6 custom-scrollbar",children:Te.jsxs("form",{onSubmit:async e=>{e.preventDefault();try{const e=new Date(`${m.data}T${m.horario}:00`),s=new Date(e.getTime()+36e5),t={titulo:m.titulo,tipo:m.tipo,participante:m.participante,local:m.local,observacoes:m.descricao,dataHoraInicio:e.toISOString(),dataHoraFim:s.toISOString()};l?(await Zr(l,t),b.success(Xa("update","Agendamento"))):(await Xr(t),b.success(Xa("create","Agendamento"))),n(!1),p(),u()}catch(s){b.error(sr(s,Za("save","agendamento")))}},className:"space-y-5",children:[Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Tipo"}),Te.jsxs("select",{className:"input w-full",value:m.tipo,onChange:e=>x({...m,tipo:e.target.value}),children:[Te.jsx("option",{value:"Compromisso",children:"Compromisso"}),Te.jsx("option",{value:"Reunião",children:"Reunião"}),Te.jsx("option",{value:"Consulta",children:"Consulta"}),Te.jsx("option",{value:"Exame",children:"Exame"}),Te.jsx("option",{value:"Outro",children:"Outro"})]})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Título *"}),Te.jsx("input",{type:"text",required:!0,className:"input w-full",placeholder:"Ex: Reunião de Equipe",value:m.titulo,onChange:e=>x({...m,titulo:e.target.value})})]}),Te.jsxs("div",{className:"grid grid-cols-2 gap-5",children:[Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Data *"}),Te.jsx("input",{type:"date",required:!0,className:"input w-full",value:m.data,onChange:e=>x({...m,data:e.target.value})})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Horário *"}),Te.jsx("input",{type:"time",required:!0,className:"input w-full",value:m.horario,onChange:e=>x({...m,horario:e.target.value})})]})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Participante"}),Te.jsxs("div",{className:"relative",children:[Te.jsx(K,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18}),Te.jsx("input",{type:"text",className:"input w-full pl-10",placeholder:"Nome do participante",value:m.participante,onChange:e=>x({...m,participante:e.target.value})})]})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Local"}),Te.jsxs("div",{className:"relative",children:[Te.jsx(Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18}),Te.jsx("input",{type:"text",className:"input w-full pl-10",placeholder:"Local do evento",value:m.local,onChange:e=>x({...m,local:e.target.value})})]})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-1.5",children:"Descrição"}),Te.jsx("textarea",{className:"input w-full min-h-[100px] py-3",placeholder:"Detalhes adicionais...",value:m.descricao,onChange:e=>x({...m,descricao:e.target.value})})]}),Te.jsxs("div",{className:"pt-4 flex gap-3 border-t border-slate-100 mt-2",children:[Te.jsx("button",{type:"button",onClick:()=>n(!1),className:"btn btn-secondary flex-1 py-2.5",children:"Cancelar"}),Te.jsx("button",{type:"submit",className:"btn btn-primary flex-1 py-2.5 shadow-lg shadow-primary-500/20",children:l?"Salvar Alterações":"Agendar"})]})]})})]})})]})}function ti(){const[s,t]=e.useState("todos"),[a,r]=e.useState(""),[i,n]=e.useState([]),[l,o]=e.useState(!0),[c,d]=e.useState(!1);e.useEffect(()=>{m()},[]);const m=async()=>{try{o(!0);const e=new Date,s=new Date;s.setDate(e.getDate()+30);const[t,a]=await Promise.all([Qr({dataInicio:e.toISOString(),dataFim:s.toISOString()}),Ar({status:"ativa"})]),r=(Array.isArray(t)?t:[]).map(e=>({id:e.id||e._id,type:"Consulta"===e.tipo?"consultas":"Exame"===e.tipo?"exames":"outros",originalType:e.tipo,title:e.titulo,subtitle:e.participante||"Sem participante",date:new Date(e.dataHoraInicio),status:e.status,details:e.local,source:"agendamento"})),i=a||{},l=(Array.isArray(i)?i:Array.isArray(i.prescricoes)?i.prescricoes:[]).map(e=>{var s,t,a,r;return{id:e.id||e._id,type:"medicacoes",originalType:"Medicação",title:`Prescrição: ${(null==(t=null==(s=e.medicamentos)?void 0:s[0])?void 0:t.nome)||"Medicamentos diversos"}`,subtitle:(null==(a=e.pacienteId)?void 0:a.nome)||"Paciente não identificado",date:new Date(e.dataEmissao||e.createdAt),status:e.status,details:`${(null==(r=e.medicamentos)?void 0:r.length)||0} medicamentos`,source:"prescricao"}}),c=[...r,...l].sort((e,s)=>e.date-s.date);n(c)}catch(e){b.error(Za("load","cronograma"))}finally{o(!1)}},x=i.filter(e=>{const t="todos"===s||e.type===s||"consultas"===s&&"outros"===e.type,r=e.title.toLowerCase().includes(a.toLowerCase())||e.subtitle.toLowerCase().includes(a.toLowerCase());return t&&r}),u=[{id:"todos",label:"Todos",icon:R},{id:"medicacoes",label:"Medicações",icon:J},{id:"consultas",label:"Consultas",icon:se},{id:"exames",label:"Exames",icon:S}],p={total:i.length,consultas:i.filter(e=>"consultas"===e.type).length,exames:i.filter(e=>"exames"===e.type).length,medicacoes:i.filter(e=>"medicacoes"===e.type).length};return Te.jsxs("div",{className:"space-y-8",children:[Te.jsx(dr,{label:"Rotina",title:"Cronograma",subtitle:"Acompanhe a linha do tempo de medicações, consultas e exames dos residentes.",children:Te.jsxs("button",{onClick:()=>d(!c),className:"btn btn-secondary flex items-center justify-center gap-2 "+(c?"bg-slate-100":""),children:[Te.jsx(te,{size:18}),Te.jsx("span",{className:"hidden sm:inline",children:"Legendas"})]})}),Te.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[Te.jsx(mr,{icon:R,label:"Total",value:p.total,description:"Eventos agendados",color:"primary"}),Te.jsx(mr,{icon:se,label:"Consultas",value:p.consultas,description:"Consultas médicas",color:"blue"}),Te.jsx(mr,{icon:J,label:"Medicações",value:p.medicacoes,description:"Prescrições ativas",color:"purple"}),Te.jsx(mr,{icon:S,label:"Exames",value:p.exames,description:"Exames marcados",color:"orange"})]}),Te.jsxs("div",{className:"card p-4 flex flex-col md:flex-row gap-4 items-center justify-between",children:[Te.jsx("div",{className:"flex p-1 bg-slate-100 rounded-xl w-full md:w-auto overflow-x-auto",children:u.map(e=>{const a=e.icon,r=s===e.id;return Te.jsxs("button",{onClick:()=>t(e.id),className:`\n                  flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-bold transition-all whitespace-nowrap\n                  ${r?"bg-white text-primary-600 shadow-sm":"text-slate-500 hover:text-slate-700 hover:bg-slate-200/50"}\n                `,children:[Te.jsx(a,{size:16}),e.label]},e.id)})}),Te.jsxs("div",{className:"relative w-full md:w-96",children:[Te.jsx(M,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:20}),Te.jsx("input",{type:"text",placeholder:"Buscar por título ou participante...",className:"w-full pl-10 pr-4 py-2 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 transition",value:a,onChange:e=>r(e.target.value)})]})]}),c&&Te.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3 p-4 bg-slate-50 rounded-2xl border border-slate-100 animate-in slide-in-from-top-2",children:[Te.jsxs("div",{className:"flex items-center gap-2",children:[Te.jsx("div",{className:"w-2 h-2 bg-slate-400 rounded-full"}),Te.jsx("span",{className:"text-xs text-slate-600",children:"Agendado"})]}),Te.jsxs("div",{className:"flex items-center gap-2",children:[Te.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),Te.jsx("span",{className:"text-xs text-slate-600",children:"Próximo (3 dias)"})]}),Te.jsxs("div",{className:"flex items-center gap-2",children:[Te.jsx("div",{className:"w-2 h-2 bg-amber-500 rounded-full"}),Te.jsx("span",{className:"text-xs text-slate-600",children:"Amanhã"})]}),Te.jsxs("div",{className:"flex items-center gap-2",children:[Te.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"}),Te.jsx("span",{className:"text-xs text-slate-600",children:"Hoje/Atrasado"})]}),Te.jsxs("div",{className:"flex items-center gap-2",children:[Te.jsx("div",{className:"w-2 h-2 bg-emerald-500 rounded-full"}),Te.jsx("span",{className:"text-xs text-slate-600",children:"Realizado"})]})]}),Te.jsx("div",{className:"space-y-4",children:l?Te.jsx("div",{className:"flex justify-center py-12",children:Te.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})}):0===x.length?Te.jsxs("div",{className:"card text-center py-16",children:[Te.jsx("div",{className:"w-16 h-16 bg-slate-50 rounded-full flex items-center justify-center mx-auto mb-4",children:Te.jsx(R,{size:32,className:"text-slate-300"})}),Te.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Nenhum item encontrado"}),Te.jsx("p",{className:"text-slate-500 max-w-xs mx-auto mt-1",children:"Não há agendamentos ou prescrições para os filtros selecionados."})]}):Te.jsx("div",{className:"grid gap-4",children:x.map(e=>{const s=((e,s,t)=>{if("concluido"===s||"realizado"===s)return{label:"Realizado",color:"bg-emerald-100 text-emerald-700 border-emerald-200",dot:"bg-emerald-500"};if("medicacoes"===t)return{label:"Em Uso",color:"bg-primary-100 text-primary-700 border-primary-200",dot:"bg-primary-500"};const a=new Date;a.setHours(0,0,0,0);const r=new Date(e);r.setHours(0,0,0,0);const i=r-a,n=Math.ceil(i/864e5);return n<0?{label:"Atrasado",color:"bg-red-100 text-red-700 border-red-200",dot:"bg-red-500"}:0===n?{label:"Hoje",color:"bg-red-100 text-red-700 border-red-200",dot:"bg-red-500"}:1===n?{label:"Amanhã",color:"bg-amber-100 text-amber-800 border-amber-200",dot:"bg-amber-500"}:n<=3?{label:"Próximo",color:"bg-blue-100 text-blue-700 border-blue-200",dot:"bg-blue-500"}:{label:"Agendado",color:"bg-slate-100 text-slate-700 border-slate-200",dot:"bg-slate-400"}})(e.date,e.status,e.type);return Te.jsxs("div",{className:"group bg-white p-5 rounded-2xl border border-slate-100 shadow-sm hover:shadow-md transition-all duration-200 flex flex-col md:flex-row gap-5",children:[Te.jsxs("div",{className:"flex md:flex-col items-center justify-center md:justify-start gap-2 md:gap-0 min-w-[80px] p-3 bg-slate-50 rounded-xl border border-slate-100",children:[Te.jsx("span",{className:"text-2xl font-bold text-slate-800 leading-none",children:e.date.getDate()}),Te.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider",children:e.date.toLocaleDateString("pt-BR",{month:"short"})})]}),Te.jsxs("div",{className:"flex-1 min-w-0",children:[Te.jsx("div",{className:"flex flex-wrap items-start justify-between gap-2",children:Te.jsxs("div",{children:[Te.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[Te.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded text-[10px] font-bold uppercase tracking-wider "+("medicacoes"===e.type?"bg-purple-50 text-purple-700":"consultas"===e.type?"bg-blue-50 text-blue-700":"bg-slate-100 text-slate-600"),children:["medicacoes"===e.type?Te.jsx(J,{size:10}):"consultas"===e.type?Te.jsx(se,{size:10}):Te.jsx(S,{size:10}),e.originalType]}),Te.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-[10px] font-bold border ${s.color}`,children:[Te.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${s.dot}`}),s.label]})]}),Te.jsx("h4",{className:"text-lg font-bold text-slate-900 truncate pr-4 group-hover:text-primary-700 transition-colors",children:e.title})]})}),Te.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-y-2 gap-x-4 mt-3",children:[Te.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[Te.jsx(K,{size:16,className:"text-slate-400"}),Te.jsx("span",{className:"truncate",children:e.subtitle})]}),Te.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[Te.jsx(z,{size:16,className:"text-slate-400"}),Te.jsx("span",{children:e.date.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})})]}),e.details&&Te.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600 sm:col-span-2",children:[Te.jsx(Z,{size:16,className:"text-slate-400"}),Te.jsx("span",{className:"truncate",children:e.details})]})]})]})]},`${e.source}-${e.id}`)})})})]})}const ai=async()=>Fa("/estoque/medicamentos"),ri=async e=>Ua("/estoque/medicamentos",e),ii=async e=>Ua("/estoque/medicamentos/movimentacao",e),ni=async()=>Fa("/estoque/alimentos"),li=async e=>Ua("/estoque/alimentos",e),oi=async e=>Ua("/estoque/alimentos/movimentacao",e),ci=async()=>Fa("/estoque/stats"),di=async(e="")=>Fa(e?`/estoque/movimentacoes?tipo=${e}`:"/estoque/movimentacoes");function mi(){const[s,t]=e.useState("medicamentos"),[a,r]=e.useState(null),[i,n]=e.useState([]),[l,o]=e.useState(null),[c,d]=e.useState([]),[m,x]=e.useState(!1),[u,p]=e.useState(!1),[h,f]=e.useState("");wr(Boolean(a||m));const[g,j]=e.useState({}),[v,y]=e.useState({quantidade:"",motivo:"",observacao:""});e.useEffect(()=>{N(),w()},[s]),e.useEffect(()=>{if(!a&&!m)return;const e=e=>{"Escape"===e.key&&(m?x(!1):k())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[a,m]);const N=async()=>{p(!0);try{const e="medicamentos"===s?await ai():await ni(),t=Array.isArray(e)?e:e.items||e.medicamentos||e.alimentos||[];n(t)}catch(e){b.error(Za("load","itens"))}finally{p(!1)}},w=async()=>{try{const e=await ci();o(e)}catch(e){}},C=async e=>{e.preventDefault();try{"medicamentos"===s?await ri(g):await li(g),b.success("Cadastrado com sucesso!"),k(),N()}catch(t){b.error(Za("create","item"))}},S=async e=>{e.preventDefault();try{const e={...v,tipo:a,["medicamentos"===s?"medicamentoId":"alimentoId"]:v.itemId};"medicamentos"===s?await ii(e):await oi(e),b.success("Movimentação registrada!"),k(),N()}catch(t){b.error(sr(t,Za("save","movimentação")))}},k=()=>{r(null),j({}),y({quantidade:"",motivo:"",observacao:""})},E=i.filter(e=>e.nome.toLowerCase().includes(h.toLowerCase())),A={total:i.length,baixoEstoque:i.filter(e=>e.quantidade<=(e.quantidadeMinima||0)).length,vencendo:i.filter(e=>{if(!e.validade)return!1;const s=new Date(e.validade)-new Date,t=Math.ceil(s/864e5);return t>0&&t<=30}).length,categorias:new Set(i.map(e=>e.categoria||"Geral")).size};return Te.jsxs("div",{className:"space-y-8",children:[Te.jsxs(dr,{label:"Logística",title:"Controle de Estoque",subtitle:"Gerencie o inventário de medicamentos e alimentos, registre entradas e saídas.",children:[Te.jsxs("button",{onClick:async()=>{try{const e=await di();d(e.movimentacoes||[]),x(!0)}catch(e){b.error(Za("load","histórico"))}},className:"btn bg-slate-50 text-slate-700 hover:bg-slate-100 border-slate-200 flex items-center gap-2 px-4 py-2.5 rounded-xl font-semibold transition-all",children:[Te.jsx(ae,{size:18})," Ver Histórico"]}),Te.jsxs("button",{onClick:()=>r("entrada"),className:"btn bg-emerald-50 text-emerald-700 hover:bg-emerald-100 border-emerald-200 flex items-center gap-2 px-4 py-2.5 rounded-xl font-semibold transition-all",children:[Te.jsx(re,{size:18})," Registrar Entrada"]}),Te.jsxs("button",{onClick:()=>r("saida"),className:"btn bg-red-50 text-red-700 hover:bg-red-100 border-red-200 flex items-center gap-2 px-4 py-2.5 rounded-xl font-semibold transition-all",children:[Te.jsx(ie,{size:18})," Registrar Saída"]}),Te.jsxs("button",{onClick:()=>r("cadastrar"),className:"btn bg-primary-600 text-white hover:bg-primary-700 shadow-lg shadow-primary-600/20 flex items-center gap-2 px-4 py-2.5 rounded-xl font-semibold transition-all",children:[Te.jsx(_,{size:18})," Novo Item"]})]}),l&&Te.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[Te.jsx(mr,{icon:T,label:"Total de Itens",value:l.totalItens||0,description:`${l.totalMedicamentos??0} med. + ${l.totalAlimentos??0} alim.`,color:"primary"}),Te.jsx(mr,{icon:F,label:"Baixo Estoque",value:l.baixoEstoque||0,description:"Itens precisando reposição",color:"red"}),Te.jsx(mr,{icon:R,label:"Vencendo",value:l.vencendo||0,description:"Nos próximos 30 dias",color:"amber"}),Te.jsx(mr,{icon:ae,label:"Movimentações",value:l.movimentacoesRecentes||0,description:"Últimos 30 dias",color:"emerald"})]}),Te.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[Te.jsx(mr,{icon:T,label:"Total",value:A.total,description:"Itens cadastrados",color:"primary"}),Te.jsx(mr,{icon:F,label:"Baixo Estoque",value:A.baixoEstoque,description:"Itens precisando reposição",color:"red"}),Te.jsx(mr,{icon:R,label:"Vencendo",value:A.vencendo,description:"Nos próximos 30 dias",color:"orange"}),Te.jsx(mr,{icon:ae,label:"Categorias",value:A.categorias,description:"Tipos de itens",color:"purple"})]}),Te.jsx(Sr,{searchTerm:h,onSearchChange:f,placeholder:`Buscar ${s}...`,children:Te.jsxs("div",{className:"flex bg-slate-100 p-1 rounded-xl w-full md:w-auto",children:[Te.jsxs("button",{onClick:()=>t("medicamentos"),className:"flex items-center gap-2 px-6 py-2.5 rounded-lg text-sm font-bold transition-all "+("medicamentos"===s?"bg-white text-primary-600 shadow-sm":"text-slate-500 hover:text-slate-700"),children:[Te.jsx(J,{size:16})," Medicamentos"]}),Te.jsxs("button",{onClick:()=>t("alimentos"),className:"flex items-center gap-2 px-6 py-2.5 rounded-lg text-sm font-bold transition-all "+("alimentos"===s?"bg-white text-green-600 shadow-sm":"text-slate-500 hover:text-slate-700"),children:[Te.jsx(ne,{size:16})," Alimentos"]})]})}),Te.jsx("div",{className:"card overflow-hidden",children:Te.jsx("div",{className:"overflow-x-auto",children:Te.jsxs("table",{className:"w-full text-left",children:[Te.jsx("thead",{className:"bg-slate-50 border-b border-slate-100",children:Te.jsxs("tr",{children:[Te.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Item"}),Te.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Quantidade"}),Te.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Unidade"}),Te.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Validade"}),Te.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Status"}),Te.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider text-right",children:"Ações"})]})}),Te.jsx("tbody",{className:"divide-y divide-slate-100",children:u?Te.jsx("tr",{children:Te.jsxs("td",{colSpan:"6",className:"px-6 py-12 text-center text-slate-400",children:[Te.jsx("div",{className:"flex justify-center mb-2",children:Te.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary-600"})}),"Carregando estoque..."]})}):0===E.length?Te.jsx("tr",{children:Te.jsx("td",{colSpan:"6",className:"px-6 py-12 text-center text-slate-400",children:Te.jsx(kr,{icon:T,title:"Nenhum item encontrado",description:"Nenhum item encontrado no estoque."})})}):E.map(e=>{const t=e.quantidade<=e.quantidadeMinima;return Te.jsxs("tr",{className:"hover:bg-slate-50/50 transition-colors group",children:[Te.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Te.jsxs("div",{className:"flex items-center gap-3",children:[Te.jsx("div",{className:"p-2 rounded-lg "+("medicamentos"===s?"bg-primary-50 text-primary-600":"bg-green-50 text-green-600"),children:"medicamentos"===s?Te.jsx(J,{size:18}):Te.jsx(ne,{size:18})}),Te.jsxs("div",{children:[Te.jsx("span",{className:"font-bold text-slate-800 block",children:e.nome}),e.lote&&Te.jsxs("span",{className:"text-xs text-slate-500",children:["Lote: ",e.lote]}),e.categoria&&Te.jsxs("span",{className:"text-xs text-slate-500",children:["Cat: ",e.categoria]})]})]})}),Te.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Te.jsx("span",{className:"font-bold text-lg "+(t?"text-red-600":"text-slate-700"),children:e.quantidade})}),Te.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Te.jsx("span",{className:"text-sm text-slate-500 bg-slate-100 px-2 py-1 rounded-md font-medium",children:e.unidade})}),Te.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Te.jsx("span",{className:"text-sm text-slate-600",children:e.validade?new Date(e.validade).toLocaleDateString("pt-BR"):"-"})}),Te.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t?Te.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 rounded-full bg-red-50 text-red-700 text-xs font-bold border border-red-100",children:[Te.jsx(F,{size:12})," Baixo Estoque"]}):Te.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 rounded-full bg-emerald-50 text-emerald-700 text-xs font-bold border border-emerald-100",children:[Te.jsx(I,{size:12})," Normal"]})}),Te.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:Te.jsx("button",{className:"text-slate-400 hover:text-primary-600 font-medium text-sm transition-colors",children:"Detalhes"})})]},e._id)})})]})})}),(()=>{if(!a)return null;const e="medicamentos"===s,t="entrada"===a||"saida"===a,r=t?"estoque-movimentacao-form":"estoque-cadastro-form";return Te.jsx("div",{className:"fixed inset-0 bg-slate-900/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",onMouseDown:e=>{e.target===e.currentTarget&&k()},children:Te.jsxs("div",{role:"dialog","aria-modal":"true",className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col",onMouseDown:e=>e.stopPropagation(),children:[Te.jsxs("div",{className:"p-6 border-b border-slate-100 flex justify-between items-center shrink-0 bg-white/80 backdrop-blur",children:[Te.jsxs("h3",{className:"text-xl font-bold text-slate-800 flex items-center gap-2",children:["cadastrar"===a&&Te.jsx(_,{className:"text-primary-600"}),"entrada"===a&&Te.jsx(re,{className:"text-emerald-600"}),"saida"===a&&Te.jsx(ie,{className:"text-red-600"}),"cadastrar"===a?"Novo "+(e?"Medicamento":"Alimento"):"entrada"===a?"Registrar Entrada":"Registrar Saída"]}),Te.jsx("button",{type:"button","aria-label":"Fechar modal",onClick:k,className:"p-2 hover:bg-slate-100 rounded-full transition-colors",children:Te.jsx(U,{size:20,className:"text-slate-400"})})]}),Te.jsx("div",{className:"p-6 overflow-y-auto flex-1 min-h-0 custom-scrollbar",children:t?Te.jsxs("form",{id:r,onSubmit:S,className:"space-y-4",children:[Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Selecione o Item"}),Te.jsxs("select",{required:!0,className:"w-full p-2.5 border border-slate-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent outline-none",onChange:e=>y({...v,itemId:e.target.value}),value:v.itemId||"",children:[Te.jsx("option",{value:"",children:"Selecione..."}),i.map(e=>Te.jsxs("option",{value:e._id,children:[e.nome," (Atual: ",e.quantidade," ",e.unidade,")"]},e._id))]})]}),Te.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Quantidade"}),Te.jsx("input",{required:!0,type:"number",min:"1",className:"w-full p-2.5 border border-slate-200 rounded-lg focus:ring-2 focus:ring-primary-500 outline-none",value:v.quantidade,onChange:e=>y({...v,quantidade:e.target.value})})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Motivo"}),Te.jsxs("select",{required:!0,className:"w-full p-2.5 border border-slate-200 rounded-lg focus:ring-2 focus:ring-primary-500 outline-none",onChange:e=>y({...v,motivo:e.target.value}),value:v.motivo||"",children:[Te.jsx("option",{value:"",children:"Selecione..."}),"entrada"===a?Te.jsxs(Te.Fragment,{children:[Te.jsx("option",{value:"Compra",children:"Compra"}),Te.jsx("option",{value:"Doação",children:"Doação"}),Te.jsx("option",{value:"Ajuste",children:"Ajuste de Estoque"})]}):Te.jsxs(Te.Fragment,{children:[Te.jsx("option",{value:"Uso",children:"Uso/Consumo"}),Te.jsx("option",{value:"Vencimento",children:"Vencimento/Descarte"}),Te.jsx("option",{value:"Ajuste",children:"Ajuste de Estoque"})]})]})]})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Observação (Opcional)"}),Te.jsx("textarea",{className:"w-full p-2.5 border border-slate-200 rounded-lg focus:ring-2 focus:ring-primary-500 outline-none",rows:"3",value:v.observacao,onChange:e=>y({...v,observacao:e.target.value})})]})]}):Te.jsxs("form",{id:r,onSubmit:C,className:"space-y-4",children:[Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Nome do Item"}),Te.jsx("input",{required:!0,type:"text",className:"w-full p-2.5 border border-slate-200 rounded-lg focus:ring-2 focus:ring-primary-500 outline-none",onChange:e=>j({...g,nome:e.target.value})})]}),Te.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Unidade"}),Te.jsxs("select",{required:!0,className:"w-full p-2.5 border border-slate-200 rounded-lg focus:ring-2 focus:ring-primary-500 outline-none",onChange:e=>j({...g,unidade:e.target.value}),defaultValue:"",children:[Te.jsx("option",{value:"",disabled:!0,children:"Selecione"}),e?Te.jsxs(Te.Fragment,{children:[Te.jsx("option",{value:"comprimido",children:"Comprimido"}),Te.jsx("option",{value:"caixa",children:"Caixa"}),Te.jsx("option",{value:"frasco",children:"Frasco"}),Te.jsx("option",{value:"ml",children:"ml"}),Te.jsx("option",{value:"ampola",children:"Ampola"})]}):Te.jsxs(Te.Fragment,{children:[Te.jsx("option",{value:"kg",children:"Kg"}),Te.jsx("option",{value:"litro",children:"Litro"}),Te.jsx("option",{value:"unidade",children:"Unidade"}),Te.jsx("option",{value:"pacote",children:"Pacote"}),Te.jsx("option",{value:"lata",children:"Lata"})]})]})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Qtd. Inicial"}),Te.jsx("input",{type:"number",className:"w-full p-2.5 border border-slate-200 rounded-lg focus:ring-2 focus:ring-primary-500 outline-none",onChange:e=>j({...g,quantidade:e.target.value})})]})]}),Te.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Qtd. Mínima (Alerta)"}),Te.jsx("input",{type:"number",className:"w-full p-2.5 border border-slate-200 rounded-lg focus:ring-2 focus:ring-primary-500 outline-none",onChange:e=>j({...g,quantidadeMinima:e.target.value})})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Validade"}),Te.jsx("input",{type:"date",className:"w-full p-2.5 border border-slate-200 rounded-lg focus:ring-2 focus:ring-primary-500 outline-none",onChange:e=>j({...g,validade:e.target.value})})]})]}),e?Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Lote"}),Te.jsx("input",{type:"text",className:"w-full p-2.5 border border-slate-200 rounded-lg focus:ring-2 focus:ring-primary-500 outline-none",onChange:e=>j({...g,lote:e.target.value})})]}):Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Categoria"}),Te.jsxs("select",{className:"w-full p-2.5 border border-slate-200 rounded-lg focus:ring-2 focus:ring-primary-500 outline-none",onChange:e=>j({...g,categoria:e.target.value}),children:[Te.jsx("option",{value:"Geral",children:"Geral"}),Te.jsx("option",{value:"Perecível",children:"Perecível"}),Te.jsx("option",{value:"Não Perecível",children:"Não Perecível"}),Te.jsx("option",{value:"Bebida",children:"Bebida"})]})]})]})}),Te.jsxs("div",{className:"p-6 border-t border-slate-100 flex justify-end gap-3 shrink-0 bg-white",children:[Te.jsx("button",{type:"button",onClick:k,className:"px-4 py-2 text-slate-600 hover:bg-slate-100 rounded-lg font-medium",children:"Cancelar"}),t?Te.jsxs("button",{type:"submit",form:r,className:"px-6 py-2 rounded-lg font-bold text-white shadow-lg transition-all transform hover:-translate-y-0.5 "+("entrada"===a?"bg-emerald-600 hover:bg-emerald-700 shadow-emerald-600/20":"bg-red-600 hover:bg-red-700 shadow-red-600/20"),children:["Confirmar ","entrada"===a?"Entrada":"Saída"]}):Te.jsx("button",{type:"submit",form:r,className:"px-6 py-2 bg-primary-600 text-white rounded-lg font-bold hover:bg-primary-700 shadow-lg shadow-primary-600/20 transition-all transform hover:-translate-y-0.5",children:"Salvar Cadastro"})]})]})})})(),m&&Te.jsx("div",{className:"fixed inset-0 bg-slate-900/50 backdrop-blur-sm flex items-center justify-center z-[60] p-4",onMouseDown:e=>{e.target===e.currentTarget&&x(!1)},children:Te.jsxs("div",{role:"dialog","aria-modal":"true",className:"bg-white rounded-2xl shadow-2xl w-full max-w-5xl max-h-[90vh] overflow-hidden flex flex-col",onMouseDown:e=>e.stopPropagation(),children:[Te.jsxs("div",{className:"p-6 border-b border-slate-100 flex justify-between items-center",children:[Te.jsxs("div",{children:[Te.jsxs("h3",{className:"text-xl font-bold text-slate-800 flex items-center gap-2",children:[Te.jsx(ae,{className:"text-primary-600"}),"Histórico de Movimentações"]}),Te.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Últimas 50 movimentações registradas"})]}),Te.jsx("button",{onClick:()=>x(!1),className:"p-2 hover:bg-slate-100 rounded-full transition-colors",type:"button","aria-label":"Fechar modal",children:Te.jsx(U,{size:20,className:"text-slate-400"})})]}),Te.jsx("div",{className:"p-6 overflow-y-auto flex-1",children:c.length>0?Te.jsx("div",{className:"overflow-x-auto",children:Te.jsxs("table",{className:"w-full",children:[Te.jsx("thead",{className:"bg-slate-50 border-b border-slate-100",children:Te.jsxs("tr",{children:[Te.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase",children:"Data"}),Te.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase",children:"Tipo"}),Te.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase",children:"Item"}),Te.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase",children:"Qtd"}),Te.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase",children:"Motivo"}),Te.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase",children:"Usuário"})]})}),Te.jsx("tbody",{className:"divide-y divide-slate-100",children:c.map(e=>Te.jsxs("tr",{className:"hover:bg-slate-50/50 transition",children:[Te.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 whitespace-nowrap",children:new Date(e.data).toLocaleString("pt-BR")}),Te.jsx("td",{className:"px-4 py-3",children:Te.jsx("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-bold "+("entrada"===e.tipo?"bg-emerald-50 text-emerald-700":"bg-red-50 text-red-700"),children:"entrada"===e.tipo?Te.jsxs(Te.Fragment,{children:[Te.jsx(re,{size:12})," Entrada"]}):Te.jsxs(Te.Fragment,{children:[Te.jsx(ie,{size:12})," Saída"]})})}),Te.jsxs("td",{className:"px-4 py-3 text-sm font-medium text-slate-900",children:[e.itemNome,Te.jsxs("span",{className:"ml-2 text-xs text-slate-500",children:["(",e.itemTipo,")"]})]}),Te.jsxs("td",{className:"px-4 py-3 text-sm font-bold text-slate-700",children:["entrada"===e.tipo?"+":"-",e.quantidade]}),Te.jsx("td",{className:"px-4 py-3 text-sm text-slate-600",children:e.motivo}),Te.jsx("td",{className:"px-4 py-3 text-sm text-slate-600",children:e.usuarioNome})]},e._id))})]})}):Te.jsxs("div",{className:"text-center py-12",children:[Te.jsx(ae,{size:48,className:"mx-auto text-slate-300 mb-3"}),Te.jsx("p",{className:"text-slate-500",children:"Nenhuma movimentação encontrada"})]})})]})})]})}function xi(){const[s,t]=e.useState([]),[a,r]=e.useState(!0),[i,n]=e.useState("");e.useEffect(()=>{l()},[]);const l=async()=>{try{r(!0);const e=await ur(),s=Array.isArray(e)?e:e.pacientes||[];t(s)}catch(e){b.error(Za("load","residentes"))}finally{r(!1)}},o=s.filter(e=>"ativo"===e.status&&(e.nome.toLowerCase().includes(i.toLowerCase())||e.cpf&&e.cpf.includes(i))),c=0,d=0,m=0,x=0;return Te.jsxs("div",{className:"space-y-8",children:[Te.jsx(dr,{label:"Prontuário",title:"Registros de Enfermagem",subtitle:"Anotações diárias, evolução clínica e acompanhamento de cuidados.",children:Te.jsxs("button",{type:"button",onClick:l,className:"btn btn-secondary flex items-center justify-center gap-2",children:[Te.jsx(A,{size:18})," Atualizar"]})}),Te.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[Te.jsx(mr,{icon:S,label:"Hoje",value:c,description:"Registros realizados",color:"primary"}),Te.jsx(mr,{icon:C,label:"Cobertura",value:d,description:"Pacientes evoluídos",color:"emerald"}),Te.jsx(mr,{icon:le,label:"Risco",value:m,description:"Alto risco de queda",color:"orange"}),Te.jsx(mr,{icon:F,label:"Crítico",value:x,description:"Alertas pendentes",color:"red"})]}),Te.jsx(Sr,{searchTerm:i,onSearchChange:n,placeholder:"Buscar por nome, quarto ou CPF..."}),Te.jsxs("div",{className:"card overflow-hidden",children:[Te.jsx("div",{className:"p-6 border-b border-slate-100",children:Te.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Residentes Ativos"})}),a?Te.jsx("div",{className:"flex justify-center py-12",children:Te.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})}):o.length>0?Te.jsx("div",{className:"overflow-x-auto",children:Te.jsxs("table",{className:"w-full",children:[Te.jsx("thead",{className:"bg-slate-50 border-b border-slate-100",children:Te.jsxs("tr",{children:[Te.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Residente"}),Te.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Quarto"}),Te.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Status"}),Te.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Alertas"}),Te.jsx("th",{className:"px-6 py-4 text-right text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Ações"})]})}),Te.jsx("tbody",{className:"divide-y divide-slate-100",children:o.map(e=>Te.jsxs("tr",{className:"hover:bg-slate-50/50 transition",children:[Te.jsx("td",{className:"px-6 py-4",children:Te.jsxs("div",{className:"flex items-center gap-3",children:[Te.jsx("div",{className:"w-10 h-10 rounded-full bg-primary-50 flex items-center justify-center text-primary-600 font-bold text-sm",children:e.nome.charAt(0)}),Te.jsxs("div",{children:[Te.jsx("p",{className:"font-medium text-slate-900",children:e.nome}),Te.jsxs("p",{className:"text-xs text-slate-500",children:["CPF: ",e.cpf||"N/A"]})]})]})}),Te.jsx("td",{className:"px-6 py-4 text-sm text-slate-600",children:e.quarto||"-"}),Te.jsx("td",{className:"px-6 py-4",children:Te.jsx("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-emerald-50 text-emerald-700 border border-emerald-100",children:"Ativo"})}),Te.jsx("td",{className:"px-6 py-4",children:e.alergias&&e.alergias.length>0?Te.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium bg-red-50 text-red-700 border border-red-100",children:[Te.jsx(G,{size:12})," Alergias"]}):Te.jsx("span",{className:"text-slate-400 text-sm",children:"-"})}),Te.jsx("td",{className:"px-6 py-4 text-right",children:Te.jsxs("button",{onClick:()=>b.success(`Abrindo prontuário de ${e.nome}`),className:"text-primary-600 hover:text-primary-800 text-sm font-semibold hover:underline flex items-center justify-end gap-1 ml-auto",children:[Te.jsx(oe,{size:16})," Prontuário"]})})]},e.id||e._id))})]})}):Te.jsx("div",{className:"p-12",children:Te.jsx(kr,{icon:C,title:"Nenhum residente encontrado",description:"Tente buscar por outro nome ou quarto."})})]})]})}const ui=async(e={})=>{const s=La({tipo:e.tipo,status:e.status,dataInicio:e.dataInicio,dataFim:e.dataFim});return Fa(`/financeiro${s}`)},pi=async()=>{const e=await Fa("/financeiro/stats");return(null==e?void 0:e.data)||e},hi=async e=>Ua("/financeiro",e),fi=async(e,s)=>Ma(`/financeiro/${e}`,s),bi=async e=>_a(`/financeiro/${e}`);function gi({transacao:s,onClose:t}){wr(!0);const[a,r]=e.useState({descricao:"",valor:"",tipo:"receita",categoria:"",data:(new Date).toISOString().split("T")[0],status:"pendente",observacoes:""}),[i,n]=e.useState(!1);e.useEffect(()=>{s&&r({...s,data:new Date(s.data).toISOString().split("T")[0]})},[s]);return Te.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",onMouseDown:e=>{e.target===e.currentTarget&&t()},children:Te.jsxs("div",{role:"dialog","aria-modal":"true",className:"bg-white rounded-2xl shadow-2xl w-full max-w-md max-h-[90vh] overflow-hidden flex flex-col animate-in fade-in zoom-in duration-200",onMouseDown:e=>e.stopPropagation(),children:[Te.jsxs("div",{className:"px-6 py-4 border-b border-slate-100 flex items-center justify-between bg-slate-50/50",children:[Te.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:s?"Editar Transação":"Nova Transação"}),Te.jsx("button",{onClick:t,className:"text-slate-400 hover:text-slate-600 transition",children:Te.jsx(U,{size:20})})]}),Te.jsxs("form",{onSubmit:async e=>{e.preventDefault(),n(!0);try{s?(await fi(s._id,a),b.success(Xa("update","Transação",{gender:"f"}))):(await hi(a),b.success(Xa("create","Transação",{gender:"f"}))),t()}catch(r){b.error(Za("save","transação"))}finally{n(!1)}},className:"flex flex-col flex-1 min-h-0",children:[Te.jsxs("div",{className:"p-6 space-y-4 overflow-y-auto custom-scrollbar",children:[Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Descrição"}),Te.jsx("input",{type:"text",required:!0,value:a.descricao,onChange:e=>r({...a,descricao:e.target.value}),className:"w-full px-3 py-2 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 transition",placeholder:"Ex: Consulta Particular"})]}),Te.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Valor (R$)"}),Te.jsxs("div",{className:"relative",children:[Te.jsx(q,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"}),Te.jsx("input",{type:"number",step:"0.01",required:!0,value:a.valor,onChange:e=>r({...a,valor:e.target.value}),className:"w-full pl-9 pr-3 py-2 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 transition",placeholder:"0,00"})]})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Data"}),Te.jsx("input",{type:"date",required:!0,value:a.data,onChange:e=>r({...a,data:e.target.value}),className:"w-full px-3 py-2 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 transition"})]})]}),Te.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Tipo"}),Te.jsxs("select",{value:a.tipo,onChange:e=>r({...a,tipo:e.target.value}),className:"w-full px-3 py-2 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 transition",children:[Te.jsx("option",{value:"receita",children:"Receita"}),Te.jsx("option",{value:"despesa",children:"Despesa"})]})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Status"}),Te.jsxs("select",{value:a.status,onChange:e=>r({...a,status:e.target.value}),className:"w-full px-3 py-2 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 transition",children:[Te.jsx("option",{value:"pendente",children:"Pendente"}),Te.jsx("option",{value:"pago",children:"Pago"})]})]})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Categoria"}),Te.jsxs("select",{value:a.categoria,onChange:e=>r({...a,categoria:e.target.value}),className:"w-full px-3 py-2 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 transition",children:[Te.jsx("option",{value:"",children:"Selecione..."}),"receita"===a.tipo?Te.jsxs(Te.Fragment,{children:[Te.jsx("option",{value:"Consulta",children:"Consulta"}),Te.jsx("option",{value:"Procedimento",children:"Procedimento"}),Te.jsx("option",{value:"Convênio",children:"Convênio"}),Te.jsx("option",{value:"Outros",children:"Outros"})]}):Te.jsxs(Te.Fragment,{children:[Te.jsx("option",{value:"Aluguel",children:"Aluguel"}),Te.jsx("option",{value:"Salários",children:"Salários"}),Te.jsx("option",{value:"Insumos",children:"Insumos"}),Te.jsx("option",{value:"Manutenção",children:"Manutenção"}),Te.jsx("option",{value:"Impostos",children:"Impostos"}),Te.jsx("option",{value:"Outros",children:"Outros"})]})]})]}),Te.jsxs("div",{children:[Te.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Observações"}),Te.jsx("textarea",{rows:"3",value:a.observacoes,onChange:e=>r({...a,observacoes:e.target.value}),className:"w-full px-3 py-2 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 transition resize-none"})]})]}),Te.jsxs("div",{className:"flex justify-end gap-3 px-6 py-4 border-t border-slate-100 bg-white shrink-0",children:[Te.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-slate-700 hover:bg-slate-100 rounded-xl transition",children:"Cancelar"}),Te.jsxs("button",{type:"submit",disabled:i,className:"px-4 py-2 text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 rounded-xl transition flex items-center gap-2 disabled:opacity-50",children:[Te.jsx(X,{size:18}),i?"Salvando...":"Salvar"]})]})]})]})})}const ji=e=>{const s=Number(e),t=isNaN(s)?0:s;return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:2,maximumFractionDigits:2}).format(t)};function vi(){const[s,t]=e.useState([]),[a,r]=e.useState({receitas:0,despesas:0,saldo:0,receitasPendentes:0,despesasPendentes:0}),[i,n]=e.useState(!0),[l,o]=e.useState(!1),[c,d]=e.useState(null),[m,x]=e.useState({tipo:"",status:"",search:""});e.useEffect(()=>{u()},[]);const u=async()=>{try{n(!0);const[e,s]=await Promise.all([ui(),pi()]);t(Array.isArray(e)?e:[]),r({receitas:Number(null==s?void 0:s.receitas)||0,despesas:Number(null==s?void 0:s.despesas)||0,saldo:Number(null==s?void 0:s.saldo)||0,receitasPendentes:Number(null==s?void 0:s.receitasPendentes)||0,despesasPendentes:Number(null==s?void 0:s.despesasPendentes)||0})}catch(e){b.error(Za("load","dados financeiros"))}finally{n(!1)}},p=e=>{d(e),o(!0)},h=async e=>{if(window.confirm("Tem certeza que deseja excluir esta transação?"))try{await bi(e),b.success("Transação excluída"),u()}catch(s){b.error(Za("delete","transação"))}},f=s.filter(e=>{const s=e.descricao.toLowerCase().includes(m.search.toLowerCase())||e.categoria.toLowerCase().includes(m.search.toLowerCase()),t=!m.tipo||e.tipo===m.tipo,a=!m.status||e.status===m.status;return s&&t&&a});return Te.jsxs("div",{className:"space-y-8",children:[Te.jsx(dr,{label:"Administrativo",title:"Financeiro",subtitle:"Gestão completa de receitas, despesas e fluxo de caixa.",children:Te.jsxs("button",{onClick:()=>o(!0),className:"btn btn-primary flex items-center justify-center gap-2 shadow-lg shadow-primary-500/20",children:[Te.jsx(_,{size:20})," Nova Transação"]})}),Te.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[Te.jsx(mr,{icon:q,label:"Saldo Atual",value:ji(a.saldo),description:"Balanço geral do mês",color:a.saldo>=0?"primary":"red"}),Te.jsx(mr,{icon:E,label:"Receitas",value:ji(a.receitas),description:Te.jsxs("span",{className:"flex items-center gap-1",children:[Te.jsxs("span",{className:"text-xs font-medium text-emerald-600 bg-emerald-50 px-2 py-0.5 rounded-full",children:["+",ji(a.receitasPendentes)]}),Te.jsx("span",{className:"text-xs text-slate-400",children:"a receber"})]}),color:"emerald"}),Te.jsx(mr,{icon:ce,label:"Despesas",value:ji(a.despesas),description:Te.jsxs("span",{className:"flex items-center gap-1",children:[Te.jsxs("span",{className:"text-xs font-medium text-amber-600 bg-amber-50 px-2 py-0.5 rounded-full",children:["+",ji(a.despesasPendentes)]}),Te.jsx("span",{className:"text-xs text-slate-400",children:"a pagar"})]}),color:"red"}),Te.jsx(mr,{icon:z,label:"Previsão",value:ji(a.saldo+a.receitasPendentes-a.despesasPendentes),description:"Saldo projetado",color:"purple"})]}),Te.jsx(Sr,{searchTerm:m.search,onSearchChange:e=>x({...m,search:e}),placeholder:"Buscar transações...",children:Te.jsxs("div",{className:"flex gap-3 w-full md:w-auto overflow-x-auto pb-2 md:pb-0",children:[Te.jsxs("select",{value:m.tipo,onChange:e=>x({...m,tipo:e.target.value}),className:"px-4 py-2 bg-slate-50 border border-slate-200 rounded-xl text-sm text-slate-600 focus:outline-none focus:border-primary-500",children:[Te.jsx("option",{value:"",children:"Todos os tipos"}),Te.jsx("option",{value:"receita",children:"Receitas"}),Te.jsx("option",{value:"despesa",children:"Despesas"})]}),Te.jsxs("select",{value:m.status,onChange:e=>x({...m,status:e.target.value}),className:"px-4 py-2 bg-slate-50 border border-slate-200 rounded-xl text-sm text-slate-600 focus:outline-none focus:border-primary-500",children:[Te.jsx("option",{value:"",children:"Todos os status"}),Te.jsx("option",{value:"pago",children:"Pago"}),Te.jsx("option",{value:"pendente",children:"Pendente"})]})]})}),Te.jsx("div",{className:"card overflow-hidden",children:i?Te.jsx("div",{className:"flex justify-center py-12",children:Te.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})}):f.length>0?Te.jsxs(Te.Fragment,{children:[Te.jsx("div",{className:"md:hidden p-4 sm:p-6 space-y-3",children:f.map(e=>Te.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white shadow-sm p-4",children:[Te.jsxs("div",{className:"flex items-start justify-between gap-3",children:[Te.jsxs("div",{className:"min-w-0",children:[Te.jsx("p",{className:"font-semibold text-slate-900 truncate",children:e.descricao}),Te.jsx("p",{className:"text-sm text-slate-600 truncate",children:e.categoria})]}),Te.jsx("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium border shrink-0 "+("pago"===e.status?"bg-emerald-50 text-emerald-700 border-emerald-100":"bg-amber-50 text-amber-700 border-amber-100"),children:"pago"===e.status?Te.jsxs(Te.Fragment,{children:[Te.jsx(I,{size:12})," Pago"]}):Te.jsxs(Te.Fragment,{children:[Te.jsx(z,{size:12})," Pendente"]})})]}),Te.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[Te.jsx("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium "+("receita"===e.tipo?"bg-emerald-100 text-emerald-700":"bg-red-100 text-red-700"),children:"receita"===e.tipo?Te.jsxs(Te.Fragment,{children:[Te.jsx(de,{size:12})," Receita"]}):Te.jsxs(Te.Fragment,{children:[Te.jsx(me,{size:12})," Despesa"]})}),Te.jsxs("span",{className:"inline-flex items-center gap-2 text-xs text-slate-600",children:[Te.jsx(R,{size:14,className:"text-slate-400"}),new Date(e.data).toLocaleDateString("pt-BR")]})]}),Te.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[Te.jsx("span",{className:"text-sm text-slate-500",children:"Valor"}),Te.jsxs("span",{className:"font-semibold "+("receita"===e.tipo?"text-emerald-600":"text-red-600"),children:["despesa"===e.tipo?"-":"+",ji(e.valor)]})]}),e.pacienteId&&Te.jsxs("p",{className:"mt-2 text-xs text-slate-500 truncate",children:["Paciente: ",e.pacienteId.nome]}),Te.jsxs("div",{className:"mt-4 flex items-center justify-end gap-2",children:[Te.jsx("button",{type:"button",onClick:()=>p(e),className:"px-3 py-2 text-slate-600 hover:text-primary-700 hover:bg-primary-50 rounded-lg transition-colors text-sm font-semibold",children:"Editar"}),Te.jsx("button",{type:"button",onClick:()=>h(e._id),className:"px-3 py-2 text-red-600 hover:text-red-700 hover:bg-red-50 rounded-lg transition-colors text-sm font-semibold",children:"Excluir"})]})]},e._id))}),Te.jsx("div",{className:"hidden md:block overflow-x-auto",children:Te.jsxs("table",{className:"w-full",children:[Te.jsx("thead",{className:"bg-slate-50 border-b border-slate-100",children:Te.jsxs("tr",{children:[Te.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Descrição"}),Te.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Categoria"}),Te.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Data"}),Te.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Valor"}),Te.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Status"}),Te.jsx("th",{className:"px-6 py-4 text-right text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Ações"})]})}),Te.jsx("tbody",{className:"divide-y divide-slate-100",children:f.map(e=>Te.jsxs("tr",{className:"hover:bg-slate-50/50 transition",children:[Te.jsx("td",{className:"px-6 py-4",children:Te.jsxs("div",{className:"flex items-center gap-3",children:[Te.jsx("div",{className:"p-2 rounded-lg "+("receita"===e.tipo?"bg-emerald-100 text-emerald-600":"bg-red-100 text-red-600"),children:"receita"===e.tipo?Te.jsx(de,{size:18}):Te.jsx(me,{size:18})}),Te.jsxs("div",{children:[Te.jsx("p",{className:"font-medium text-slate-900",children:e.descricao}),e.pacienteId&&Te.jsx("p",{className:"text-xs text-slate-500",children:e.pacienteId.nome})]})]})}),Te.jsx("td",{className:"px-6 py-4",children:Te.jsx("span",{className:"px-2.5 py-1 rounded-full text-xs font-medium bg-slate-100 text-slate-600",children:e.categoria})}),Te.jsx("td",{className:"px-6 py-4 text-sm text-slate-600",children:Te.jsxs("div",{className:"flex items-center gap-2",children:[Te.jsx(R,{size:14,className:"text-slate-400"}),new Date(e.data).toLocaleDateString("pt-BR")]})}),Te.jsxs("td",{className:"px-6 py-4 font-semibold "+("receita"===e.tipo?"text-emerald-600":"text-red-600"),children:["despesa"===e.tipo?"-":"+",ji(e.valor)]}),Te.jsx("td",{className:"px-6 py-4",children:Te.jsx("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium "+("pago"===e.status?"bg-emerald-50 text-emerald-700 border border-emerald-100":"bg-amber-50 text-amber-700 border border-amber-100"),children:"pago"===e.status?Te.jsxs(Te.Fragment,{children:[Te.jsx(I,{size:12})," Pago"]}):Te.jsxs(Te.Fragment,{children:[Te.jsx(z,{size:12})," Pendente"]})})}),Te.jsx("td",{className:"px-6 py-4 text-right",children:Te.jsxs("div",{className:"flex items-center justify-end gap-2",children:[Te.jsx("button",{onClick:()=>p(e),className:"p-2 text-slate-400 hover:text-primary-600 hover:bg-primary-50 rounded-lg transition",children:Te.jsx(B,{size:16})}),Te.jsx("button",{onClick:()=>h(e._id),className:"p-2 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition",children:Te.jsx($,{size:16})})]})})]},e._id))})]})})]}):Te.jsx("div",{className:"p-8",children:Te.jsx(kr,{icon:q,title:"Nenhuma transação encontrada",description:"Comece adicionando uma nova receita ou despesa.",action:Te.jsx("button",{onClick:()=>o(!0),className:"btn btn-primary mt-4",children:"Nova Transação"})})})}),l&&Te.jsx(gi,{transacao:c,onClose:()=>{o(!1),d(null),u()}})]})}function yi(){const[s,t]=e.useState(""),[a,r]=e.useState(null),i=[{id:"dashboard",icon:y,title:"Dashboard",color:"bg-blue-500",description:"Visão geral do sistema com métricas e gráficos",sections:[{title:"Visualizar Métricas",content:"Acompanhe em tempo real os indicadores principais: Pacientes Ativos, Prescrições Ativas, Agendamentos do Dia e Receita Mensal.",steps:["Acesse o Dashboard","Visualize os cards com métricas","Clique em cada card para detalhes"]},{title:"Analisar Gráficos",content:"Gráficos interativos mostram evolução de pacientes, comparativo financeiro e taxa de ocupação.",steps:["Passe o mouse sobre os gráficos","Veja detalhes por período","Use filtros para personalizar"]},{title:"Ações Rápidas",content:"Botões de acesso rápido para criar prescrições, agendamentos e evoluções diretamente do Dashboard.",steps:["Localize os botões de ação","Clique para criar novo item","Preencha e salve"]}],permissions:"Todos os usuários"},{id:"agenda",icon:R,title:"Agenda",color:"bg-purple-500",description:"Gerenciamento de agendamentos e compromissos",sections:[{title:"Criar Agendamento",content:"Agende consultas, visitas, procedimentos e reuniões com facilidade.",steps:['Clique em "+ Novo Agendamento"',"Selecione o paciente","Escolha tipo, data, hora e profissional","Adicione observações",'Clique em "Salvar"']},{title:"Visualizar Agenda",content:"Escolha entre visualização por dia, semana ou mês para melhor organização.",steps:["Selecione a visualização desejada","Navegue entre datas","Clique em agendamento para detalhes"]},{title:"Gerenciar Agendamentos",content:"Edite, confirme ou cancele agendamentos conforme necessário.",steps:["Clique no agendamento","Escolha ação: Editar, Confirmar ou Cancelar","Confirme a operação"]}],permissions:"Admin, Médico, Enfermeiro"},{id:"cronograma",icon:z,title:"Cronograma",color:"bg-indigo-500",description:"Planejamento de tarefas e rotinas",sections:[{title:"Criar Tarefa",content:"Organize tarefas com prioridades, responsáveis e prazos definidos.",steps:['Clique em "+ Nova Tarefa"',"Defina título, descrição e prioridade","Atribua responsável e prazo","Configure recorrência se necessário","Salve a tarefa"]},{title:"Acompanhar Status",content:"Visualize tarefas pendentes, em progresso, concluídas ou atrasadas.",steps:["Veja quadro de tarefas","Filtre por status","Marque como concluída quando finalizar"]},{title:"Configurar Rotinas",content:"Crie tarefas recorrentes para medicação, higienização, alimentação e atividades.",steps:["Crie tarefa com recorrência","Defina frequência (diária, semanal, mensal)","Sistema criará automaticamente"]}],permissions:"Admin, Enfermeiro, Médico"},{id:"prescricoes",icon:J,title:"Prescrições",color:"bg-green-500",description:"Gestão de prescrições médicas e veterinárias",sections:[{title:"Criar Prescrição",content:"Prescreva medicamentos com dosagem, via, frequência e duração detalhadas.",steps:['Clique em "+ Nova Prescrição"',"Selecione o paciente","Adicione medicamentos e dosagens","Defina via, frequência e duração","Adicione observações especiais","Salve a prescrição"]},{title:"Administrar Medicamento",content:"Registre cada administração de medicamento com horário e observações.",steps:["Abra prescrição ativa",'Clique em "Registrar Administração"',"Confirme horário e dosagem","Salve o registro"]},{title:"Renovar Prescrição",content:"Renove prescrições finalizadas com ajustes de datas e dosagens.",steps:["Abra prescrição finalizada",'Clique em "Renovar"',"Ajuste conforme necessário","Salve nova prescrição"]}],permissions:"Médico, Admin (criar) | Enfermeiro (administrar)"},{id:"censo",icon:S,title:"Censo M.P.",color:"bg-amber-500",description:"Censo de medicamentos prescritos",sections:[{title:"Gerar Censo",content:"Relatório consolidado de todos os medicamentos em uso no período selecionado.",steps:["Selecione o período desejado",'Clique em "Gerar Censo"',"Analise os dados apresentados"]},{title:"Exportar Relatório",content:"Exporte censo em PDF, Excel ou CSV para impressão ou análise externa.",steps:['Clique em "Exportar"',"Escolha o formato","Salve ou imprima o arquivo"]},{title:"Mapa de Medicação",content:"Imprima mapa organizado por paciente, horário ou medicamento para a equipe.",steps:['Clique em "Imprimir Mapa"',"Escolha organização","Imprima para distribuição"]}],permissions:"Médico, Enfermeiro, Farmacêutico, Admin"},{id:"pacientes",icon:C,title:"Pacientes",color:"bg-rose-500",description:"Cadastro completo de residentes ou pets",sections:[{title:"Cadastrar Paciente",content:"Registre dados pessoais, responsável, histórico médico e documentos.",steps:['Clique em "+ Novo Paciente"',"Preencha dados pessoais e contato","Cadastre responsável (obrigatório)","Adicione dados médicos e alergias","Defina status (Ativo, Inativo, Alta)","Salve o cadastro"]},{title:"Visualizar Prontuário",content:"Acesse prontuário completo com prescrições, evoluções, agendamentos e documentos.",steps:["Clique no paciente","Navegue pelas abas","Visualize histórico completo"]},{title:"Anexar Documentos",content:"Anexe exames, laudos, receitas e contratos ao prontuário do paciente.",steps:["Abra aba Documentos",'Clique em "+ Anexar"',"Selecione tipo e arquivo","Faça upload"]}],permissions:"Enfermeiro, Médico, Admin (criar) | Todos (visualizar)"},{id:"estoque",icon:T,title:"Estoque",color:"bg-orange-500",description:"Controle de medicamentos e materiais",sections:[{title:"Cadastrar Produto",content:"Registre medicamentos, alimentos, materiais e produtos com estoque mínimo.",steps:['Clique em "+ Novo Produto"',"Preencha nome, categoria e código","Defina unidade e estoque mínimo","Adicione localização e validade","Informe fornecedor e valor","Salve o produto"]},{title:"Movimentar Estoque",content:"Registre entradas e saídas com lote, validade e motivo.",steps:["Clique no produto","Escolha Entrada ou Saída","Preencha dados da movimentação","Salve o registro"]},{title:"Gerenciar Alertas",content:"Sistema alerta automaticamente sobre estoque baixo e produtos vencendo.",steps:["Visualize alertas no topo","Clique para ver detalhes","Tome ações necessárias"]}],permissions:"Farmacêutico, Admin (gerenciar) | Enfermeiro (saídas)"},{id:"evolucao",icon:E,title:"Evolução",color:"bg-teal-500",description:"Acompanhamento clínico e evolução",sections:[{title:"Registrar Evolução",content:"Documente sinais vitais, observações clínicas e condutas realizadas.",steps:["Selecione o paciente",'Clique em "+ Nova Evolução"',"Registre sinais vitais","Descreva observações clínicas","Documente condutas realizadas","Salve a evolução"]},{title:"Consultar Histórico",content:"Visualize evolução do paciente ao longo do tempo com gráficos.",steps:["Abra paciente","Visualize todas evoluções","Use filtros por período","Analise gráficos"]},{title:"Imprimir Evolução",content:"Gere relatório em PDF de evolução específica ou período completo.",steps:["Selecione evolução",'Clique em "Imprimir"',"Escolha formato","Salve ou imprima"]}],permissions:"Médico, Enfermeiro (criar) | Todos (visualizar)"},{id:"financeiro",icon:q,title:"Financeiro",color:"bg-emerald-500",description:"Gestão de receitas e despesas",sections:[{title:"Registrar Receitas",content:"Lance mensalidades, serviços e produtos recebidos com forma de pagamento.",steps:['Clique em "+ Nova Receita"',"Preencha descrição e valor","Selecione categoria e paciente","Defina data e forma de pagamento","Anexe comprovante (opcional)","Salve o lançamento"]},{title:"Registrar Despesas",content:"Controle pagamentos a fornecedores, salários, aluguel e outras despesas.",steps:['Clique em "+ Nova Despesa"',"Informe descrição e valor","Selecione categoria e fornecedor","Defina data e status de pagamento","Salve o lançamento"]},{title:"Analisar Relatórios",content:"Visualize fluxo de caixa, DRE e relatórios por categoria ou período.",steps:['Clique em "Relatórios"',"Escolha tipo de relatório","Analise gráficos e tabelas","Exporte se necessário"]}],permissions:"Admin (total) | Auxiliar Administrativo (registrar)"},{id:"usuarios",icon:K,title:"Usuários",color:"bg-violet-500",description:"Gerenciamento de usuários e permissões",sections:[{title:"Criar Usuário",content:"Cadastre novos usuários com role, permissões e status definidos.",steps:['Clique em "+ Novo Usuário"',"Preencha dados pessoais","Defina e-mail e senha","Escolha role (Admin, Médico, etc.)","Selecione permissões de módulos","Defina status e salve"]},{title:"Gerenciar Permissões",content:"Controle acesso aos módulos do sistema por usuário ou role.",steps:["Abra usuário","Vá para Permissões","Marque/desmarque módulos","Salve alterações"]},{title:"Resetar Senha",content:"Redefina senha de usuários que esqueceram ou por segurança.",steps:["Clique no usuário",'Clique em "Resetar Senha"',"Digite nova senha","Confirme operação"]}],permissions:"Admin (própria empresa) | Superadmin (todos)"},{id:"empresas",icon:u,title:"Empresas",color:"bg-cyan-500",description:"Gerenciamento de empresas (Superadmin)",sections:[{title:"Criar Empresa",content:"Cadastre novas empresas com plano, módulos e administrador.",steps:['Clique em "+ Nova Empresa"',"Preencha dados cadastrais","Escolha tipo (Casa Repouso ou Petshop)","Defina plano e módulos","Crie administrador","Salve a empresa"]},{title:"Gerenciar Planos",content:"Faça upgrade/downgrade de planos e configure limites de usuários.",steps:["Abra empresa","Vá para Plano","Altere configurações","Salve mudanças"]},{title:"Relatório Consolidado",content:"Visualize métricas de todas as empresas cadastradas no sistema.",steps:['Clique em "Relatório Geral"',"Analise estatísticas","Exporte se necessário"]}],permissions:"Apenas Superadmin"},{id:"configuracoes",icon:L,title:"Configurações",color:"bg-slate-500",description:"Personalização e preferências",sections:[{title:"Editar Perfil",content:"Atualize foto, nome, e-mail, telefone e outros dados pessoais.",steps:["Acesse Configurações","Vá para Meu Perfil","Edite campos desejados","Salve alterações"]},{title:"Alterar Senha",content:"Troque sua senha regularmente para manter segurança.",steps:["Vá para Segurança","Digite senha atual","Digite nova senha duas vezes","Confirme alteração"]},{title:"Configurar Preferências",content:"Personalize tema, idioma, fuso horário e notificações.",steps:["Acesse Preferências","Ajuste configurações desejadas","Ative/desative notificações","Salve mudanças"]}],permissions:"Todos (próprio perfil) | Admin (empresa)"}].filter(e=>e.title.toLowerCase().includes(s.toLowerCase())||e.description.toLowerCase().includes(s.toLowerCase())),n=[{icon:G,text:"Use senhas fortes com mínimo 8 caracteres",color:"text-red-600"},{icon:ue,text:"Faça backup regular dos dados importantes",color:"text-green-600"},{icon:G,text:"Mantenha informações atualizadas no sistema",color:"text-blue-600"},{icon:ue,text:"Configure notificações para não perder prazos",color:"text-purple-600"}];return Te.jsxs("div",{className:"space-y-6",children:[Te.jsx(dr,{title:"Manual do Sistema",subtitle:"Guia completo de como utilizar cada módulo"}),Te.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-slate-200",children:Te.jsxs("div",{className:"relative",children:[Te.jsx(M,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400",size:20}),Te.jsx("input",{type:"text",placeholder:"Buscar por módulo ou funcionalidade...",value:s,onChange:e=>t(e.target.value),className:"w-full pl-12 pr-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})}),Te.jsxs("div",{className:"bg-gradient-to-br from-primary-50 to-purple-50 p-6 rounded-xl border border-primary-100",children:[Te.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[Te.jsx(xe,{className:"text-primary-600",size:24}),Te.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Dicas Rápidas"})]}),Te.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:n.map((e,s)=>Te.jsxs("div",{className:"flex items-start gap-3 bg-white p-4 rounded-lg",children:[Te.jsx(e.icon,{className:e.color,size:20}),Te.jsx("p",{className:"text-sm text-slate-700",children:e.text})]},s))})]}),a?Te.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:[Te.jsxs("div",{className:`${a.color} p-6 text-white`,children:[Te.jsxs("button",{onClick:()=>r(null),className:"mb-4 flex items-center gap-2 text-white/80 hover:text-white transition-colors",children:[Te.jsx(pe,{size:20,className:"rotate-180"}),Te.jsx("span",{children:"Voltar para módulos"})]}),Te.jsxs("div",{className:"flex items-center gap-4",children:[Te.jsx("div",{className:"w-16 h-16 bg-white/20 backdrop-blur-sm rounded-2xl flex items-center justify-center",children:Te.jsx(a.icon,{size:32})}),Te.jsxs("div",{children:[Te.jsx("h2",{className:"text-3xl font-bold mb-1",children:a.title}),Te.jsx("p",{className:"text-white/90",children:a.description})]})]})]}),Te.jsxs("div",{className:"p-6 space-y-6",children:[Te.jsx("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200",children:Te.jsxs("div",{className:"flex items-center gap-2 text-slate-700",children:[Te.jsx(K,{size:18}),Te.jsx("span",{className:"font-medium",children:"Permissões necessárias:"}),Te.jsx("span",{className:"text-slate-600",children:a.permissions})]})}),a.sections.map((e,s)=>Te.jsxs("div",{className:"border-l-4 border-primary-500 pl-6 py-2",children:[Te.jsxs("h3",{className:"text-xl font-semibold text-slate-900 mb-3 flex items-center gap-2",children:[Te.jsx("span",{className:"flex items-center justify-center w-8 h-8 bg-primary-100 text-primary-600 rounded-full text-sm font-bold",children:s+1}),e.title]}),Te.jsx("p",{className:"text-slate-700 mb-4 leading-relaxed",children:e.content}),e.steps&&Te.jsxs("div",{className:"space-y-2",children:[Te.jsx("p",{className:"text-sm font-medium text-slate-600 mb-2",children:"Passo a passo:"}),e.steps.map((e,s)=>Te.jsxs("div",{className:"flex items-start gap-3 bg-slate-50 p-3 rounded-lg",children:[Te.jsx("span",{className:"flex items-center justify-center w-6 h-6 bg-primary-600 text-white rounded-full text-xs font-bold flex-shrink-0 mt-0.5",children:s+1}),Te.jsx("p",{className:"text-sm text-slate-700",children:e})]},s))]})]},s)),Te.jsxs("div",{className:"flex flex-wrap gap-4 pt-4 border-t border-slate-200",children:[Te.jsxs("button",{onClick:()=>window.open("/docs/MANUAL_COMPLETO_SISTEMA.md","_blank"),className:"flex items-center gap-2 px-6 py-3 bg-primary-600 hover:bg-primary-700 text-white font-semibold rounded-xl transition-colors",children:[Te.jsx(P,{size:20}),Te.jsx("span",{children:"Baixar Manual Completo"})]}),Te.jsxs("button",{onClick:()=>window.open("mailto:suporte@prescrimed.com","_blank"),className:"flex items-center gap-2 px-6 py-3 bg-slate-200 hover:bg-slate-300 text-slate-700 font-semibold rounded-xl transition-colors",children:[Te.jsx(he,{size:20}),Te.jsx("span",{children:"Contatar Suporte"})]})]})]})]}):Te.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:i.map(e=>{const s=e.icon;return Te.jsxs("button",{onClick:()=>r(e),className:"bg-white p-6 rounded-xl shadow-sm border border-slate-200 hover:shadow-lg transition-all duration-200 text-left group",children:[Te.jsxs("div",{className:"flex items-start justify-between mb-4",children:[Te.jsx("div",{className:`w-14 h-14 ${e.color} rounded-2xl flex items-center justify-center group-hover:scale-110 transition-transform`,children:Te.jsx(s,{className:"text-white",size:28})}),Te.jsx(pe,{className:"text-slate-400 group-hover:text-primary-600 transition-colors",size:24})]}),Te.jsx("h3",{className:"text-xl font-semibold text-slate-900 mb-2",children:e.title}),Te.jsx("p",{className:"text-sm text-slate-600 mb-3",children:e.description}),Te.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500",children:[Te.jsx(K,{size:14}),Te.jsx("span",{children:e.permissions})]})]},e.id)})}),Te.jsx("div",{className:"bg-gradient-to-br from-slate-800 to-slate-900 text-white p-8 rounded-xl",children:Te.jsxs("div",{className:"max-w-3xl mx-auto text-center",children:[Te.jsx("h3",{className:"text-2xl font-bold mb-4",children:"Precisa de Ajuda?"}),Te.jsx("p",{className:"text-slate-300 mb-6",children:"Nossa equipe de suporte está pronta para ajudar você com qualquer dúvida ou problema."}),Te.jsxs("div",{className:"flex flex-wrap justify-center gap-4",children:[Te.jsx("a",{href:"mailto:suporte@prescrimed.com",className:"flex items-center gap-2 px-6 py-3 bg-white text-slate-900 font-semibold rounded-xl hover:bg-slate-100 transition-colors",children:"📧 suporte@prescrimed.com"}),Te.jsx("a",{href:"https://wa.me/5571999999999",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 px-6 py-3 bg-green-600 text-white font-semibold rounded-xl hover:bg-green-700 transition-colors",children:"📱 WhatsApp"})]}),Te.jsx("p",{className:"text-sm text-slate-400 mt-4",children:"Horário de atendimento: Segunda a Sexta, 8h às 18h"})]})})]})}function Ni({onClose:e}){const{user:s,logout:t,hasPermission:a}=Ga(),r=[{path:"/dashboard",label:"Dashboard",icon:fe,permission:null},{path:"/agenda",label:"Agenda",icon:R,permission:"agenda"},{path:"/cronograma",label:"Cronograma",icon:be,permission:"cronograma"},{path:"/prescricoes",label:"Prescrições",icon:S,permission:"prescricoes"},{path:"/censo-mp",label:"Censo M.P",icon:ge,permission:"prescricoes"},{path:"/residentes",label:"Pacientes",icon:C,permission:"pacientes"},{path:"/estoque",label:"Estoque",icon:T,permission:"estoque"},{path:"/evolucao",label:"Evolução",icon:O,permission:"evolucao"},{path:"/financeiro",label:"Financeiro",icon:q,permission:"financeiro"},{path:"/usuarios",label:"Usuários",icon:je,roles:["admin","superadmin"]},{path:"/empresas",label:"Empresas",icon:u,roles:["superadmin"]},{path:"/configuracoes",label:"Configurações",icon:L,permission:"configuracoes"},{path:"/manual",label:"Manual",icon:xe,permission:null}];return Te.jsxs("aside",{className:"h-full w-72 bg-primary-900 text-white flex flex-col border-r border-white/5 shadow-2xl",children:[Te.jsxs("div",{className:"h-20 px-6 border-b border-white/10 flex items-center justify-between",children:[Te.jsxs("div",{children:[Te.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-primary-200",children:"Prescrimed"}),Te.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Painel"})]}),Te.jsx("button",{className:"lg:hidden p-2 rounded-xl bg-white/10 hover:bg-white/20 transition",onClick:()=>null==e?void 0:e(),children:Te.jsx(U,{size:18})})]}),Te.jsxs("div",{className:"px-6 py-5 border-b border-white/10",children:[Te.jsx("p",{className:"text-sm text-primary-100",children:"Bem-vindo"}),Te.jsx("p",{className:"text-lg font-semibold",children:null==s?void 0:s.nome}),Te.jsx("p",{className:"text-sm text-primary-200/60",children:null==s?void 0:s.email}),("admin"===(null==s?void 0:s.role)||"superadmin"===(null==s?void 0:s.role))&&Te.jsx("span",{className:"inline-flex items-center gap-2 mt-3 px-3 py-1 rounded-full bg-white/10 text-xs font-semibold text-primary-300",children:"superadmin"===(null==s?void 0:s.role)?"Super Admin":"Administrador"})]}),Te.jsxs("nav",{className:"flex-1 overflow-y-auto px-4 py-6",children:[Te.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-primary-300/50 mb-4",children:"Navegação"}),Te.jsx("ul",{className:"space-y-2",children:r.map(t=>"superadmin"===(null==s?void 0:s.role)?Te.jsx("li",{children:Te.jsxs(n,{to:t.path,onClick:()=>null==e?void 0:e(),className:({isActive:e})=>"flex items-center gap-3 px-4 py-3 rounded-2xl transition-all duration-200 "+(e?"bg-white text-primary-900 shadow-xl":"text-primary-100 hover:bg-white/10"),children:[Te.jsx(t.icon,{size:20}),Te.jsx("span",{children:t.label})]})},t.path):t.roles&&!t.roles.includes(null==s?void 0:s.role)||t.permission&&!a(t.permission)?null:Te.jsx("li",{children:Te.jsxs(n,{to:t.path,onClick:()=>null==e?void 0:e(),className:({isActive:e})=>"flex items-center gap-3 px-4 py-3 rounded-2xl transition-all duration-200 "+(e?"bg-white text-primary-900 shadow-xl":"text-primary-100 hover:bg-white/10"),children:[Te.jsx(t.icon,{size:20}),Te.jsx("span",{children:t.label})]})},t.path))})]}),Te.jsx("div",{className:"px-4 py-6 border-t border-white/10",children:Te.jsxs("button",{onClick:t,className:"w-full flex items-center justify-center gap-2 px-4 py-3 rounded-2xl bg-white/10 hover:bg-white/20 transition text-red-100",children:[Te.jsx(ve,{size:18}),Te.jsx("span",{children:"Sair"})]})})]})}function wi({onToggleSidebar:e}){var s;const{user:t}=Ga(),a=r();return Te.jsx("header",{className:"sticky top-0 z-10 bg-white/80 backdrop-blur-xl border-b border-slate-100",children:Te.jsxs("div",{className:"h-20 px-4 lg:px-8 flex items-center justify-between gap-4",children:[Te.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[Te.jsx("button",{className:"lg:hidden p-2 rounded-xl bg-slate-100 text-slate-600 hover:bg-slate-200 transition",onClick:e,children:Te.jsx(ye,{size:20})}),Te.jsx("div",{className:"hidden sm:block flex-1",children:Te.jsxs("div",{className:"relative",children:[Te.jsx(M,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400",size:20}),Te.jsx("input",{type:"text",placeholder:"Pesquisar pacientes, prescrições ou usuários",className:"w-full pl-12 pr-4 py-3 rounded-2xl border border-slate-200 bg-white focus:outline-none focus:ring-2 focus:ring-primary-400 text-sm text-slate-700"})]})})]}),Te.jsxs("div",{className:"flex items-center gap-3",children:[Te.jsx("button",{onClick:()=>a("/censo-mp"),className:"hidden sm:inline-flex items-center px-4 py-2 rounded-2xl bg-primary-50 text-primary-600 text-sm font-semibold hover:bg-primary-100 transition",children:"Nova Prescrição"}),Te.jsxs("button",{className:"relative p-3 rounded-2xl bg-slate-100 text-slate-600 hover:bg-slate-200 transition",children:[Te.jsx(Q,{size:20}),Te.jsx("span",{className:"absolute top-2 right-2 w-2 h-2 bg-red-400 rounded-full"})]}),Te.jsxs("div",{className:"flex items-center gap-3 px-3 py-2 bg-slate-100 rounded-2xl",children:[Te.jsxs("div",{className:"hidden sm:flex flex-col text-xs text-slate-500 leading-tight",children:[Te.jsx("span",{children:"Conectado"}),Te.jsx("span",{className:"text-slate-800 font-semibold text-sm",children:null==t?void 0:t.nome})]}),Te.jsx("div",{className:"w-11 h-11 rounded-2xl bg-gradient-to-br from-primary-600 to-primary-700 flex items-center justify-center text-white text-lg font-semibold",children:null==(s=null==t?void 0:t.nome)?void 0:s.charAt(0).toUpperCase()})]})]})]})})}function Ci(){const[s,t]=e.useState(!1),a=l();return e.useEffect(()=>{t(!1)},[a.pathname]),e.useEffect(()=>{if(!s)return;const e=e=>{"Escape"===e.key&&t(!1)};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[s]),Te.jsxs("div",{className:"min-h-screen bg-slate-100 flex overflow-x-hidden",children:[Te.jsx("div",{className:`\n          fixed inset-y-0 left-0 z-40 w-72 \n          transform transition-transform duration-300 \n          lg:static lg:translate-x-0 \n          ${s?"translate-x-0":"-translate-x-full"}\n        `,children:Te.jsx(Ni,{onClose:()=>t(!1)})}),s&&Te.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm z-30 lg:hidden",onClick:()=>t(!1)}),Te.jsxs("div",{className:"flex-1 flex flex-col min-h-screen",children:[Te.jsx(wi,{onToggleSidebar:()=>t(e=>!e)}),Te.jsx("main",{className:"flex-1 overflow-y-auto py-4 lg:py-8",children:Te.jsx("div",{className:"container-responsive space-y-6",children:Te.jsx(o,{})})})]})]})}const Si=({children:e,requiredPermission:s})=>{const{isAuthenticated:t,hasPermission:a}=Ga();return t?s&&!a(s)?Te.jsx(c,{to:"/dashboard",replace:!0}):e:Te.jsx(c,{to:"/login",replace:!0})};function ki(){const[s,t]=e.useState("online"),[a,r]=e.useState(!1),[i,n]=e.useState(null),[l,o]=e.useState(null);if(e.useEffect(()=>{const e=async e=>{let s=null;try{s=await e.clone().json()}catch(i){s=null}if(503===e.status)return t("degraded"),o("connecting"),void r(!0);if(!e.ok)return t("offline"),o(null),void r(!0);const a=null==s?void 0:s.database;if(a&&"connected"!==a)return t("degraded"),o(a),void r(!0);t("online"),o(a||"connected"),r(!1)},s=async()=>{try{const a=Da();let i=!1;try{if(a){i=new URL(a).origin===window.location.origin}else i=!0}catch(s){i=!1}if(i){const s=await fetch("/health",{method:"GET",signal:AbortSignal.timeout(5e3)});return await e(s),void n(new Date)}if(!a)return t("online"),o(null),r(!1),void n(new Date);if(a.includes("localhost")&&(window.location.hostname.includes("railway.app")||window.location.hostname.includes("netlify.app")||window.location.hostname.includes("github.io")))return t("offline"),o(null),r(!0),void n(new Date);const l=`${a}/health`,c=await fetch(l,{method:"GET",mode:"cors",signal:AbortSignal.timeout(5e3)});await e(c)}catch(a){t("offline"),o(null),r(!0)}n(new Date)};s();const a=setInterval(s,3e4);return()=>clearInterval(a)},[]),!a)return null;const c="offline"===s,d="degraded"===s,m=c?"Backend Offline":"Backend Online (Banco Inicializando)",x=c?"Não foi possível conectar ao servidor. Verifique se o backend está rodando.":"O servidor respondeu, mas o banco de dados ainda não está conectado. Aguarde alguns instantes e tente novamente.",u=Da()?Da()+"/health":null,p=c?"bg-red-600":"bg-amber-500",h=c?"bg-red-700":"bg-amber-600";return Te.jsxs("div",{className:"fixed top-0 left-0 right-0 z-50 animate-slide-down",children:[Te.jsx("div",{className:`${p} text-white px-4 py-3 shadow-lg`,children:Te.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:[Te.jsxs("div",{className:"flex items-center gap-3",children:[c?Te.jsx(Ne,{className:"w-5 h-5 animate-pulse"}):Te.jsx(G,{className:"w-5 h-5"}),Te.jsxs("div",{children:[Te.jsx("p",{className:"font-semibold",children:m}),Te.jsx("p",{className:"text-sm opacity-90",children:x}),d&&l?Te.jsxs("p",{className:"text-xs opacity-90 mt-1",children:["Status do banco: ",Te.jsx("span",{className:"font-semibold",children:l})]}):null]})]}),Te.jsxs("div",{className:"flex items-center gap-4",children:[u?Te.jsx("a",{href:u,target:"_blank",rel:"noopener noreferrer",className:"text-sm underline hover:no-underline",children:"Testar Conexão"}):null,Te.jsx("button",{onClick:()=>r(!1),className:"text-white hover:bg-black/15 rounded p-1 transition-colors","aria-label":"Fechar alerta",children:"✕"})]})]})}),Te.jsx("div",{className:`${h} px-4 py-2`,children:Te.jsx("div",{className:"max-w-7xl mx-auto",children:Te.jsxs("p",{className:"text-sm text-white/90",children:[Te.jsx("strong",{children:"Como resolver:"})," ",c?Te.jsxs(Te.Fragment,{children:["Verifique se a API está rodando no Railway e se as variáveis ",Te.jsx("code",{className:"bg-black/20 px-2 py-1 rounded text-xs",children:"VITE_BACKEND_ROOT"})," ou ",Te.jsx("code",{className:"bg-black/20 px-2 py-1 rounded text-xs",children:"VITE_API_URL"})," estão configuradas corretamente no frontend."]}):Te.jsxs(Te.Fragment,{children:["No Railway, confirme se o Postgres foi criado e se ",Te.jsx("code",{className:"bg-black/20 px-2 py-1 rounded text-xs",children:"DATABASE_URL"})," está presente. Enquanto isso, o sistema pode ficar parcialmente indisponível."]})]})})})]})}function Ei(){return Te.jsxs(Te.Fragment,{children:[Te.jsx(ki,{}),Te.jsx(d,{basename:"/",future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:Te.jsxs(m,{children:[Te.jsx(x,{path:"/login",element:Te.jsx(tr,{})})," ",Te.jsx(x,{path:"/register",element:Te.jsx(ar,{})})," ",Te.jsxs(x,{path:"/",element:Te.jsxs(Si,{children:[" ",Te.jsx(Ci,{})," "]}),children:[Te.jsx(x,{index:!0,element:Te.jsx(c,{to:"dashboard",replace:!0})}),Te.jsx(x,{path:"dashboard",element:Te.jsx(xr,{})}),Te.jsx(x,{path:"agenda",element:Te.jsx(Si,{children:Te.jsx(si,{})})}),Te.jsx(x,{path:"cronograma",element:Te.jsx(Si,{children:Te.jsx(ti,{})})}),Te.jsx(x,{path:"censo-mp",element:Te.jsx(Si,{requiredPermission:"prescricoes",children:Te.jsx(Dr,{})})}),Te.jsx(x,{path:"prescricoes",element:Te.jsx(Si,{requiredPermission:"prescricoes",children:Te.jsx(zr,{})})}),Te.jsx(x,{path:"estoque",element:Te.jsx(Si,{children:Te.jsx(mi,{})})}),Te.jsx(x,{path:"evolucao",element:Te.jsx(Si,{children:Te.jsx(xi,{})})}),Te.jsx(x,{path:"financeiro",element:Te.jsx(Si,{children:Te.jsx(vi,{})})}),Te.jsx(x,{path:"residentes",element:Te.jsx(Si,{requiredPermission:"pacientes",children:Te.jsx(Er,{})})}),Te.jsx(x,{path:"pacientes",element:Te.jsx(c,{to:"/residentes",replace:!0})}),Te.jsx(x,{path:"usuarios",element:Te.jsx(Si,{requiredPermission:"usuarios",children:Te.jsx(Br,{})})}),Te.jsx(x,{path:"empresas",element:Te.jsx(Si,{children:Te.jsx(Kr,{})})}),Te.jsx(x,{path:"configuracoes",element:Te.jsx(Si,{requiredPermission:"configuracoes",children:Te.jsx(Yr,{})})}),Te.jsx(x,{path:"manual",element:Te.jsx(Si,{children:Te.jsx(yi,{})})})]}),Te.jsx(x,{path:"*",element:Te.jsx(c,{to:"/login",replace:!0})})]})}),Te.jsx(we,{position:"top-right"})]})}class Ai extends a.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,s){}render(){var e;return this.state.hasError?Te.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-50 p-4",children:Te.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-xl max-w-md w-full text-center",children:[Te.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-4",children:"Algo deu errado"}),Te.jsx("p",{className:"text-slate-600 mb-6",children:"Ocorreu um erro inesperado na aplicação. Tente recarregar a página."}),Te.jsx("pre",{className:"text-xs text-left bg-slate-100 p-4 rounded-lg overflow-auto mb-6 text-red-600",children:null==(e=this.state.error)?void 0:e.toString()}),Te.jsx("button",{onClick:()=>window.location.reload(),className:"bg-primary-600 text-white px-6 py-3 rounded-xl font-semibold hover:bg-primary-700 transition",children:"Recarregar Página"}),Te.jsx("button",{onClick:()=>{localStorage.clear(),window.location.reload()},className:"block w-full mt-3 text-sm text-slate-500 hover:text-slate-700",children:"Limpar dados e recarregar"})]})}):this.props.children}}Oe.createRoot(document.getElementById("root")).render(Te.jsx(a.StrictMode,{children:Te.jsx(Ai,{children:Te.jsx(Ei,{})})}));
